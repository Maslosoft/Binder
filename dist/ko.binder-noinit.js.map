{
  "version": 3,
  "file": "ko.binder-noinit.js",
  "sourceRoot": "",
  "sources": [
    "ko.binder-noinit.src.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\"use strict\"\n\nassert = (expr) ->\n\tif not console then return\n\tconsole.assert.apply console, arguments\n\nlog = (expr) ->\n\tif not console then return\n\tconsole.log.apply console, arguments\n\nwarn = (expr, element = null) ->\n\tif not console then return\n\tconsole.warn.apply console, arguments\n\nerror = (expr, element = null) ->\n\tif not console then return\n\tconsole.error.apply console, arguments\n\n# from https://developer.mozilla.org/pl/docs/Web/JavaScript/Referencje/Obiekty/Array/isArray\nif !Array.isArray\n  Array.isArray = (arg) ->\n    return Object.prototype.toString.call(arg) is '[object Array]'\n\nisPlainObject = (obj) ->\n\treturn !!obj and typeof(obj) is 'object' and obj.constructor is Object\n\n# from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys\nif !Object.keys\n  Object.keys = do ->\n    'use strict'\n    hasOwnProperty = Object::hasOwnProperty\n    hasDontEnumBug = !{ toString: null }.propertyIsEnumerable('toString')\n    dontEnums = [\n      'toString'\n      'toLocaleString'\n      'valueOf'\n      'hasOwnProperty'\n      'isPrototypeOf'\n      'propertyIsEnumerable'\n      'constructor'\n    ]\n    dontEnumsLength = dontEnums.length\n    (obj) ->\n      if typeof obj != 'object' and (typeof obj != 'function' or obj == null)\n        throw new TypeError('Object.keys called on non-object')\n      result = []\n      prop = undefined\n      i = undefined\n      for prop of obj\n        `prop = prop`\n        if hasOwnProperty.call(obj, prop)\n          result.push prop\n      if hasDontEnumBug\n        i = 0\n        while i < dontEnumsLength\n          if hasOwnProperty.call(obj, dontEnums[i])\n            result.push dontEnums[i]\n          i++\n      result\n\nsetRefByName = (name, value, context = window) ->\n\targs = Array.prototype.slice.call(arguments, 2)\n\tns = name.split \".\"\n\tfunc = context\n\tfor n, i in ns\n\t\tconsole.log i\n\t\tif i == ns.length - 1\n\t\t\tconsole.log n\n\t\t\tfunc[n] = value\n\t\tfunc = func[n]\n\treturn func\n\nescapeRegExp = (str) ->\n\t# $& means the whole matched string\n\treturn str.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n\nentityMap =\n\t'&': '&amp;'\n\t'<': '&lt;'\n\t'>': '&gt;'\n\t'\"': '&quot;'\n\t\"'\": '&#39;'\n\t'/': '&#x2F;'\n\t'`': '&#x60;'\n\t'=': '&#x3D;'\n\n\nescapeHtml = (string) ->\n\treturn String(string).replace(/[&<>\"'`=\\/]/g, (s) ->\n\t\treturn entityMap[s]\n\t)\n\n#\n# Compare objects for equallness.\n#\n# Example:\n# equals({x: 2}, {x: 2}); // Returns true\n#\n# Optionally skip properties (recursively) to compare:\n# equals({x: 2, y: false}, {x: 2, y: true}, ['y']); // Returns true\n# equals({y: false, x: 2, z: {x: 1, y: 1}}, {x: 2, y: true, z: {x: 1, y: 2}}, ['y']); // Returns true\n#\n# @link https://stackoverflow.com/a/6713782/5444623\n#\n#\nequals = (x, y, skip = []) ->\n\n\tdoSkip = (property) ->\n\t\treturn skip.indexOf(property) != -1\n\n\t# if both x and y are null or undefined and exactly the same\n\tif x == y\n\t\treturn true\n\n\t# if they are not strictly equal, they both need to be Objects\n\tif !(x instanceof Object) or !(y instanceof Object)\n\t\treturn false\n\n\t# they must have the exact same prototype chain, the closest we can do is\n\t# test there constructor.\n\tif x.constructor != y.constructor\n\t\treturn false\n\n\tfor p of x\n\t\tif doSkip p\n\t\t\tcontinue\n\n\t\t# other properties were tested using x.constructor === y.constructor\n\t\tif !x.hasOwnProperty(p)\n\t\t\tcontinue\n\n\t\t# allows to compare x[ p ] and y[ p ] when set to undefined\n\t\tif !y.hasOwnProperty(p)\n\t\t\treturn false\n\n\t\t# if they have the same strict value or identity then they are equal\n\t\tif x[p] == y[p]\n\t\t\tcontinue\n\n\t\t# Numbers, Strings, Functions, Booleans must be strictly equal\n\t\tif typeof x[p] != 'object'\n\t\t\treturn false\n\n\t\t# Objects and Arrays must be tested recursively\n\t\tif !equals(x[p], y[p], skip)\n\t\t\treturn false\n\n\tfor p of y\n\t\tif doSkip p\n\t\t\tcontinue\n\t\t`p = p`\n\t\t# allows x[ p ] to be set to undefined\n\t\tif y.hasOwnProperty(p) and !x.hasOwnProperty(p)\n\t\t\treturn false\n\ttrue\n\n#\n# Generate CSS hex color based on input string\n#\n#\n#\nstringToColour = (str) ->\n\t\n\thash = 0\n\ti = 0\n\ti = 0\n\twhile i < str.length\n\t\thash = str.charCodeAt(i) + (hash << 5) - hash\n\t\ti++\n\tcolour = '#'\n\ti = 0\n\twhile i < 3\n\t\tvalue = hash >> i * 8 & 0xFF\n\t\tcolour += ('00' + value.toString(16)).substr(-2)\n\t\ti++\n\tcolour\n\npreloadedImages = {}\n\n#\n# Preload image of element\n# @param element DomElement\n#\npreload = (element, src) ->\n\tif preloadedImages[src]\n\t\telement.attr \"src\", src\n\t\treturn\n\timage = new Image\n\timage.src = src\n\timage.onload = () ->\n\t\timage = null\n\t\tpreloadedImages[src] = true\n\t\telement.attr \"src\", src\n\nensureAttribute = (element, attribute) ->\n\tif not element.hasAttribute attribute\n\t\tattr = document.createAttribute(attribute)\n\t\tattr.value = ''\n\t\telement.setAttributeNode(attr)\n\t\telement.setAttribute(attribute, '')\n\t\tjQuery(element).attr(attribute, '')\n\n###\n# Number.prototype.format(n, x, s, c)\n# @see http://stackoverflow.com/a/14428340/5444623\n# @param float   number: number to format\n# @param integer n: length of decimal\n# @param integer x: length of whole part\n# @param mixed   s: sections delimiter\n# @param mixed   c: decimal delimiter\n###\nnumberFormat = (number, n = 2, x = 3, s = ' ', c = ',') ->\n\tre = '\\\\d(?=(\\\\d{' + (x or 3) + '})+' + (if n > 0 then '\\\\D' else '$') + ')'\n\tnum = number.toFixed(Math.max(0, ~ ~n))\n\t(if c then num.replace('.', c) else num).replace new RegExp(re, 'g'), '$&' + (s or ',')\n\nlcfirst = (str) ->\n\tstr = str.substring(0,1).toLocaleLowerCase() + str.substring(1);\n\nucfirst = (str) ->\n\tstr = str.substring(0,1).toLocaleUpperCase() + str.substring(1);\n\"use strict\"\nif not @Maslosoft\n\t@Maslosoft = {}\nif not @Maslosoft.Ko\n\t@Maslosoft.Ko = {}\nif not @Maslosoft.Ko.Balin\n\t@Maslosoft.Ko.Balin = {}\nif not @Maslosoft.Binder\n\t@Maslosoft.Binder = {}\nif not @Maslosoft.Binder.Helpers\n\t@Maslosoft.Binder.Helpers = {}\nif not @Maslosoft.Binder.Widgets\n\t@Maslosoft.Binder.Widgets = {}\n\n#\n#\n# Extra utils\n#\n\n#\n# Debounce function\n# @link https://john-dugan.com/javascript-debounce/\n#\n@Maslosoft.Ko.debounce = (func, wait, immediate) ->\n  timeout = undefined\n  ->\n    context = this\n    args = arguments\n\n    later = ->\n      timeout = null\n      if !immediate\n        func.apply context, args\n      return\n\n    callNow = immediate and !timeout\n    clearTimeout timeout\n    timeout = setTimeout(later, wait or 200)\n    if callNow\n      func.apply context, args\n    return\n\n#\n# Register binding handler\n# @param string name\n# @params Maslosoft.Binder.Base handler\n#\n@Maslosoft.Binder.register = (name, handler) ->\n\n\tname2 = false\n\tif name.match /[A-Z]/\n\t\tname2 = name.toLowerCase()\n\n\t# Assign two way. Not sure if necessary in current ko\n\tif handler.writable\n\t\tif ko.expressionRewriting and ko.expressionRewriting.twoWayBindings\n\t\t\tko.expressionRewriting.twoWayBindings[name] = true\n\t\t\tif name2\n\t\t\t\tko.expressionRewriting.twoWayBindings[name2] = true\n\n\tko.bindingHandlers[name] = handler\n\n\t# Lower-case version of binding handler for punches\n\tif name2\n\t\tko.bindingHandlers[name2] = handler\n\n\t#Reassign options\n\t#ko.bindingHandlers[name].options = JSON.parse(JSON.stringify(handler.options))\n\n\n#\n# Register default set of binding handlers, or part of default set\n#\n@Maslosoft.Binder.registerDefaults = (handlers = null) ->\n\t# In alphabetical order\n\tconfig = {\n\t\tacl: Maslosoft.Binder.Acl\n\t\tactive: Maslosoft.Binder.Active\n\t\taction: Maslosoft.Binder.WidgetAction\n\t\tactivity: Maslosoft.Binder.WidgetActivity\n\t\tasset: Maslosoft.Binder.Asset\n\t\tcssClasses: Maslosoft.Binder.CssClasses\n\t\tcssColumnSizes: Maslosoft.Binder.CssColumnSizes\n\t\tcssColumns: Maslosoft.Binder.CssColumns\n\t\tdata: Maslosoft.Binder.Data\n\t\tdateFormatter: Maslosoft.Binder.DateFormatter\n\t\tdatePicker: Maslosoft.Binder.DatePicker\n\t\tdatePickerPickaDate: Maslosoft.Binder.PickaDate\n\t\tdateTimeFormatter: Maslosoft.Binder.DateTimeFormatter\n\t\tdecimalFormatter: Maslosoft.Binder.DecimalFormatter\n\t\tdisabled: Maslosoft.Binder.Disabled\n\t\tenumCssClassFormatter: Maslosoft.Binder.EnumCssClassFormatter\n\t\tenumFormatter: Maslosoft.Binder.EnumFormatter\n\t\teval: Maslosoft.Binder.Eval\n\t\tfancytree: Maslosoft.Binder.Fancytree\n\t\tfileSizeFormatter: Maslosoft.Binder.FileSizeFormatter\n\t\tgooglemap: Maslosoft.Binder.GoogleMap\n\t\thidden: Maslosoft.Binder.Hidden\n\t\thref: Maslosoft.Binder.Href\n\t\thtml: Maslosoft.Binder.Html\n\t\thtmlTree: Maslosoft.Binder.HtmlTree\n\t\thtmlValue: Maslosoft.Binder.HtmlValue\n\t\ticon: Maslosoft.Binder.Icon\n\t\tid: Maslosoft.Binder.Id\n\t\tlog: Maslosoft.Binder.Log\n\t\tmodel: Maslosoft.Binder.DataModel\n\t\tplaceholder: Maslosoft.Binder.Placeholder\n\t\tref: Maslosoft.Binder.Widget\n\t\tsrc: Maslosoft.Binder.Src\n\t\ttags: Maslosoft.Binder.Tags\n\t\ttext: Maslosoft.Binder.Text\n\t\ttextToBg: Maslosoft.Binder.TextToBg\n\t\ttextValue: Maslosoft.Binder.TextValue\n\t\ttextValueHlJs: Maslosoft.Binder.TextValueHLJS\n\t\ttimeAgoFormatter: Maslosoft.Binder.TimeAgoFormatter\n\t\ttimeFormatter: Maslosoft.Binder.TimeFormatter\n\t\ttimePicker: Maslosoft.Binder.TimePicker\n\t\ttooltip: Maslosoft.Binder.Tooltip\n\t\ttreegrid: Maslosoft.Binder.TreeGrid\n\t\ttreegridnode: Maslosoft.Binder.TreeGridNode\n\t\tselected: Maslosoft.Binder.Selected\n\t\tselect2: Maslosoft.Binder.Select2\n\t\tvalidator: Maslosoft.Binder.Validator\n\t\tvideoPlaylist: Maslosoft.Binder.VideoPlaylist\n\t\tvideoThumb: Maslosoft.Binder.VideoThumb\n\t\twidget: Maslosoft.Binder.Widget\n\t}\n\n\tif handlers isnt null\n\t\tfor index, value of handlers\n\t\t\tMaslosoft.Binder.register(value, new config[value])\n\telse\n\t\tfor index, value of config\n\t\t\tMaslosoft.Binder.register(index, new value)\n\n#\n# Register default set of event handlers, or part of default set\n#\n@Maslosoft.Binder.registerEvents = (handlers = null) ->\n\tconfig = {\n\t\t'dblclick',\n\t\t'mousedown',\n\t\t'mouseup',\n\t\t'mouseover',\n\t\t'mouseout',\n\t}\n\tif handlers isnt null\n\t\tfor index, value of handlers\n\t\t\tMaslosoft.Binder.makeEventHandlerShortcut(value)\n\telse\n\t\tfor index, value of config\n\t\t\tMaslosoft.Binder.makeEventHandlerShortcut(value)\n\n@Maslosoft.Binder.makeEventHandlerShortcut = (eventName) ->\n\tko.bindingHandlers[eventName] = init: (element, valueAccessor, allBindings, viewModel, bindingContext) ->\n\t\tnewValueAccessor = ->\n\t\t\tresult = {}\n\t\t\tresult[eventName] = valueAccessor()\n\t\t\tresult\n\n\t\tko.bindingHandlers[\"event\"][\"init\"].call this, element, newValueAccessor, allBindings, viewModel, bindingContext\n\n\treturn\n\n#\n# Base class for Maslosoft binding handlers\n#\nclass @Maslosoft.Binder.Base\n\n\t#\n\t# Whenever to register binding handler as writable\n\t# @var boolean\n\t#\n\twritable: true\n\n\t#\n\t# @var @Maslosoft.Binder.Options\n\t#\n\toptions: {}\n\n\t# Class constructor\n\t# @param options @Maslosoft.Binder.Options\n\t#\n\tconstructor: (options = {}) ->\n\t\t#\tSet ref to current object, not prototype\n\t\t@options = {}\n\t\tfor name, value of options\n\t\t\t@options[name] = value\n\n\t#\n\t# Get value from model\n\t#\n\tgetValue: (valueAccessor, defaults = '') =>\n\t\tif typeof(valueAccessor) is 'function'\n\t\t\tvalue = ko.unwrap(valueAccessor())\n\t\telse\n\t\t\tvalue = ko.unwrap(valueAccessor)\n\t\tif @options.valueField\n\t\t\tif @options.ec5\n\t\t\t\tvalue = value[@options.valueField]\n\t\t\telse\n\t\t\t\tvalue = value[@options.valueField]()\n\t\t\t\t\n\t\t# Only use defaults when undefined\n\t\tif typeof(value) is 'undefined'\n\t\t\treturn defaults\n\t\treturn value\n\nclass @Maslosoft.Binder.Options\n\n\t# Set this if need to access complex date objects\n\t# @var string\n\t#\n\tvalueField: null\n\n\t# Whenever to use ko ecmascript 5 plugin\n\t# Will autodetect if not set\n\t# @var boolean\n\t#\n\tec5: null\n\n\tafterUpdate: null\n\n\tconstructor: (values = {}) ->\n\n\t\tfor index, value of values\n\t\t\t@[index] = value\n\n\t\tif @ec5 is null\n\t\t\t@ec5 = !!ko.track\n\n\t\tif @afterUpdate is null\n\t\t\t@afterUpdate = (element, value) ->\n\t\t\t\t\n\n\n#\n# Configuration class for css bindings\n#\nclass @Maslosoft.Binder.CssOptions extends @Maslosoft.Binder.Options\n\t\n\tclassName: 'active'\n\n#\n# Configuration class for date bindings\n#\nclass @Maslosoft.Binder.DateOptions extends @Maslosoft.Binder.Options\n\n\t#\n\t# Language for locale formatting\n\t# @var string\n\t#\n\tlang: 'en'\n\n\t# Date source format\n\t# @var string\n\t#\n\tsourceFormat: 'unix'\n\n\t# Date display format\n\t# @var string\n\t#\n\tdisplayFormat: 'YYYY-MM-DD'\n\n#\n# Configuration class for datetime bindings\n#\nclass @Maslosoft.Binder.DateTimeOptions extends @Maslosoft.Binder.Options\n\n\t#\n\t# Language for locale formatting\n\t# @var string\n\t#\n\tlang: 'en'\n\n\t# DateTime source format\n\t# @var string\n\t#\n\tsourceFormat: 'unix'\n\n\t# DateTime display format\n\t# @var string\n\t#\n\tdisplayFormat: 'YYYY-MM-DD hh:mm'\n\n#\n# Configuration class for time bindings\n#\nclass @Maslosoft.Binder.TimeAgoOptions extends @Maslosoft.Binder.Options\n\n\t#\n\t# Language for locale formatting\n\t# @var string\n\t#\n\tlang: 'en'\n\n\t# Time source format\n\t# @var string\n\t#\n\tsourceFormat: 'unix'\n\n\t# Time display format\n\t# @var string\n\t#\n\tdisplayFormat: 'hh:mm'\n\n#\n# Configuration class for time bindings\n#\nclass @Maslosoft.Binder.TimeOptions extends @Maslosoft.Binder.Options\n\n\t#\n\t# Language for locale formatting\n\t# @var string\n\t#\n\tlang: 'en'\n\n\t# Time source format\n\t# @var string\n\t#\n\tsourceFormat: 'unix'\n\n\t# Time display format\n\t# @var string\n\t#\n\tdisplayFormat: 'hh:mm'\n\n#\n# Configuration class for css bindings\n#\nclass @Maslosoft.Binder.ValidatorOptions extends @Maslosoft.Binder.Options\n\n\t#\n\t# Field for class name\n\t# @var string\n\t#\n\tclassField: '_class'\n\n\t#\n\t# CSS selector to find parent element\n\t# @var string\n\t#\n\tparentSelector: '.form-group'\n\n\t#\n\t# Failed validation class name.\n\t# This class will be added to input if validation fails.\n\t# @var string\n\t#\n\tinputError: 'error'\n\n\t#\n\t# Failed validation parent class name.\n\t# This class will be added to parent of input if validation fails.\n\t# @var string\n\t#\n\tparentError: 'has-error'\n\n\t#\n\t# Warning validation class name.\n\t# This class will be added to input if validation has warnings.\n\t# @var string\n\t#\n\tinputWarning: 'warning'\n\n\t#\n\t# Warning validation parent class name.\n\t# This class will be added to parent of input if validation has warnings.\n\t# @var string\n\t#\n\tparentWarning: 'has-warning'\n\n\t#\n\t# Succeed validation class name.\n\t# This class will be added to input if validation succeds.\n\t# @var string\n\t#\n\tinputSuccess: 'success'\n\n\t#\n\t# Succeed validation parent class name.\n\t# This class will be added to parent of input if validation succeds.\n\t# @var string\n\t#\n\tparentSuccess: 'has-success'\n\n\t#\n\t# Selector for error messages. Will scope from input parent.\n\t# @var string\n\t#\n\terrorMessages: '.error-messages'\n\n\t#\n\t# Selector for warning messages. Will scope from input parent.\n\t# @var string\n\t#\n\twarningMessages: '.warning-messages'\n\n\n\nclass @Maslosoft.Binder.BaseValidator\n\n\tlabel: ''\n\n\tmodel: null\n\n\tmessages: []\n\n\trawMessages: []\n\n\twarningMessages: []\n\n\trawWarningMessages: []\n\n\tconstructor: (config) ->\n\t\t@reset()\n\t\tfor index, value of config\n\t\t\t@[index] = null\n\t\t\t@[index] = value\n\n\treset: () ->\n\t\t# Dereference/reset\n\t\t@messages = new Array\n\t\t@rawMessages = new Object\n\t\t@warningMessages = new Array\n\t\t@rawWarningMessages = new Object\n\n\tisValid:() ->\n\t\tthrow new Error('Validator must implement `isValid` method')\n\n\tgetErrors: () ->\n\t\treturn @messages\n\n\tgetWarnings: () ->\n\t\treturn @warningMessages\n\n\t#\n\t# Add error message with optional substitution params.\n\t#\n\t# Simple example:\n\t# ```coffee\n\t# @addError('My error message')\n\t#\t```\n\t#\n\t# Automatic substitution with label example:\n\t# ```coffee\n\t# @addError('Attribute {attribute} message')\n\t#\t```\n\t#\n\t# Will add error message: 'Attribute My attribute message'\n\t#\n\t# Substitution with params example:\n\t# ```coffee\n\t# @addError('Attribute {name} message', {name: 'John'})\n\t#\t```\n\t#\n\t# Will add error message: 'Attribute John message'\n\t#\n\taddError: (errorMessage, params) ->\n\n\t\t# Raw is required for uniquness, see method end\n\t\trawMessage = errorMessage\n\n\t\t# Apply atribute label first\n\t\terrorMessage = errorMessage.replace \"{attribute}\", @label\n\n\t\t# Apply from current validator\n\t\tfor name, value of @\n\t\t\terrorMessage = errorMessage.replace \"{#{name}}\", value\n\n\t\t# Apply from params\n\t\tfor name, value of params\n\t\t\terrorMessage = errorMessage.replace \"{#{name}}\", value\n\n\t\t# Finally try to apply from model\n\t\tfor name, value of @model\n\t\t\terrorMessage = errorMessage.replace \"{#{name}}\", value\n\n\n\t\t# Ensure uniquness\n\t\tif not @rawMessages[rawMessage]\n\t\t\t@messages.push errorMessage\n\t\t\t@rawMessages[rawMessage] = true\n\n\t#\n\t# Add warning message with optional substitution params.\n\t#\n\t# Simple example:\n\t# ```coffee\n\t# @addWarning('My error message')\n\t#\t```\n\t#\n\t# Automatic substitution with label example:\n\t# ```coffee\n\t# @addWarning('Attribute {attribute} message')\n\t#\t```\n\t#\n\t# Will add warning message: 'Attribute My attribute message'\n\t#\n\t# Substitution with params example:\n\t# ```coffee\n\t# @addWarning('Attribute {name} message', {name: 'John'})\n\t#\t```\n\t#\n\t# Will add warning message: 'Attribute John message'\n\t#\n\taddWarning: (warningMessage, params) ->\n\n\t\t# Raw is required for uniquness, see method end\n\t\trawMessage = warningMessage\n\n\t\t# Apply atribute label first\n\t\twarningMessage = warningMessage.replace \"{attribute}\", @label\n\n\t\t# Apply from current validator\n\t\tfor name, value of @\n\t\t\twarningMessage = warningMessage.replace \"{#{name}}\", value\n\n\t\t# Apply from params\n\t\tfor name, value of params\n\t\t\twarningMessage = warningMessage.replace \"{#{name}}\", value\n\n\t\t# Finally try to apply from model\n\t\tfor name, value of @model\n\t\t\twarningMessage = warningMessage.replace \"{#{name}}\", value\n\n\n\t\t# Ensure uniquness\n\t\tif not @rawWarningMessages[rawMessage]\n\t\t\t@warningMessages.push warningMessage\n\t\t\t@rawWarningMessages[rawMessage] = true\n\n#\n# CSS class binding\n# This adds class from options if value is true\n#\nclass @Maslosoft.Binder.CssClass extends @Maslosoft.Binder.Base\n\n\twritable: false\n\n\tupdate: (element, valueAccessor) =>\n\t\tvalue = @getValue(valueAccessor)\n\t\tif !!value\n\t\t\tko.utils.toggleDomNodeCssClass(element, @options.className, true);\n\t\telse\n\t\t\tko.utils.toggleDomNodeCssClass(element, @options.className, false);\n\t\treturn\n\n#\n# CSS class binding\n# This adds class from options if value is true\n#\nclass @Maslosoft.Binder.CssColumnsBase extends @Maslosoft.Binder.Base\n\n\twritable: false\n\n\tapplyColumns: (element, sizes, config) =>\n\n\t\tnewClasses = []\n\t\tfor size, name of config\n\t\t# Remove previously set classes\n\t\t\treName = name.replace '{num}', '\\\\d'\n\t\t\tname = name.replace '{num}', ''\n\t\t\tre = new RegExp(\"(?:^|\\\\s)#{reName}+(?!\\\\S)\", 'g')\n\t\t\telement.className = element.className.replace(re, '')\n\t\t\tnewClasses.push name + sizes[size];\n\n\t\tjQuery(element).addClass newClasses.join ' '\n\t\treturn\n\n#\n# Moment formatter class\n#\nclass @Maslosoft.Binder.MomentFormatter extends @Maslosoft.Binder.Base\n\n\tinit: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\tmoment.locale @options.lang\n\t\treturn\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\tvalue = @getValue(valueAccessor)\n\t\tif not value\n\t\t\telement.innerHTML = ''\n\t\t\treturn\n\t\telement.innerHTML = moment[@options.sourceFormat](value).format(@options.displayFormat)\n\t\treturn\n\n#\n# Base class for date/time pickers\n#\n#\nclass @Maslosoft.Binder.Picker extends @Maslosoft.Binder.Base\n\n#\n# Base class for video related bindings\n#\nclass @Maslosoft.Binder.Video extends @Maslosoft.Binder.Base\n\n\toptions = null\n\tadapters = null\n\n\tjQuery(document).ready () ->\n\n\t\t# Initalize thumbnails adapters\n\t\toptions = new Maslosoft.Playlist.Options\n\n\t\t# Set adapters from options\n\t\tadapters = options.adapters\n\n\t#\n\t# Check is supported video url\n\t# @param url string\n\t# @return false|object\n\t#\n\tisVideoUrl: (url) =>\n\t\tfor adapter in adapters\n\t\t\tif adapter.match url\n\t\t\t\treturn adapter\n\t\treturn false\n\n\t#\n\t# Will set image src attribute to video thumbnail,\n\t# or element background-image style if it's not image\n\t# @param url string\n\t# @param element DomElement\n\t#\n\tsetThumb: (url, element) =>\n\t\tif adapter = @isVideoUrl url\n\n\t\t\tthumbCallback = (src) ->\n\t\t\t\tif element.tagName.toLowerCase() is 'img'\n\t\t\t\t\telement.src = src\n\t\t\t\telse\n\t\t\t\t\tjQuery(element).css 'background-image', \"url('#{src}')\"\n\n\t\t\tconsole.log url\n\t\t\t# Init adapter\n\t\t\tad = new adapter\n\t\t\tad.setUrl url\n\t\t\tad.setThumb thumbCallback\n\n\nclass @Maslosoft.Binder.WidgetUrl extends @Maslosoft.Binder.Base\n\n\tgetData: (element, valueAccessor, allBindings, bindingName) ->\n\t\tsrc = @getValue(valueAccessor)\n\n\t\tdata = {}\n\t\tdata.id = allBindings.get('widgetId') or src.id\n\n\t\tif allBindings.get('widget')\n\t\t\tdata.id = allBindings.get('widget').id\n\n\t\tdata[bindingName] = allBindings.get(bindingName) or src[bindingName]\n\n\t\t# Need to check for undefined here,\n\t\t# as params might be `0` or `` or `false`\n\t\tbindingParams = allBindings.get('params');\n\t\tif typeof(bindingParams) is undefined\n\t\t\tdata.params = src.params\n\t\telse\n\t\t\tdata.params = bindingParams\n\t\t\n\t\tdata.params = @getValue(data.params)\n\n\t\tif typeof(src) is 'string'\n\t\t\tdata[bindingName] = src\n\t\t\n\t\treturn data\n\n\tcreateUrl: (widgetId, action, params, terminator) =>\n\t\t\n\t\targs = [];\n\t\t# Assign one value params\n\t\t\n\t\tif typeof(params) is 'string' or typeof(params) is 'number'\n\t\t\t# Skip empty strings\n\t\t\tif params isnt \"\" or typeof(params) is 'number'\n\t\t\t\targs.push \"\" + params\n\t\telse\n\t\t\tfor name, value of params\n\t\t\t\tname = encodeURIComponent(\"\" + name)\n\t\t\t\tvalue = encodeURIComponent(\"\" + value)\n\t\t\t\targs.push \"#{name}:#{value}\"\n\t\t\n\t\thref = \"#{terminator}#{widgetId}.#{action}\";\n\t\t\n\t\tif args.length is 0\n\t\t\treturn href;\n\t\telse\n\t\t\targs = args.join(',', args)\n\t\t\treturn \"#{href}=#{args}\"\n\n\tsetRel: (element) =>\n\n\t\thasRel = false\n\t\tisPlain = false\n\t\trels = []\n\t\trel = element.getAttribute('rel')\n\t\tif rel\n\t\t\trels = rel.split(' ')\n\t\t\tfor relValue in rels\n\t\t\t\tif relValue is 'plain'\n\t\t\t\t\tisPlain = true\n\t\t\t\tif relValue is 'virtual'\n\t\t\t\t\thasRel = true\n\n\t\tif not hasRel and not isPlain\n\t\t\trels.push 'virtual'\n\n\t\telement.setAttribute('rel', rels.join(' '))\n#\n# Acl binding\n# This adds class from options if value is true\n#\nclass @Maslosoft.Binder.Acl extends @Maslosoft.Binder.Base\n\t\n\tallow = null\n\n\tinit: () =>\n\t\tif not Maslosoft.Binder.Acl.allow\n\t\t\tthrow new Error(\"Acl binding handler requires Maslosoft.Binder.Acl.allow to be function checking permissions\")\n\n\t\tif typeof(Maslosoft.Binder.Acl.allow) isnt 'function'\n\t\t\tthrow new Error(\"Acl binding handler requires Maslosoft.Binder.Acl.allow to be function checking permissions\")\n\n\tupdate: (element, valueAccessor) =>\n\t\tacl = @getValue(valueAccessor)\n\t\tvalue = Maslosoft.Binder.Acl.allow(acl)\n\n\t\t# Forward to visible\n\t\tko.bindingHandlers.visible.update element, ->\n\t\t\tvalue\n#\n# Disabled binding\n# This adds class from options if value is true\n#\nclass @Maslosoft.Binder.Active extends @Maslosoft.Binder.CssClass\n\n\tconstructor: (options) ->\n\t\tsuper new Maslosoft.Binder.CssOptions({className: 'active'})\n\n#\n# Asset binding handler\n#\nclass @Maslosoft.Binder.Asset extends @Maslosoft.Binder.Base\n\n\tupdate: (element, valueAccessor, allBindings) =>\n\t\t$element = $(element)\n\n\t\t# Get dimensions defined by other bindings\n\t\twidth = allBindings.get 'w' or allBindings.get 'width' or null\n\t\theight = allBindings.get 'h' or allBindings.get 'height' or null\n\n\t\t# Get proportional flag if set\n\t\tproportional = allBindings.get 'p' or allBindings.get 'proportional' or null\n\n\t\tmodel = @getValue(valueAccessor)\n\n\t\textra = @getValue(allBindings)\n\n\t\t# Try to get timestamp\n\t\tif model.updateDate\n\t\t\tdate = model.updateDate\n\t\t\tif(typeof(date) is 'number')\n\t\t\t\tsec = date\n\t\t\tif(typeof(date.sec) is 'number')\n\t\t\t\tsec = date.sec\n\t\turl = model.url\n\n\t\t# Create new url including width, height and if it should cropped proportionally\n\t\tsrc = []\n\n\t\t# Add base url of asset\n\t\tsrc.push url\n\n\t\t# Add width\n\t\tif width\n\t\t\tsrc.push \"w/#{width}\"\n\n\t\t# Add height\n\t\tif height\n\t\t\tsrc.push \"h/#{height}\"\n\n\t\t# Crop to provided dimensions if not proportional\n\t\tif proportional is false\n\t\t\tsrc.push \"p/0\"\n\n\t\t# Add timestamp\n\t\tif sec\n\t\t\tsrc.push sec\n\n\t\t# Join parts of url\n\t\tsrc = src.join '/'\n\n\t\tif $element.attr(\"src\") != src\n\n\t\t\tif extra.preloader\n\t\t\t\t$element.attr 'src', extra.preloader\n\n\t\t\t# Preload image\n\t\t\tpreload $element, src\n\t\treturn\n\n#\n# Enum css class handler\n#\nclass @Maslosoft.Binder.CssClasses extends @Maslosoft.Binder.Base\n\n\tgetClassList: (valueAccessor) =>\n\t\tclasses = @getValue valueAccessor\n\t\tif typeof(classes) is 'undefined'\n\t\t\treturn ''\n\t\tif classes is null\n\t\t\treturn ''\n\t\tif typeof(classes) is 'string'\n\t\t\tclassList = classes\n\t\telse\n\t\t\tclassList = classes.join(' ')\n\n\t\treturn classList.replace(/^\\s*/, '').replace(/\\s*$/, '')\n\n\tinit: (element, valueAccessor) =>\n\t\tinitialClasses = @getClassList(valueAccessor)\n\n\t\telement.setAttribute('data-css-classes', initialClasses)\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\ttoRemove = element.getAttribute('data-css-classes')\n\n\t\tko.utils.toggleDomNodeCssClass element, toRemove, false\n\n\t\tclassesToAdd = @getClassList(valueAccessor)\n\n\t\tif classesToAdd\n\t\t\tko.utils.toggleDomNodeCssClass element, classesToAdd, true\n\n\t\telement.setAttribute('data-css-classes', classesToAdd)\n#\n# Enum css class handler\n#\nclass @Maslosoft.Binder.CssColumns extends @Maslosoft.Binder.CssColumnsBase\n\n\t@columns = {\n\t\t'xs': 'col-xs-{num}',\n\t\t'sm': 'col-sm-{num}',\n\t\t'md': 'col-md-{num}',\n\t\t'lg': 'col-lg-{num}'\n\t}\n\n\tinit: (element, valueAccessor) =>\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\tcolumns = @getValue valueAccessor\n\n\t\tsizes = {}\n\n\t\tfor size, name of CssColumns.columns\n\t\t\tvalue = parseInt columns[size]\n\t\t\tcols = parseInt 12 / value\n\t\t\tsizes[size] = cols\n\n\t\t@applyColumns element, sizes, CssColumns.columns\n\n#\n# Enum css class handler\n#\nclass @Maslosoft.Binder.CssColumnSizes extends @Maslosoft.Binder.CssColumnsBase\n\n\t@columns = {\n\t\t'xs': 'col-xs-{num}',\n\t\t'sm': 'col-sm-{num}',\n\t\t'md': 'col-md-{num}',\n\t\t'lg': 'col-lg-{num}'\n\t}\n\n\tinit: (element, valueAccessor) =>\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\tsizes = @getValue valueAccessor\n\t\t@applyColumns element, sizes, CssColumnSizes.columns\n\n\n\n\n#\n# Data binding handler\n#\nclass @Maslosoft.Binder.Data extends @Maslosoft.Binder.Base\n\n\tgetNamespacedHandler: (binding) ->\n\t\treturn {\n\t\t\tupdate: (element, valueAccessor) =>\n\t\t\t\tvalue = @getValue(valueAccessor)\n\t\t\t\tif typeof(value) not in ['string', 'number']\n\t\t\t\t\tvalue = JSON.stringify(value)\n\t\t\t\telement.setAttribute('data-' + binding, value)\n\t\t\t}\n\n#\n# Model binding handler\n# This is to bind selected model properties to data-model field\n#\nclass @Maslosoft.Binder.DataModel extends @Maslosoft.Binder.Base\n\n\tupdate: (element, valueAccessor, allBindings) =>\n\t\t\n\t\t# Setup binding\n\t\tmodel = @getValue(valueAccessor)\n\t\tfields = allBindings.get(\"fields\") or null\n\n\t\t# Bind all fields if not set `fields` binding\n\t\tif fields is null\n\t\t\t@bindModel(element, model)\n\t\t\treturn\n\n\t\t# Bind only selected fields\n\t\tmodelStub = {}\n\t\tfor field in fields\n\t\t\t# Filter out undefined model fields\n\t\t\tif typeof(model[field]) is 'undefined'\n\t\t\t\twarn \"Model field `#{field}` is undefined on element:\", element\n\t\t\telse\n\t\t\t\tmodelStub[field] = model[field]\n\n\t\t\t@bindModel(element, modelStub)\n\n\n\tbindModel: (element, model) ->\n\n\t\t# Do not stringify scalars\n\t\tif typeof(value) not in ['string', 'number']\n\t\t\tmodelString = JSON.stringify(model)\n\n\t\telement.setAttribute('data-model', modelString)\n\n#\n# Date formatter\n#\nclass @Maslosoft.Binder.DateFormatter extends @Maslosoft.Binder.MomentFormatter\n\n\tconstructor: (options) ->\n\t\tsuper new Maslosoft.Binder.DateOptions(options)\n\n\n###\nDate picker\n###\nclass @Maslosoft.Binder.DatePicker extends @Maslosoft.Binder.Picker\n\n\tconstructor: (options) ->\n\t\tsuper new Maslosoft.Binder.DateOptions(options)\n\t\n\tgetData: (valueAccessor) ->\n\t\tif not valueAccessor\n\t\t\treturn ''\n\t\t# Verbose syntax, at least {data: data}\n\t\tvalue = @getValue(valueAccessor) or []\n\t\tif value.data\n\t\t\treturn value.data\n\t\treturn value\n\n\tgetOptions: (allBindingsAccessor) ->\n\t\toptions = {\n\t\t\tlang: @options.lang\n\t\t\tsourceFormat: @options.sourceFormat\n\t\t\tdisplayFormat: @options.displayFormat\n\t\t\t# Format of pickadate is not compatible of this of moment\n\t\t\tformat: @options.displayFormat.toLowerCase()\n\t\t\tforceParse: false\n\t\t\ttodayHighlight: true\n\t\t\tshowOnFocus: false\n\t\t}\n\t\tconfig = allBindingsAccessor.get('dateOptions') or []\n\t\t\n\t\t\n\t\t# Only in long notation set options\n\t\tif config\n\t\t\tfor name, value of config\n\n\t\t\t\t# Skip data\n\t\t\t\tif name is 'data'\n\t\t\t\t\tcontinue\n\n\t\t\t\t# Skip template\n\t\t\t\tif name is 'template'\n\t\t\t\t\tcontinue\n\n\t\t\t\t# Special treatment for display format\n\t\t\t\tif name is 'format'\n\t\t\t\t\toptions.displayFormat = value.toUpperCase()\n\t\t\t\t\n\t\t\t\toptions[name] = value\n\t\treturn options\n\n\tupdateModel: (element, valueAccessor, allBindings) =>\n\t\toptions = @getOptions allBindings\n\t\tmodelValue = @getData valueAccessor\n\t\telementValue = @getModelValue element.value, options\n\t\taccessor = valueAccessor()\n\t\t# Update only if changed\n\t\tif modelValue isnt elementValue\n\t\t\tif accessor and accessor.data\n\t\t\t\t\n\t\t\t\tko.expressionRewriting.writeValueToProperty(ko.unwrap(valueAccessor()).data, allBindings, 'datePicker.data', elementValue)\n\t\t\telse\n\t\t\t\tko.expressionRewriting.writeValueToProperty(valueAccessor(), allBindings, 'datePicker', elementValue)\n\t\t\t\n\n\t#\n\t# Get display value from model value according to formatting options\n\t# @param string|int value\n\t# @return string|int\n\t#\n\tgetDisplayValue: (value, options) =>\n\t\t#console.log value\n\t\tif not value\n\t\t\treturn ''\n\t\tif value and value.length is 0\n\t\t\treturn ''\n\t\tif options.sourceFormat is 'unix'\n\t\t\tinputValue = moment.unix(value).format(options.displayFormat)\n\t\telse\n\t\t\tinputValue = moment(value, options.sourceFormat).format(options.displayFormat)\n\t\treturn inputValue\n\n\t#\n\t# Get model value from model value according to formatting options\n\t# @param string|int value\n\t# @return string|int\n\t#\n\tgetModelValue: (value, options) =>\n\t\tif not value\n\t\t\treturn null\n\t\tif options.sourceFormat is 'unix'\n\t\t\tmodelValue = moment(value, options.displayFormat).unix()\n\t\telse\n\t\t\tmodelValue = moment(value, options.displayFormat).format(options.sourceFormat)\n\t\treturn modelValue\n\n\t#\n\t# Initialize datepicker\n\t#\n\t#\n\tinit: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\n\t\toptions = @getOptions allBindingsAccessor\n\n\t\tvalue = @getDisplayValue(@getData(valueAccessor), options)\n\t\t#console.log value\n\t\tif not value\n\t\t\telement.value = ''\n\t\telse\n\t\t\telement.value = value\n\t\t\n\t\tinput = jQuery(element)\n\n\t\tif options.template\n\t\t\ttemplate = options.template\n\t\telse\n\t\t\ttemplate = '''\n\t\t\t<div class=\"input-group-addon\">\n\t\t\t\t<a class=\"picker-trigger-link\" style=\"cursor: pointer;\">\n\t\t\t\t\t<i class=\"glyphicon glyphicon-calendar\"></i>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t\t'''\n\t\taddon = jQuery(template)\n\t\taddon.insertBefore input\n\t\t\n\t\ttrigger = addon.find('a.picker-trigger-link')\n\n\t\tinput.datepicker(options)\n\n\t\t# Trigger only when value has changed, but do not update\n\t\t# picker, ie someone is typing-in date\n\t\tonChangeValue = (e) =>\n\t\t\tvalue = input.datepicker('getDate')\n\t\t\t#console.log value, element.value\n\t\t\tif value\n\t\t\t\t@updateModel element, valueAccessor, allBindingsAccessor\n\t\t\t\t#console.log 'Changing model... onChangeValue'\n\t\t\treturn false\n\n\t\t# When date is changed and change is confirmed\n\t\tonChange = (e) =>\n\t\t\tparsedDate = Date.parse(element.value)\n\t\t\tif parsedDate and not e.isTrigger\n\t\t\t\telement.value = @getDisplayValue(Math.round(parsedDate.getTime() / 1000), options)\n\t\t\t\t@updateModel element, valueAccessor, allBindingsAccessor\n\t\t\t\tinput.datepicker 'update'\n\t\t\t\treturn true\n\t\t\treturn false\n\n\t\t# Don't trigger picker change date, as date need to be parsed by datejs\n\t\tinput.on 'changeDate', (e) =>\n\t\t\tonChangeValue(e)\n\t\t\treturn true\n\n\t\t# Here is actual date change handling\n\t\tinput.on 'change', onChange\n\n\t\tinput.on 'blur', onChange\n\n\t\t# Handle opened state\n\t\tisOpen = false\n\t\tinput.on 'show', (e) =>\n\t\t\tisOpen = true\n\n\t\tinput.on 'hide', (e) =>\n\t\t\tisOpen = false\n\n\t\t# Need mousedown or will no hide on second click\n\t\ttrigger.on 'mousedown', (e) ->\n\t\t\tif isOpen\n\t\t\t\tinput.datepicker('hide')\n\t\t\telse\n\t\t\t\tinput.datepicker('show')\n\t\t\te.stopPropagation()\n\t\t\te.preventDefault()\n\t\t\treturn\n\t\treturn\n\n\t#\n\t# Update input after model change\n\t#\n\t#\n\tupdate: (element, valueAccessor, allBindingsAccessor) =>\n\t\tval = valueAccessor()\n\t\tif val and val.data\n\t\t\t\n\t\t\tko.utils.setTextContent(element, val.data)\n\t\telse\n\t\t\tko.utils.setTextContent(element, val)\n\t\toptions = @getOptions allBindingsAccessor\n\t\tvalue = @getDisplayValue(@getData(valueAccessor), options)\n\t\t\n\t\tif element.value isnt value\n\t\t\telement.value = value\n###\nOne-way date/time formatter\n###\nclass @Maslosoft.Binder.DateTimeFormatter extends @Maslosoft.Binder.MomentFormatter\n\n\tconstructor: (options) ->\n\t\tsuper new Maslosoft.Binder.DateTimeOptions(options)\n\n\n#\n# One-way decimal formatter\n#\nclass @Maslosoft.Binder.DecimalFormatter extends @Maslosoft.Binder.Base\n\n\tprecision: 2\n\n\tdecimalSeparator: ','\n\n\tthousandSeparator: ' '\n\n\tsuffix: ''\n\n\tprefix: ''\n\n\tinit: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\tvalue = @getValue(valueAccessor) or 0\n\t\tvalue = parseFloat(value)\n\n\t\tconfig = {}\n\t\tnames = ['precision', 'decimalSeparator', 'thousandSeparator', 'suffix', 'prefix']\n\t\tfor name in names\n\t\t\t# Set global value\n\t\t\tconfig[name] = @[name]\n\t\t\t\n\t\t\t# Try to set value from bindings\n\t\t\tbound = allBindingsAccessor.get(name)\n\t\t\tif typeof(bound) isnt 'undefined'\n\t\t\t\tconfig[name] = @getValue bound\n\t\t\n\t\tformatted = numberFormat value, config.precision, 3, config.thousandSeparator, config.decimalSeparator\n\n\t\telement.innerHTML = config.prefix + formatted + config.suffix\n#\n# Disabled binding\n# This adds class from options if value is true\n#\nclass @Maslosoft.Binder.Disabled extends @Maslosoft.Binder.CssClass\n\n\tconstructor: (options) ->\n\t\tsuper new Maslosoft.Binder.CssOptions({className: 'disabled'})\n\n#\n# Enum css class handler\n#\nclass @Maslosoft.Binder.EnumCssClassFormatter extends @Maslosoft.Binder.Base\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\tconfig = @getValue valueAccessor\n\t\t\n\t\t# Remove previously set classes\n\t\tfor name in config.values\n\t\t\tre = new RegExp(\"(?:^|\\\\s)#{name}(?!\\\\S)\", 'g')\n\t\t\telement.className = element.className.replace(re, '')\n\n\t\telement.className += ' ' + config.values[config.data]\n\t\treturn\n\n#\n# Enum binding handler\n#\nclass @Maslosoft.Binder.EnumFormatter extends @Maslosoft.Binder.Base\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\tconfig = @getValue valueAccessor\n\t\tif typeof(config.values[config.data]) isnt 'undefined'\n\t\t\telement.innerHTML = config.values[config.data]\n\t\telse\n\t\t\telement.innerHTML = config.data\n\t\treturn\n\n#\n# Eval binding handler\n#\nclass @Maslosoft.Binder.Eval extends @Maslosoft.Binder.Base\n\n\tinit: (element, valueAccessor) =>\n\t\t# Let bindings proceed as normal *only if* my value is false\n\t\tallowBindings = @getValue valueAccessor\n\t\tconsole.log allowBindings\n\t\treturn { controlsDescendantBindings: !allowBindings }\n\n\tupdate: (element, valueAccessor) =>\n\t\t# Let bindings proceed as normal *only if* my value is false\n\t\tallowBindings = @getValue valueAccessor\n\t\tconsole.log allowBindings\n\t\treturn { controlsDescendantBindings: !allowBindings }\n#\n# Fancytree binding\n# TODO Allow sytaxes:\n# data-bind=\"fancytree: data\"\n# data-bind=\"fancytree: {data: data}\"\n# data-bind=\"fancytree: {data: data, options: <fancyTree-options>, autoExpand: true|false}\"\n# TODO When using two or more trees from same data, only first one works properly\n#\nclass @Maslosoft.Binder.Fancytree extends @Maslosoft.Binder.Base\n\n\ttree: null\n\telement: null\n\n\tgetData: (valueAccessor) ->\n\t\t# Verbose syntax, at least {data: data}\n\t\tvalue = @getValue(valueAccessor) or []\n\t\tif value.data\n\t\t\treturn value.data\n\t\treturn value\n\n\tinit: (element, valueAccessor, allBindingsAccessor, context) =>\n\t\ttree = @getData(valueAccessor)\n\t\t# Tree options\n\t\toptions = valueAccessor().options or {}\n\t\tevents = @getValue(valueAccessor).on or false\n\t\t# Effects makes updates flickering, disable\n\t\toptions.toggleEffect = false\n\t\toptions.source = tree.children\n\t\toptions.extensions = []\n\n\t\t# Events\n\t\ttreeEvents = new TreeEvents tree, events, options\n\n\t\t# Accessors for dnd and draggable\n\t\tdnd = valueAccessor().dnd or false\n\t\tdrag = valueAccessor().drag or false\n\n\t\tif dnd and drag\n\t\t\tthrow new Error 'Cannot use both `dnd` and `drag`'\n\n\t\t# DND\n\t\tif dnd\n\t\t\toptions.autoScroll = false\n\t\t\toptions.extensions.push 'dnd'\n\t\t\toptions.dnd = new TreeDnd tree, element, treeEvents\n\t\t\t\n\t\t# Draggable only\n\t\tif drag\n\t\t\toptions.autoScroll = false\n\t\t\toptions.extensions.push 'dnd'\n\t\t\toptions.dnd = new TreeDrag tree, element\n\n\t\t# Node icon and renderer\n\t\tnodeIcon = valueAccessor().nodeIcon or false\n\t\tfolderIcon = valueAccessor().folderIcon or false\n\t\tnodeRenderer = valueAccessor().nodeRenderer or false\n\t\t\n\t\t# Folder icon option\n\t\tif folderIcon and not nodeIcon\n\t\t\twarn \"Option `folderIcon` require also `nodeIcon` or it will not work at all\"\n\t\t\n\t\tif nodeIcon or nodeRenderer\n\t\t\t# Disable tree icon, as custom renderer will be used\n\t\t\tif nodeIcon\n\t\t\t\toptions.icon = false\n\t\t\t\n\t\t\t# Create internal renderer instance\n\t\t\trenderer = new TreeNodeRenderer tree, options, nodeIcon, folderIcon\n\t\t\t\n\t\t\t# Custom title renderer\n\t\t\tif nodeRenderer\n\t\t\t\trenderer.setRenderer(new nodeRenderer(tree, options))\n\t\t\t\n\t\t\toptions.renderNode = renderer.render\n\n\t\tjQuery(element).fancytree(options);\n\n\thandle: (element, valueAccessor, allBindingsAccessor) =>\n\t\tconfig = @getValue(valueAccessor)\n\t\telement = jQuery element\n\t\thandler = () =>\n\n\t\t\tif not element.find('.ui-fancytree').length then return\n\n\t\t\telement.fancytree 'option', 'source', @getData(valueAccessor).children\n\n\t\t\t# Autoexpand handling\n\t\t\tif config.autoExpand\n\t\t\t\telement.fancytree('getRootNode').visit (node) ->\n\t\t\t\t\tnode.setExpanded true\n\t\t\telement.focus()\n\n\t\t# Put rendering to end of queue to ensure bindings are evaluated\n\t\tsetTimeout handler, 0\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\t@handle element, valueAccessor, allBindingsAccessor\n\n#\n# One-way file size formatter\n#\nclass @Maslosoft.Binder.FileSizeFormatter extends @Maslosoft.Binder.Base\n\n\tunits: {\n\t\tbinary: [\n\t\t\t\t\"kiB\"\n\t\t\t\t\"MiB\"\n\t\t\t\t\"GiB\"\n\t\t\t\t\"TiB\"\n\t\t\t\t\"PiB\"\n\t\t\t\t\"EiB\"\n\t\t\t\t\"ZiB\"\n\t\t\t\t\"YiB\"\n\t\t\t],\n\t\tdecimal: [\n\t\t\t\t\"kB\"\n\t\t\t\t\"MB\"\n\t\t\t\t\"GB\"\n\t\t\t\t\"TB\"\n\t\t\t\t\"PB\"\n\t\t\t\t\"EB\"\n\t\t\t\t\"ZB\"\n\t\t\t\t\"YB\"\n\t\t]\n\t}\n\n\tbinary: true\n\n\tinit: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\tvalue = @getValue(valueAccessor) or 0\n\t\t#\n\t\t# TODO This should also be configurable via at binding\n\t\t#\n\t\tbinary = @binary\n\t\tdecimal = !@binary\n\t\t\n\t\tstep = 1024 if binary\n\t\tstep = 1000 if decimal\n\t\tformat = (bytes) =>\n\t\t\tbytes = parseInt(bytes)\n\t\t\tif bytes < step\n\t\t\t\treturn bytes + ' B'\n\t\t\ti = -1\n\t\t\tunits = @units.binary if binary\n\t\t\tunits = @units.decimal if decimal\n\t\t\tloop\n\t\t\t\tbytes = bytes / step\n\t\t\t\ti++\n\t\t\t\tbreak unless bytes > step\n\t\t\tif units[i]\n\t\t\t\tMath.max(bytes, 0.1).toFixed(1) + ' ' + units[i]\n\t\t\telse\n\t\t\t\tMath.max(bytes, 0.1).toFixed(1) + \" ~*#{i * step} * #{step} B\"\n\n\t\telement.innerHTML = format(value)\n#\n# GMap3 binding\n# TODO Allow syntax:\n# data-bind=\"googleMap: config\"\n# TODO When using two or more trees from same data, only first one works properly\n#\nclass @Maslosoft.Binder.GoogleMap extends @Maslosoft.Binder.Base\n\n\tinit: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\t@apply(element, @getValue(valueAccessor))\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\t@apply(element, @getValue(valueAccessor))\n\n\n\tapply: (element, cfg) =>\n\t\tconsole.log element, cfg\n\t\tlatLng = new google.maps.LatLng cfg.lat, cfg.lng\n\t\tmapOptions =\n\t\t\tzoom: cfg.zoom\n\t\t\tcenter: latLng\n\t\t\tmapTypeId: cfg.type\n\n\n\t\tmap = new google.maps.Map element, mapOptions\n\n\t\tif cfg.markers\n\t\t\tmarkerCfg =\n\t\t\t\tposition: latLng\n\t\t\t\tmap: map\n\t\t\tnew google.maps.Marker markerCfg\n\n#\n# Hidden binding handler, opposite to visible\n#\nclass @Maslosoft.Binder.Hidden extends @Maslosoft.Binder.Base\n\t\n\tupdate: (element, valueAccessor) =>\n\t\tvalue = not @getValue(valueAccessor)\n\t\tko.bindingHandlers.visible.update element, ->\n\t\t\tvalue\n\n#\n# Href binding handler\n#\nclass @Maslosoft.Binder.Href extends @Maslosoft.Binder.Base\n\n\tbustLinks = (element) ->\n\t\t# Skip on non anchor elements\n\t\tif element.tagName.toLowerCase() isnt 'a'\n\t\t\treturn\n\t\tdefer = () ->\n\t\t\tfor innerLink in jQuery(element).find('a')\n\t\t\t\t$il = jQuery(innerLink)\n\t\t\t\t$il.replaceWith($il.contents())\n\t\tsetTimeout defer, 0\n\n\tinit: (element, valueAccessor, allBindingsAccessor) =>\n\n\t\thref = @getValue(valueAccessor)\n\n\t\t# Add href attribute if binding have some value\n\t\tif not element.href and href\n\t\t\tensureAttribute element, 'href'\n\n\t\tbustLinks element\n\n\t\t# Stop propagation handling\n\t\tstopPropagation = allBindingsAccessor.get('stopPropagation') or false\n\t\tif stopPropagation\n\t\t\tko.utils.registerEventHandler element, \"click\", (e) ->\n\t\t\t\te.stopPropagation()\n\n\tupdate: (element, valueAccessor, allBindings) =>\n\n\t\tbustLinks element\n\n\t\thref = @getValue(valueAccessor)\n\n\t\tif href\n\t\t\ttarget = allBindings.get('target') or ''\n\t\t\t# Ensure attribute\n\t\t\tensureAttribute element, 'href'\n\t\t\tensureAttribute element, 'target'\n\t\t\tif element.getAttribute('href') isnt href\n\t\t\t\telement.setAttribute 'href', href\n\t\t\tif element.getAttribute('target') isnt target\n\t\t\t\telement.setAttribute 'target', target\n\t\telse\n\t\t\t# Remove attribute if empty\n\t\t\telement.removeAttribute 'href'\n#\n# HTML improved binding handler\n#\nclass @Maslosoft.Binder.Html extends @Maslosoft.Binder.Base\n\n\tinit: (element, valueAccessor, allBindingsAccessor, context) ->\n\t\treturn { 'controlsDescendantBindings': true }\n\n\tupdate: (element, valueAccessor, allBindings, context) =>\n\t\t# setHtml will unwrap the value if needed\n\t\tvalue = @getValue(valueAccessor)\n\n\t\tconfiguration = @getValue(allBindings).plugins\n\n\t\tpm = new PluginsManager(element)\n\n\t\tpm.from configuration\n\n\t\tvalue = pm.getElementValue element, value\n\n\t\tko.utils.setHtml(element, value)\n\n#\n# Html tree binding\n#\n# This simpy builds a nested ul>li struct\n#\n# data-bind=\"htmlTree: data\"\n#\nclass @Maslosoft.Binder.HtmlTree extends @Maslosoft.Binder.Base\n\n\t@drawNode: (data) ->\n\t\t# wrapper = document.createElement 'ul'\n\t\ttitle = document.createElement 'li'\n\t\ttitle.innerHTML = data.title\n\t\t# wrapper.appendChild title\n\t\tif data.children and data.children.length > 0\n\t\t\tchildWrapper = document.createElement 'ul'\n\t\t\tfor node in data.children\n\t\t\t\tchild = HtmlTree.drawNode(node)\n\t\t\t\tchildWrapper.appendChild child\n\t\t\ttitle.appendChild childWrapper\n\t\treturn title\n\n\n\tgetData: (valueAccessor) ->\n\t\t# Verbose syntax, at least {data: data}\n\t\tvalue = @getValue(valueAccessor) or []\n\t\tif value.data\n\t\t\treturn @getValue(value.data) or []\n\t\treturn value\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\tdata = @getValue(valueAccessor)\n\t\twarn \"HtmlTree is experimental, do not use\"\n\t\thandler = () =>\n\t\t\tnodes = HtmlTree.drawNode data\n\t\t\telement.innerHTML = ''\n\t\t\telement.appendChild nodes\n\n\t\t# Put rendering to end of queue to ensure bindings are evaluated\n\t\tsetTimeout handler, 0\n\n#\n# Html value binding\n# WARNING This MUST have parent context, or will not work\n#\nclass @Maslosoft.Binder.HtmlValue extends @Maslosoft.Binder.Base\n\n\t#\n\t# Counter for id generator\n\t# @private\n\t# @static\n\t#\n\tidCounter = 0\n\t\n\tconstructor: (options = {}) ->\n\t\tsuper(options)\n\t\t\n\t\tif ko.bindingHandlers.sortable and ko.bindingHandlers.sortable.options\n\t\t\t# Allow `contenteditable` to get focus\n\t\t\tko.bindingHandlers.sortable.options.cancel = ':input,button,[contenteditable]'\n\n\t#\n\t# Get value of element, this can be overridden, see TextValue for example.\n\t# Will return inner html of element.\n\t#\n\t# @param jQuery element\n\t# @return string\n\t#\n\tgetElementValue: (element) ->\n\t\treturn element.innerHTML\n\n\t#\n\t# Set value of element, this can be overridden, see TextValue for example\n\t# Value param should be valid html.\n\t#\n\t# @param jQuery element\n\t# @param string\n\t#\n\tsetElementValue: (element, value) ->\n\t\telement.innerHTML = value\n\n\tinit: (element, valueAccessor, allBindingsAccessor) =>\n\t\t\n\t\telement.setAttribute('contenteditable', true)\n\t\t\n\t\t# Generate some id if not set, see notes below why\n\t\tif not element.id\n\t\t\telement.id = \"maslosoft-binder-htmlvalue-#{idCounter++}\"\n\n\t\tconfiguration = @getValue(allBindingsAccessor).plugins\n\t\tpm = new PluginsManager(element)\n\n\t\tpm.from configuration\n\n\t\t# Handle update immediately\n\t\thandler = () =>\n\t\t\t# console.log(\"HTML Value Update\", element)\n\t\t\t# On some situations element might be null (sorting), ignore this case\n\t\t\tif not element then return\n\n\t\t\t# This is required in some scenarios, specifically when sorting htmlValue elements\n\t\t\telement = document.getElementById(element.id)\n\t\t\tif not element then return\n\t\t\taccessor = valueAccessor()\n\n\t\t\tmodelValue = @getValue(valueAccessor)\n\t\t\telementValue = @getElementValue(element)\n\t\t\tif ko.isWriteableObservable(accessor)\n\t\t\t\t# Update only if changed\n\t\t\t\telementValue = pm.getModelValue element, elementValue\n\t\t\t\tif modelValue isnt elementValue\n\t\t\t\t\t#console.log \"Write: #{modelValue} = #{elementValue}\"\n\t\t\t\t\taccessor(elementValue)\n\t\t\n\t\t# Handle update, but push update to end of queue\n\t\tdeferHandler = () =>\n\t\t\tsetTimeout handler, 0\n\t\t\n\t\t# NOTE: Event must be bound to parent node to work if parent has contenteditable enabled\n\t\tjQuery(element).on \"keyup, input\", handler\n\n\t\t# This is to allow interaction with tools which could modify content, also to work with drag and drop\n\t\tjQuery(document).on \"mouseup\", deferHandler\n\n\t\tjQuery(document).on \"changed.htmlvalue\", handler\n\n\t\tdispose = (toDispose) ->\n\t\t\tjQuery(toDispose).off \"keyup, input\", handler\n\t\t\tjQuery(document).off \"mouseup\", deferHandler\n\t\t\tjQuery(document).off \"changed.htmlvalue\", handler\n\n\t\tko.utils.domNodeDisposal.addDisposeCallback element, dispose\n\n\t\treturn\n\n\tupdate: (element, valueAccessor, allBindings) =>\n\t\tvalue = @getValue(valueAccessor)\n\n\t\tconfiguration = @getValue(allBindings).plugins\n\n\t\tpm = new PluginsManager(element)\n\n\t\tpm.from configuration\n\n\t\tvalue = pm.getElementValue element, value\n\t\t#console.log value\n\t\tif @getElementValue(element) isnt value\n\t\t\t@setElementValue(element, value)\n\t\treturn\n#\n# Icon binding handler\n# This is to select proper icon or scaled image thumbnail\n#\nclass @Maslosoft.Binder.Icon extends @Maslosoft.Binder.Base\n\n\tupdate: (element, valueAccessor, allBindings) =>\n\t\t$element = $(element)\n\t\tmodel = @getValue(valueAccessor)\n\n\t\textra = @getValue(allBindings)\n\n\t\ticonField = allBindings.get(\"iconField\") or 'icon'\n\t\tif not model\n\t\t\tif console\n\t\t\t\tconsole.warn 'Binding value for `icon` binding not defined, skipping. Element:'\n\t\t\t\tconsole.warn element\n\t\t\t\tconsole.warn (new Error).stack\n\t\t\treturn\n\t\tsrc = model[iconField]\n\n\t\tisSvg = false\n\t\tif src.match /\\.(svg)$/\n\t\t\tisSvg = true\n\n\t\tnameSuffix = ''\n\t\tif src.match /\\.(jpg|jped|gif|png|svg)$/\n\t\t\tmatched = src.match /[^\\/]*?\\.(jpg|jped|gif|png|svg)$/\n\t\t\tnameSuffix = matched[0]\n\t\t\tsrc = src.replace /[^\\/]*?\\.(jpg|jped|gif|png|svg)$/, \"\"\n\n\t\tif not nameSuffix and model.filename\n\t\t\tnameSuffix = model.filename\n\n\t\t# Get icon size\n\t\t# TODO This should be configurable with options\n\t\tif typeof model.iconSize is 'undefined'\n\t\t\tdefaultSize = 16\n\t\telse\n\t\t\tdefaultSize = model.iconSize\n\n\t\tsize = allBindings.get(\"iconSize\") or defaultSize\n\t\tregex = new RegExp(\"/\" + defaultSize + \"/\", \"g\")\n\n\t\t# Check if it's image\n\t\t# TODO This should be configurable with options\n\t\tif typeof model.isImage is 'undefined'\n\t\t\tisImage = true\n\t\telse\n\t\t\tisImage = model.isImage\n\n\t\t# This is to not add scaling params for svg's\n\t\tif isSvg\n\t\t\tisImage = false\n\n\t\t# TODO This must be configurable with options\n\t\tif isImage\n\t\t\t# Get image thumbnail\n\t\t\t# End with /\n\t\t\tif not src.match(new RegExp(\"/$\"))\n\t\t\t\tsrc = src + '/'\n\t\t\t# Dimensions are set\n\t\t\tif src.match(new RegExp(\"/w/\", \"g\"))\n\t\t\t\tsrc = src.replace(regex, \"/\" + size + \"/\")\n\t\t\t# Dimensions are not set, set it here\n\t\t\telse\n\t\t\t\tsrc = src + \"w/#{size}/h/#{size}/p/0/\"\n\t\t\t\t\n\t\t\t# Add timestamp if set\n\t\t\tif model.updateDate\n\t\t\t\tdate = null\n\t\t\t\tif model.updateDate.sec\n\t\t\t\t\tdate = model.updateDate.sec\n\t\t\t\telse\n\t\t\t\t\tdate = model.updateDate\n\t\t\t\tif typeof(date) is 'number'\n\t\t\t\t\tsrc = src + date\n\t\t\t\tif typeof(date) is 'string'\n\t\t\t\t\tsrc = src + date\n\t\telse\n\t\t\t# Calculate size steps for normal icons\n\t\t\tfixedSize = 16\n\t\t\tif size > 16\n\t\t\t\tfixedSize = 32\n\t\t\tif size > 32\n\t\t\t\tfixedSize = 48\n\t\t\tif size > 48\n\t\t\t\tfixedSize = 512\n\t\t\tsrc = src.replace(regex, \"/\" + fixedSize + \"/\")\n\n\t\tif src.match /\\/$/\n\t\t\tsrc = src + nameSuffix\n\t\telse\n\t\t\tsrc = src + '/' + nameSuffix\n\n\t\tif extra.cachebusting\n\t\t\tsrc = src + '?' + new Date().getTime()\n\n\t\t# Update src only if changed\n\t\tif $element.attr(\"src\") != src\n\n\t\t\tif extra.preloader\n\t\t\t\t$element.attr 'src', extra.preloader\n\n\t\t\tpreload $element, src\n\n\t\t# Set max image dimensions\n\t\t$element.css\n\t\t\twidth: \"#{size}px\"\n\t\t\theight: 'auto'\n\t\t\tmaxWidth: '100%'\n\n\t\treturn\n\n#\n# Src binding handler\n#\nclass @Maslosoft.Binder.Id extends @Maslosoft.Binder.Base\n\n\tinit: (element) =>\n\t\tensureAttribute element, 'id'\n\n\tupdate: (element, valueAccessor) =>\n\t\tid = @getValue(valueAccessor)\n\t\tif element.getAttribute('id') isnt id\n\t\t\telement.setAttribute('id', id)\n\n#\n# Log with element reference\n#\n#\nclass @Maslosoft.Binder.Log extends @Maslosoft.Binder.Base\n\n\tupdate: (element, valueAccessor, allBindings) =>\n\t\tconsole.log @getValue(valueAccessor), element\n\n\tinit: (element, valueAccessor, allBindingsAccessor, context) =>\n\t\tconsole.log @getValue(valueAccessor), element\n###\nDate picker\nNOTE: Not recommended, as Pick A Date is not maintanted\n###\nclass @Maslosoft.Binder.PickaDate extends @Maslosoft.Binder.Picker\n\n\tconstructor: (options) ->\n\t\tsuper new Maslosoft.Binder.DateOptions(options)\n\n\tupdateModel: (element, valueAccessor, allBindings) =>\n\t\tmodelValue = @getValue valueAccessor\n\t\telementValue = @getModelValue element.value\n\t\t\n\t\tif ko.isWriteableObservable(valueAccessor) or true\n\t\t\t# Update only if changed\n\t\t\tif modelValue isnt elementValue\n\t\t\t\tko.expressionRewriting.writeValueToProperty(valueAccessor(), allBindings, 'datePicker', elementValue)\n\t\t\t\tval = elementValue\n\t\t\t\t\n\t\telse\n\t\t\t\n\n\t#\n\t# Get display value from model value according to formatting options\n\t# @param string|int value\n\t# @return string|int\n\t#\n\tgetDisplayValue: (value) =>\n\t\tif @options.sourceFormat is 'unix'\n\t\t\tinputValue = moment.unix(value).format(@options.displayFormat)\n\t\telse\n\t\t\tinputValue = moment(value, @options.sourceFormat).format(@options.displayFormat)\n\t\treturn inputValue\n\n\t#\n\t# Get model value from model value according to formatting options\n\t# @param string|int value\n\t# @return string|int\n\t#\n\tgetModelValue: (value) =>\n\t\tif @options.sourceFormat is 'unix'\n\t\t\tmodelValue = moment(value, @options.displayFormat).unix()\n\t\telse\n\t\t\tmodelValue = moment(value, @options.displayFormat).format(@options.sourceFormat)\n\t\treturn modelValue\n\n\tinit: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\n\t\tinputValue = @getDisplayValue(@getValue(valueAccessor))\n\t\t\n\t\ttextInput = jQuery(element)\n\t\ttextInput.val inputValue\n\n\t\tif @options.template\n\t\t\ttemplate = @options.template\n\t\telse\n\t\t\ttemplate = '''\n\t\t\t<div class=\"input-group-addon\">\n\t\t\t\t<a class=\"picker-trigger-link\" style=\"cursor: pointer;\">\n\t\t\t\t\t<i class=\"glyphicon glyphicon-calendar\"></i>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t\t'''\n\t\tpickerWrapper = jQuery(template)\n\t\tpickerWrapper.insertAfter textInput\n\t\t\n\t\tpickerElement = pickerWrapper.find('a.picker-trigger-link')\n\t\t\n\n\t\toptions = {\n\t\t\t# Format of pickadate is not compatible of this of moment\n\t\t\tformat: @options.displayFormat.toLowerCase()\n\t\t\tselectMonths: true\n\t\t\tselectYears: true\n\t\t}\n\n\t\t$inputDate = pickerElement.pickadate(options)\n\t\tpicker = $inputDate.pickadate('picker')\n\n\t\tpicker.on 'set', =>\n\t\t\ttextInput.val picker.get('value')\n\t\t\t@updateModel element, valueAccessor, allBindingsAccessor\n\t\t\treturn\n\n\t\t\n\n\t\tevents = {}\n\n\t\t# On change or other events (paste etc.)\n\t\tevents.change = () =>\n\t\t\tparsedDate = Date.parse(element.value)\n\t\t\tif parsedDate\n\t\t\t\tpicker.set 'select', [\n\t\t\t\t\tparsedDate.getFullYear()\n\t\t\t\t\tparsedDate.getMonth()\n\t\t\t\t\tparsedDate.getDate()\n\t\t\t\t]\n\t\t\t\t@updateModel element, valueAccessor, allBindingsAccessor\n\t\t\treturn\n\n\t\tevents.keyup = (e) ->\n\t\t\tif e.which is 86 and e.ctrlKey\n\t\t\t\tevents.change()\n\t\t\t\t\n\t\t\treturn\n\n\t\t\t\n\t\tevents.mouseup = events.change\n\n\t\t# Focus event of text input\n\t\tevents.focus = () =>\n\t\t\t\n\t\t\tpicker.open false\n\t\t\treturn\n\n\t\t# Blur of text input\n\t\tevents.blur = (e) =>\n\t\t\t# Don't hide picker when clicking picker itself\n\t\t\tif e.relatedTarget\n\t\t\t\treturn\n\t\t\t\n\t\t\tpicker.close()\n\t\t\t@updateModel element, valueAccessor, allBindingsAccessor\n\t\t\treturn\n\n\t\ttextInput.on events\n\n\t\tpickerElement.on 'click', (e) ->\n\t\t\troot = jQuery(picker.$root[0])\n\t\t\t# This seems to be only method\n\t\t\t# to discover if picker is really open\n\t\t\tisOpen = jQuery(root.children()[0]).height() > 0\n\t\t\tif isOpen\n\t\t\t\tpicker.close()\n\t\t\telse\n\t\t\t\tpicker.open(false)\n\t\t\te.stopPropagation()\n\t\t\te.preventDefault()\n\t\t\treturn\n\n\t\treturn\n\n\tupdate: (element, valueAccessor) =>\n\t\tko.utils.setTextContent(element, valueAccessor())\n\t\tvalue = @getDisplayValue(@getValue(valueAccessor))\n\t\tif element.value isnt value\n\t\t\telement.value = value\n#\n# Placeholder binding handler\n#\nclass @Maslosoft.Binder.Placeholder extends @Maslosoft.Binder.Base\n\n\tinit: (element) =>\n\t\tensureAttribute element, 'placeholder'\n\n\tupdate: (element, valueAccessor) =>\n\n\t\tplaceholder = @getValue(valueAccessor)\n\n\t\tif element.getAttribute('placeholder') isnt placeholder\n\t\t\t# Clean up HTML\n\t\t\tplaceholder = $(\"<div/>\").html(placeholder).text()\n\t\t\telement.setAttribute 'placeholder', placeholder\n\n###\nSelect2\n###\nclass @Maslosoft.Binder.Select2 extends @Maslosoft.Binder.Base\n\n\tbindingName = 'select2'\n\tdataBindingName = \"#{bindingName}Data\"\n\n\ttriggerChangeQuietly = (element, binding) ->\n\t\tisObservable = ko.isObservable(binding)\n\t\toriginalEqualityComparer = undefined\n\t\tif isObservable\n\t\t\toriginalEqualityComparer = binding.equalityComparer\n\n\t\t\tbinding.equalityComparer = ->\n\t\t\t\ttrue\n\n\t\t$(element).trigger 'change'\n\t\tif isObservable\n\t\t\tbinding.equalityComparer = originalEqualityComparer\n\t\treturn\n\n\tinit = (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) ->\n\t\tbindingValue = ko.unwrap(valueAccessor())\n\t\tallBindings = allBindingsAccessor()\n\t\tignoreChange = false\n\t\tdataChangeHandler = null\n\t\tsubscription = null\n\t\t$(element).on 'select2:selecting select2:unselecting', ->\n\t\t\tignoreChange = true\n\t\t\treturn\n\t\t$(element).on 'select2:select select2:unselect', ->\n\t\t\tignoreChange = false\n\t\t\treturn\n\t\tif ko.isObservable(allBindings.value)\n\t\t\tsubscription = allBindings.value.subscribe((value) ->\n\t\t\t\tif ignoreChange\n\t\t\t\t\treturn\n\t\t\t\ttriggerChangeQuietly element, @_target or @target\n\t\t\t\treturn\n\t\t\t)\n\t\telse if ko.isObservable(allBindings.selectedOptions)\n\t\t\tsubscription = allBindings.selectedOptions.subscribe((value) ->\n\t\t\t\tif ignoreChange\n\t\t\t\t\treturn\n\t\t\t\ttriggerChangeQuietly element, @_target or @target\n\t\t\t\treturn\n\t\t\t)\n\t\t# Provide a hook for binding to the select2 \"data\" property; this property is read-only in select2 so not subscribing.\n\t\tif ko.isWriteableObservable(allBindings[dataBindingName])\n\n\t\t\tdataChangeHandler = ->\n\t\t\t\tif !$(element).data('select2')\n\t\t\t\t\treturn\n\t\t\t\tallBindings[dataBindingName] $(element).select2('data')\n\t\t\t\treturn\n\n\t\t\t$(element).on 'change', dataChangeHandler\n\t\t# Apply select2\n\t\t$(element).select2 bindingValue\n\n\t\tif allBindings.selectedOptions\n\t\t\t$(element).val(allBindings.selectedOptions).trigger('change')\n\n\t\t# Destroy select2 on element disposal\n\t\tko.utils.domNodeDisposal.addDisposeCallback element, ->\n\t\t\t$(element).select2 'destroy'\n\t\t\tif dataChangeHandler != null\n\t\t\t\t$(element).off 'change', dataChangeHandler\n\t\t\tif subscription != null\n\t\t\t\tsubscription.dispose()\n\t\t\treturn\n\t\treturn\n\n\tinit: () =>\n\t\targs = arguments\n\t\tto = () ->\n\t\t\tinit.apply null, args\n\t\tsetTimeout to, 0\n\n\tupdate: (element, valueAccessor, allBindingsAccessor) =>\n\t\treturn\n\t\tvalue = @getValue(valueAccessor)\n\t\tif element.value isnt value.data\n\t\t\tcopy = JSON.parse JSON.stringify value.data\n\t\t\t$(element).val(copy);\n\t\t\tconsole.log \"Update what?\", element, value\n#\n# Selected binding\n# This adds class from options if value is true\n#\nclass @Maslosoft.Binder.Selected extends@Maslosoft.Binder.CssClass\n\n\tconstructor: (options) ->\n\t\tsuper new Maslosoft.Binder.CssOptions({className: 'selected'})\n\n#\n# Src binding handler\n#\nclass @Maslosoft.Binder.Src extends @Maslosoft.Binder.Base\n\n\tinit: (element) =>\n\t\tensureAttribute(element, 'src')\n\n\tupdate: (element, valueAccessor) =>\n\t\tsrc = @getValue(valueAccessor)\n\t\tif element.getAttribute('src') isnt src\n\t\t\telement.setAttribute('src', src)\n###\nSelect2\n###\nclass @Maslosoft.Binder.Tags extends @Maslosoft.Binder.Base\n\n\tdropdownKillStyles = '''\n<style>\n\tbody.kill-all-select2-dropdowns .select2-dropdown {\n\t\tdisplay: none !important;\n\t}\n\tbody.kill-all-select2-dropdowns .select2-container--default.select2-container--open.select2-container--below .select2-selection--single, .select2-container--default.select2-container--open.select2-container--below .select2-selection--multiple\n\t{\n\t\tborder-bottom-left-radius: 4px;\n\t\tborder-bottom-right-radius: 4px;\n\t}\n\t.select2-container--default.select2-container--focus .select2-selection--multiple {\n\t\tborder-color: #66afe9;\n\t\toutline: 0;\n\t\t-webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102,175,233,.6);\n\t\tbox-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102,175,233,.6);\n\t}\n</style>\n'''\n\n\tonce = true\n\n\tsetTags: (el, tags) =>\n\n\t\toptions = el.find('option')\n\t\tif options.length\n\t\t\toptions.remove()\n#\t\tfor option, index in el.find('option')\n\n\t\t# Add options, all as selected - as these are our tags list\n\t\tfor tag, index in tags\n\t\t\t\topt = jQuery \"<option selected='true'></option>\"\n\t\t\t\topt.val(tag)\n\t\t\t\topt.text(tag)\n\t\t\t\tel.append opt\n\n\tinit: (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) =>\n\n\t\tif element.tagName.toLowerCase() isnt 'select'\n\t\t\tthrow new Error \"Tags binding must be placed on `select` element\"\n\n\t\tif once\n\n\t\t\tjQuery(dropdownKillStyles).appendTo 'head'\n\t\t\tonce = false\n\n\t\tdata = @getValue valueAccessor\n\n\t\tif data.data\n\t\t\tvalue = data.data\n\t\telse\n\t\t\t# Assume direct data passing\n\t\t\tvalue = data\n\n\t\tcopy = JSON.parse JSON.stringify value\n\n\t\tel = jQuery element\n\t\tel.data 'tags', true\n\t\tel.attr 'multiple', true\n\t\t\n\t\t@setTags el, copy\n\t\t\n\t\tconfig = {\n\t\t\t\tplaceholder: data.placeholder\n\t\t\t\ttags: true\n\t\t\t\ttokenSeparators: [',', ' ']\n\t\t\t}\n\n\t\tupdateCSS = () ->\n\t\t\tif data.inputCss\n\t\t\t\tinput = el.parent().find('.select2-search__field')\n\t\t\t\tinput.addClass(data.inputCss);\n\t\t\t\tinput.attr 'placeholder', data.placeholder\n\n\t\tif data.tagCss\n\t\t\tconfig.templateSelection = (selection, element) ->\n\t\t\t\telement.removeClass 'select2-selection__choice'\n\t\t\t\telement.addClass data.tagCss\n\t\t\t\tif selection.selected\n\t\t\t\t\treturn jQuery \"<span>#{selection.text}</span>\"\n\t\t\t\telse\n\t\t\t\t\treturn jQuery \"<span>#{selection.text}</span>\"\n\n\n\t\thandler = =>\n\t\t\tif value.removeAll\n\t\t\t\tvalue.removeAll()\n\t\t\telse\n\t\t\t\tvalue = []\n\n\t\t\telementValue = el.val()\n\t\t\tif elementValue\n\t\t\t\tfor tag, index in elementValue\n\t\t\t\t\t# Sometimes some comas and spaces might pop in\n\t\t\t\t\ttag = tag.replace(',', '').replace(' ', '').trim()\n\n\t\t\t\t\tif not tag then continue\n\t\t\t\t\tvalue.push tag\n\t\t\tupdateCSS()\n\n\n\t\t# This prevents dropdown for tags\n\t\tdropDownKill = (e) =>\n\t\t\thaveTags = jQuery(e.target).data();\n\t\t\tif haveTags\n\t\t\t\tjQuery('body').toggleClass 'kill-all-select2-dropdowns', e.type == 'select2:opening'\n\n\t\tbuild = =>\n\n\t\t\t# Apply select2\n\t\t\tel.select2 config\n\n\t\t\tupdateCSS()\n\n\t\t\tel.on 'change', handler\n\t\t\tel.on 'select2:select select2:unselect', handler\n\t\t\tel.on 'select2:opening select2:close', dropDownKill\n\n\t\t\t# Destroy select2 on element disposal\n\t\t\tko.utils.domNodeDisposal.addDisposeCallback element, =>\n\t\t\t\tel.select2 'destroy'\n\t\t\t\tif handler isnt null\n\t\t\t\t\tel.off 'change', handler\n\t\t\t\t\tel.off 'select2:select select2:unselect', handler\n\n\t\tsetTimeout build, 0\n\n\tupdate: (element, valueAccessor, allBindingsAccessor) =>\n\t\tdata = @getValue(valueAccessor)\n\n\t\tif data.data\n\t\t\tvalue = data.data\n\t\telse\n\t\t\t# Assume direct data passing\n\t\t\tvalue = data\n\n\t\tcopy = JSON.parse JSON.stringify value\n\n\t\tel = jQuery element\n\n\t\tmaybeSet = =>\n\n\t\t\t# Not a best moment to update\n\t\t\tif el.val() is null\n\t\t\t\telementTags = ''\n\t\t\telse\n\t\t\t\telementTags = el.val().join(',').replace(/(,+)/g, ',').replace(/(\\s+)/g, ' ')\n\t\t\tmodelTags = value.join(',')\n\n\t\t\tif elementTags isnt modelTags\n\t\t\t\t@setTags el, copy\n\n\n\t\tsetTimeout maybeSet, 0\n#\n# HTML improved binding handler\n#\nclass @Maslosoft.Binder.Text extends @Maslosoft.Binder.Base\n\n\tinit: (element, valueAccessor, allBindingsAccessor, context) ->\n\t\treturn { 'controlsDescendantBindings': true }\n\n\tupdate: (element, valueAccessor, allBindings, context) =>\n\t\t# setHtml will unwrap the value if needed\n\t\tvalue = escapeHtml @getValue(valueAccessor)\n\n\t\tconfiguration = @getValue(allBindings).plugins\n\n\t\tpm = new PluginsManager(element)\n\n\t\tpm.from configuration\n\n\t\tvalue = pm.getElementValue element, value\n\n\t\tko.utils.setHtml(element, value)\n\nclass @Maslosoft.Binder.TextToBg extends @Maslosoft.Binder.Base\n\n\tinit: (element, valueAccessor, allBindingsAccessor, context) ->\n\n\n\tupdate: (element, valueAccessor, allBindings, context) =>\n\n\t\tvalue = @getValue(valueAccessor)\n\t\tjQuery(element).css 'background-color', stringToColour(value)\n\n\n#\n# Html text value binding\n# WARNING This MUST have parent context, or will not work\n#\nclass @Maslosoft.Binder.TextValue extends @Maslosoft.Binder.HtmlValue\n\n\tgetElementValue: (element) ->\n\t\treturn element.textContent || element.innerText || \"\"\n\n\tsetElementValue: (element, value) ->\n\t\tif typeof element.textContent isnt 'undefined'\n\t\t\telement.textContent = value\n\t\tif typeof element.innerText isnt 'undefined'\n\t\t\telement.innerText = value\n\n#\n# Html text value binding\n# WARNING This MUST have parent context, or will not work\n#\nclass @Maslosoft.Binder.TextValueHLJS extends @Maslosoft.Binder.HtmlValue\n\n\tgetElementValue: (element) ->\n\t\treturn element.textContent || element.innerText || \"\"\n\n\tsetElementValue: (element, value) ->\n\t\tif typeof element.textContent isnt 'undefined'\n\t\t\telement.textContent = value\n\t\t\tif hljs\n\t\t\t\thljs.highlightBlock(element)\n\t\tif typeof element.innerText isnt 'undefined'\n\t\t\telement.innerText = value\n\t\t\tif hljs\n\t\t\t\thljs.highlightBlock(element)\n\n\nclass @Maslosoft.Binder.TimeAgoFormatter extends @Maslosoft.Binder.MomentFormatter\n\n\tconstructor: (options) ->\n\t\tsuper new Maslosoft.Binder.TimeAgoOptions(options)\n\n\tupdate: (element, valueAccessor) =>\n\t\tvalue = @getValue(valueAccessor)\n\t\telement.innerHTML = moment[@options.sourceFormat](value).fromNow()\n\t\treturn\n\n#\n# Date formatter\n#\nclass @Maslosoft.Binder.TimeFormatter extends @Maslosoft.Binder.MomentFormatter\n\n\tconstructor: (options) ->\n\t\tsuper new Maslosoft.Binder.TimeOptions(options)\n\n###\nTime picker\n###\nclass @Maslosoft.Binder.TimePicker extends @Maslosoft.Binder.Base\n\n\t\n\n\n#\n# Tooltip binding handler\n#\nclass @Maslosoft.Binder.Tooltip extends @Maslosoft.Binder.Base\n\n\tupdate: (element, valueAccessor) =>\n\t\ttitle = @getValue(valueAccessor)\n\t\t$(element).attr \"title\", title\n\t\t$(element).attr \"data-original-title\", title\n\t\t$(element).attr \"rel\", \"tooltip\"\n\t\treturn\n\n#\n# Tree binding handler\n#\nclass @Maslosoft.Binder.Tree extends @Maslosoft.Binder.Base\n\n\tupdate: (element, valueAccessor) =>\n\t\t\n\t\treturn\n\n\n\nclass @Maslosoft.Binder.TreeGrid extends @Maslosoft.Binder.Base\n\n\t#\n\t#\n\t# @private\n\t#\n\tmakeValueAccessor = (element, valueAccessor, bindingContext, widget) ->\n\t\treturn () ->\n\t\t\tmodelValue = valueAccessor()\n\t\t\tunwrappedValue = ko.utils.peekObservable(modelValue)\n\t\t\t# Unwrap without setting a dependency here\n\t\t\t# If unwrappedValue is the array, pass in the wrapped value on its own\n\t\t\t# The value will be unwrapped and tracked within the template binding\n\t\t\t# (See https://github.com/SteveSanderson/knockout/issues/523)\n\t\t\tif !unwrappedValue or typeof unwrappedValue.length == 'number'\n\t\t\t\treturn {\n\t\t\t\t\t'foreach': modelValue\n\t\t\t\t\t'templateEngine': ko.nativeTemplateEngine.instance\n\t\t\t\t}\n\n\t\t\tdata = ko.observableArray []\n\t\t\tdepths = ko.observableArray []\n\t\t\tdepth = -1\n\n\t\t\tunwrapRecursive = (items) ->\n\t\t\t\tdepth++\n\t\t\t\tfor item in items\n\t\t\t\t\thasChilds = item.children and item.children.length and item.children.length > 0\n\t\t\t\t\textras = {\n\t\t\t\t\t\tdepth: depth\n\t\t\t\t\t\thasChilds: hasChilds\n\t\t\t\t\t}\n\t\t\t\t\titem._treeGrid = ko.tracker.factory extras\n\t\t\t\t\tdata.push item\n\t\t\t\t\tdepths.push depth\n\t\t\t\t\tif hasChilds\n\t\t\t\t\t\tunwrapRecursive item.children\n\t\t\t\t\t\tdepth--\n\n#\t\t\tlog unwrappedValue['data']\n\t\t\tif unwrappedValue['data']['children']\n#\t\t\t\tlog('model init')\n\t\t\t\tunwrapRecursive unwrappedValue['data']['children']\n\t\t\telse\n#\t\t\t\tlog('array init')\n\t\t\t\tunwrapRecursive unwrappedValue['data']\n\t\t\t\n\t\t\tif bindingContext\n\t\t\t\tbindingContext.tree = unwrappedValue['data']\n\t\t\t\tbindingContext.data = data\n\t\t\t\tbindingContext.widget = widget\n\n\t\t\t# If unwrappedValue.data is the array, preserve all relevant options and unwrap again value so we get updates\n\t\t\tko.utils.unwrapObservable modelValue\n\t\t\t{\n\t\t\t\t'foreach': data\n\t\t\t\t'depths': depths\n\t\t\t\t'as': unwrappedValue['as']\n\t\t\t\t'includeDestroyed': unwrappedValue['includeDestroyed']\n\t\t\t\t'afterAdd': unwrappedValue['afterAdd']\n\t\t\t\t'beforeRemove': unwrappedValue['beforeRemove']\n\t\t\t\t'afterRender': unwrappedValue['afterRender']\n\t\t\t\t'beforeMove': unwrappedValue['beforeMove']\n\t\t\t\t'afterMove': unwrappedValue['afterMove']\n\t\t\t\t'templateEngine': ko.nativeTemplateEngine.instance\n\t\t\t}\n\n\tinit: (element, valueAccessor, allBindings, viewModel, bindingContext) =>\n\n\t\tvalue = @getValue valueAccessor\n\t\tactiveClass = value.activeClass\n\n\t\ttable = jQuery(element)\n\n\t\twidget = new Maslosoft.Binder.Widgets.TreeGrid.TreeGridView element, valueAccessor\n\t\twidget.init()\n\n\t\tif activeClass\n\t\t\tactiveClassHandler = (e) ->\n\t\t\t\t# Remove from all instances of `tr` tu support multiple\n\t\t\t\t# classes separated with space\n\t\t\t\ttable.find('tr').removeClass activeClass\n\t\t\t\tjQuery(e.currentTarget).addClass activeClass\n\t\t\t\treturn true\n\t\t\ttable.on 'click', 'tr', activeClassHandler\n\n\t\t\tdispose = (toDispose) ->\n\t\t\t\twidget.dispose()\n\t\t\t\tjQuery(toDispose).off \"click\", 'tr', activeClassHandler\n\n\t\t\tko.utils.domNodeDisposal.addDisposeCallback element, dispose\n\n\t\tko.bindingHandlers['template']['init'](element, makeValueAccessor(element, valueAccessor, bindingContext, widget), allBindings, viewModel, bindingContext);\n\t\treturn { controlsDescendantBindings: true }\n\n\tupdate: (element, valueAccessor, allBindings, viewModel, bindingContext) =>\n\t\twidget = new Maslosoft.Binder.Widgets.TreeGrid.TreeGridView element, valueAccessor, 'update'\n\n\t\treturn ko.bindingHandlers['template']['update'](element, makeValueAccessor(element, valueAccessor, bindingContext, widget), allBindings, viewModel, bindingContext);\n\n\n\n#\n# This is to create \"nodes\" cell, this is meant to be used with TreeGrid\n# binding handler\n#\n#\n#\nclass @Maslosoft.Binder.TreeGridNode extends @Maslosoft.Binder.Base\n\n\tinit: (element, valueAccessor, allBindings, viewModel, bindingContext) =>\n\n\tupdate: (element, valueAccessor, allBindings, viewModel, bindingContext) =>\n\t\tko.utils.toggleDomNodeCssClass(element, 'tree-grid-drag-handle', true);\n\n\t\t#\n\t\t# Defer icon creation, as other bindings must be evaluated first,\n\t\t# like html, text, etc.\n\t\thtml = []\n\t\tdata = @getValue(valueAccessor)\n\t\textras = data._treeGrid\n\t\tconfig = bindingContext.widget.config\n\t\t#console.log extras.hasChilds\n\t\t# TODO: Just accessing data.children causes havoc...\n\t\tnodeIcon = config.nodeIcon\n\t\tfolderIcon = config.folderIcon\n\n\t\texpanderIcon = config.expanderIcon or \"<i class='glyphicon glyphicon-triangle-bottom'></i>\"\n\t\tif folderIcon and extras.hasChilds\n#\t\t\t\tconsole.log 'hmmm'\n\t\t\tnodeIcon = folderIcon\n#\t\t\tconsole.log \"#{data.title}: #{extras.depth}\", extras.hasChilds\n#\t\t\tconsole.log data\n#\t\t\tconsole.log ko.unwrap bindingContext.$index\n\t\tdepth = extras.depth\n\t\texpanders = []\n\t\texpanders.push \"<div class='collapsed' style='display:none;transform: rotate(-90deg);'>#{expanderIcon}</div>\"\n\t\texpanders.push \"<div class='expanded' style='display:none;transform: rotate(-45deg);'>#{expanderIcon}</div>\"\n\t\thtml.push \"<a class='expander' style='cursor:pointer;text-decoration:none;width:1em;margin-left:#{depth}em;display:inline-block;'>#{expanders.join('')}</a>\"\n\t\tdepth = extras.depth + 1\n\t\thtml.push \"<i class='no-expander' style='margin-left:#{depth}em;display:inline-block;'></i>\"\n\t\thtml.push \"<img src='#{nodeIcon}' style='width: 1em;height:1em;margin-top: -.3em;display: inline-block;'/>\"\n\t\telement.innerHTML = html.join('') + element.innerHTML\n\n\n\n#\n#\n# Validation binding handler\n#\n# @see ValidationManager\n#\nclass @Maslosoft.Binder.Validator extends @Maslosoft.Binder.Base\n\n\t# Counter for id generator\n\t# @static\n\tidCounter = 0\n\n\tconstructor: (options) ->\n\t\tsuper new Maslosoft.Binder.ValidatorOptions()\n\n\tgetElementValue: (element) ->\n\t\t# For inputs use value\n\t\tif element.tagName.toLowerCase() is 'input'\n\t\t\treturn element.value\n\n\t\t# For textarea use value\n\t\tif element.tagName.toLowerCase() is 'textarea'\n\t\t\treturn element.value\n\n\t\t# For rest use text value\n\t\treturn element.textContent || element.innerText || \"\"\n\n\tinit: (element, valueAccessor, allBindingsAccessor, context) =>\n\t\tconfiguration = @getValue(valueAccessor)\n\t\tclassField = @options.classField\n\n\t\tpm = new PluginsManager element, classField\n\n\t\tvalidators = pm.from configuration\n\n\n#   TODO Maybe below code should be used to check if class is validator compatible\n#\t\tproto = config[classField].prototype\n#\n#\t\tif typeof(proto.isValid) isnt 'function' or typeof(proto.getErrors) isnt 'function' or typeof(proto.reset) isnt 'function'\n#\t\t\tif typeof(config[classField].prototype.constructor) is 'function'\n#\t\t\t\tname = config[classField].prototype.constructor.name\n#\t\t\telse\n#\t\t\t\tname = config[classField].toString()\n#\n#\t\t\terror \"Parameter `#{classField}` (of type #{name}) must be validator compatible class, binding defined on element:\", element\n#\t\t\tcontinue\n\n\n\t\tmanager = new ValidationManager(validators, @options)\n\t\tmanager.init element\n\n\t\t# Generate some id if not set, see notes below why\n\t\tif not element.id\n\t\t\telement.id = \"Maslosoft-Ko-Binder-Validator-#{idCounter++}\"\n\n\t\t# Get initial value to evaluate only if changed\n\t\tinitialVal = @getElementValue(element)\n\n\t\thandler = (e) =>\n\t\t\t# On some situations element might be null (sorting), ignore this case\n\t\t\tif not element then return\n\n\t\t\t# This is required in some scenarios, specifically when sorting htmlValue elements\n\t\t\telement = document.getElementById(element.id)\n\t\t\tif not element then return\n\n\t\t\telementValue = @getElementValue(element)\n\t\t\t\n\t\t\t# Validate only if changed\n\t\t\tif initialVal isnt elementValue\n\t\t\t\tinitialVal = elementValue\n\t\t\t\tmanager.validate element, elementValue\n\n\t\t# NOTE: Event must be bound to parent node to work if parent has contenteditable enabled\n\t\tko.utils.registerEventHandler element, \"keyup, input\", handler\n\n\t\t# This is to allow interaction with tools which could modify content,\n\t\t# also to work with drag and drop\n\t\tko.utils.registerEventHandler document, \"mouseup\", handler\n\n\n\tupdate: (element, valueAccessor, allBindings) =>\n\t\t# NOTE: Will not trigger on value change, as it is not directly observing value.\n\t\t# Will trigger only on init\n\n#\n# Video PLaylist binding handler\n#\nclass @Maslosoft.Binder.VideoPlaylist extends @Maslosoft.Binder.Video\n\tinitVideos: null\n\tgetData: (valueAccessor) ->\n\t\t# Verbose syntax, at least {data: data}\n\t\tvalue = @getValue(valueAccessor) or []\n\t\tif value.data\n\t\t\treturn value.data\n\t\treturn value\n\n\tinit: (element, valueAccessor, allBindingsAccessor, context) =>\n\n\n\tupdate: (element, valueAccessor, allBindingsAccessor, viewModel) =>\n\t\tdata = @getData valueAccessor\n\t\toptions = @getValue valueAccessor or {}\n\t\turlField = options.urlField or 'url'\n\t\ttitleField = options.urlField or 'title'\n\n\t\thtml = []\n\t\tfor video in data\n\t\t\turl = video[urlField]\n\t\t\ttitle = video[titleField]\n\t\t\tif @isVideoUrl url\n\t\t\t\thtml.push \"<a href='#{url}'>#{title}</a>\"\n\n\t\telement.innerHTML = html.join \"\\n\"\n\t\tif html.length\n\t\t\tko.utils.toggleDomNodeCssClass(element, 'maslosoft-playlist', true);\n\t\t\tnew Maslosoft.Playlist element\n\t\telse\n\t\t\tko.utils.toggleDomNodeCssClass(element, 'maslosoft-playlist', false);\n\n#\n# Video Playlist binding handler\n#\nclass @Maslosoft.Binder.VideoThumb extends @Maslosoft.Binder.Video\n\n\tinit: (element, valueAccessor, allBindingsAccessor, context) =>\n\t\t\n\tupdate: (element, valueAccessor) =>\n\t\turl = @getValue(valueAccessor)\n\n\t\t@setThumb url, element\n\n\t\t\t\t\n\n\t\t\n\nclass @Maslosoft.Binder.Widget extends @Maslosoft.Binder.Base\n\t\n\tinit: (element, valueAccessor, allBindings, context) =>\n\t\t\n\t\tclassName = @getValue valueAccessor\n\n\t\tref = allBindings.get 'ref'\n\n\t\t# Ref is string, try to create new widget and set ref\n\t\tif typeof(ref) is 'string' or not ref\n\n\t\t\tif typeof(className) isnt 'function' then return\n\n\t\t\tif typeof(className.constructor) isnt 'function' then return\n\n\t\t\ttry\n\t\t\t\twidget = new className\n\t\t\tcatch Error\n\t\t\t\treturn\n\t\t\tif ref\n\t\t\t\tsetRefByName ref, widget\n\n\n\t\t\tif ref\n\t\t\t\tref = widget\n\t\telse\n#\t\t\tconsole.log 'By ref...'\n#\t\t\tconsole.log ref, typeof(ref)\n\t\t\tif typeof(ref) is 'object'\n#\t\t\t\tconsole.log 'Assign ref...'\n\t\t\t\twidget = ref\n\n\t\tparams = allBindings.get 'params'\n\t\t\n\t\tif params\n\t\t\tfor name, value of params\n\t\t\t\twidget[name] = value\n\n\t\tif typeof(widget.init) is 'function'\n\t\t\twidget.init(element)\n\t\t\n\t\tif typeof(widget.dispose) is 'function'\n\t\t\tko.utils.domNodeDisposal.addDisposeCallback element, widget.dispose\n\t\t\n\tupdate: (element, valueAccessor) =>\n\nclass @Maslosoft.Binder.WidgetAction extends @Maslosoft.Binder.WidgetUrl\n\n\tupdate: (element, valueAccessor, allBindings) =>\n\n\t\tdata = @getData(element, valueAccessor, allBindings, 'action')\n\t\thref = @createUrl(data.id, data.action, data.params, '?')\n\n\t\telement.setAttribute('href', href)\n\t\t\n\t\t@setRel element\n\n\nclass @Maslosoft.Binder.WidgetActivity extends @Maslosoft.Binder.WidgetUrl\n\n\tupdate: (element, valueAccessor, allBindings) =>\n\t\t\n\t\tdata = @getData(element, valueAccessor, allBindings, 'activity')\n\t\thref = @createUrl(data.id, data.activity, data.params, '#')\n\n\t\telement.setAttribute('href', href)\n\n\t\t@setRel element\n\t\t\t\n\n\nclass PluginsManager\n\n\tclassField: '_class'\n\n\telement: null\n\n\t#\n\t#\n\t# @var object[]\n\t#\n\tplugins: null\n\n\tconstructor: (@element = null, @classField = '_class') ->\n\t\t@plugins = new Array\n\n\t#\n\t# Create configured instances out of configuration\n\t# containing _class and optional params\n\t#\n\t# Example configuration for one plugin:\n\t# ```\n\t# {\n\t# \t_class: Maslosoft.BinderDev.RegExpValidator,\n\t# \tpattern: '^[a-z]+$',\n\t# \tallowEmpty: false\n\t# }\n\t# ```\n\t#\n\t# Example configuration for many plugins:\n\t# ```\n\t# [\n\t# \t{\n\t# \t\t_class: Maslosoft.BinderDev.EmailValidator,\n\t# \t\tlabel: 'E-mail'\n\t# \t},\n\t# \t{\n\t# \t\t_class: Maslosoft.BinderDev.RequiredValidator,\n\t# \t\tlabel: 'E-mail'\n\t# \t}\n\t# ]\n\t# ```\n\t#\n\t# @param object\n\t# @return object[]\n\t#\n\tfrom: (configuration) ->\n\n\t\telement = @element\n\t\tclassField = @classField\n\t\t@plugins = new Array\n\n\t\tif ko.isObservable configuration\n\t\t\tconfiguration = ko.unwrap configuration\n\n\t\tif not configuration\n\t\t\treturn @plugins\n\n\t\tif configuration.constructor is Array\n\t\t\tcfg = configuration\n\t\telse\n\t\t\tcfg = [configuration]\n\n#\t\tconsole.log cfg\n\t\tfor config in cfg\n\n\t\t\tif not config[classField]\n\t\t\t\terror \"Parameter `#{classField}` must be defined for plugin on element:\", element\n\t\t\t\tcontinue\n\n\t\t\tif typeof(config[classField]) isnt 'function'\n\t\t\t\terror \"Parameter `#{classField}` must be plugin compatible class, binding defined on element:\", element\n\t\t\t\tcontinue\n\n\t\t\t# Store class name first, as it needs to be removed\n\t\t\tclassName = config[classField]\n\n\t\t\t# Remove class key, to not interrupt plugin configuration\n\t\t\tdelete(config[classField])\n\n\t\t\t# Instantiate plugin\n\t\t\tplugin = new className\n\t\t\tfor index, value of config\n\t\t\t\tplugin[index] = null\n\t\t\t\tplugin[index] = value\n\n\t\t\t@plugins.push plugin\n\n\t\t\treturn @plugins\n\n\tgetElementValue: (element, value) =>\n\n\t\tfor plugin in @plugins\n\t\t\tif typeof(plugin.getElementValue) is 'function'\n\t\t\t\tvalue = plugin.getElementValue element, value\n\t\treturn value\n\n\tgetModelValue: (element, value) =>\n\n\t\tfor plugin in @plugins\n\t\t\tif typeof(plugin.getModelValue) is 'function'\n\t\t\t\tvalue = plugin.getModelValue element, value\n\t\treturn value\nclass TreeDnd\n\n\t# Expand helps greatly when doing dnd\n\tautoExpandMS: 400\n\n\t# Prevent focus on click\n\t# When enabled will scroll to tree control on click, not really desirable\n\t# Cons: breaks keyboard navigation\n\tfocusOnClick: false\n\n\t# These two are required, or view model might loop\t\n\tpreventVoidMoves: true\n\tpreventRecursiveMoves: true\n\n\t#\n\t# Whole tree data\n\t# @var TreeItem[]\n\t#\n\ttree: null\n\t#\n\t# Node finder instance\n\t# @var TreeNodeFinder\n\t#\n\tfinder: null\n\n\t#\n\t# Draggable options\n\t#\n\t#\n\tdraggable: null\n\n\t#\n\t#\n\t# @var TreeEvents\n\t#\n\tevents: null\n\n\t#\n\t# Tree html element\n\t#\n\t#\n\t@el = null\n\n\t# Private\n\n\tt = (node) ->\n\t\treturn # Comment to log\n\t\tlog \"Node: #{node.title}\"\n\t\tchildren = []\n\t\tif node.children and node.children.length > 0\n\t\t\tfor childNode in node.children\n\t\t\t\tchildren.push childNode.title\n\t\t\tlog \"Children: #{children.join(',')}\"\n\n\tconstructor: (initialTree, element, @events, options) ->\n\t\t@draggable = {}\n\t\t@draggable.scroll = false\n\t\t\n\t\t@tree = {}\n\t\t@tree = initialTree\n\t\t@finder = new TreeNodeFinder @tree\n\t\t@el = jQuery element\n\n\tdragStart: (node, data) ->\n\t\treturn true\n\n\tdragEnter: (node, data) ->\n\t\treturn true\n\n\tdragEnd: (node, data) =>\n\t\tlog 'drag end...'\n\t\treturn true\n\n\tdragDrop: (node, data) =>\n\n\t\thitMode = data.hitMode\n\n\t\t# Dragged element - either draggable or tree element\n\t\tdragged = data.draggable.element[0]\n\n\t\t# Event handler for drop\n\t\t@events.drop node, data\n\n\t\tif not data.otherNode\n\t\t\t# Drop from ourside tree\n\t\t\tctx = ko.contextFor dragged\n\n\t\t\t# Handle drop event possible transformation of node\n\t\t\tcurrent = @events.getNode(ctx.$data)\n\n\t\telse\n\t\t\t# From from within tree\n\t\t\tparent = @finder.find(data.otherNode.parent.data.id)\n\n\t\t\t# Find node\n\t\t\t# Handle drop event possible transformation of node\n\t\t\tcurrent = @events.getNode(@finder.find(data.otherNode.data.id))\n\n\t\t\tif not @el.is dragged\n\t\t\t\tlog 'From other instance...'\n\t\t\t\t# Drop from other tree instance\n\t\t\t\tdata = ko.dataFor dragged\n\t\t\t\tlog data\n\t\t\t\tsetTimeout handler, 0\n\n\t\ttarget = @finder.find(node.data.id)\n\t\ttargetParent = @finder.find(node.parent.data.id)\n\n\n\t\t# console.log \"Parent: #{parent.title}\"\n\t\t# console.log \"Current: #{current.title}\"\n\t\t# console.log \"Target: #{target.title}\"\n\t\t# console.log \"TargetParent: #{targetParent.title}\"\n\t\t# console.log hitMode\n\n\n\t\t# Update view model\n\t\t# Remove current element first\n\t\tif parent\n\t\t\tparent.children.remove current\n\t\t@tree.children.remove current\n\n\t\tif targetParent\n\t\t\ttargetParent.children.remove current\n\n\t\t# Just push at target end\n\t\tif hitMode is 'over'\n\t\t\t# log hitMode\n\t\t\t# log \"Target: #{target.title}\"\n\t\t\t# log \"Current: #{current.title}\"\n\t\t\ttarget.children.push current\n\n\t\t# Insert before target - at target parent\n\t\tif hitMode is 'before'\n\t\t\tif targetParent\n\t\t\t\t# Move over some node\n\t\t\t\tindex = targetParent.children.indexOf target\n\t\t\t\ttargetParent.children.splice index, 0, current\n\t\t\telse\n\t\t\t\t# Move over root node\n\t\t\t\tindex = @tree.children.indexOf target\n\t\t\t\t@tree.children.splice index, 0, current\n\t\t\t# console.log \"indexOf: #{index} (before)\"\n\n\t\t# Simply push at the end - but at targetParent\n\t\tif hitMode is 'after'\n\t\t\tif targetParent\n\t\t\t\ttargetParent.children.push current\n\t\t\telse\n\t\t\t\t@tree.children.push current\n\n\t\t# NOTE: This could possibly work, but it doesn't.\n\t\t# This would update whole tree with new data. Some infinite recursion occurs.\n\t\t# @handle element, valueAccessor, allBindingsAccessor\n\n\t\thandler = (e) =>\n\t\t\tlog e\n\t\t\t@el.fancytree 'option', 'source', @tree.children\n\t\t\t@el.fancytree('getRootNode').visit (node) ->\n\t\t\t\tnode.setExpanded true\n\t\t\t@el.focus()\n\t\t\tlog 'update tree..', @el\n\n\t\tsetTimeout handler, 0\n\t\t# Move fancytree node separatelly\n\t\t# data.otherNode.moveTo(node, hitMode)\n\n\t\t\t# Expand node as it looks better if it is expanded after drop\n\n\t\treturn true\n\n\nclass TreeDrag\n\n\t# Prevent focus on click\n\t# When enabled will scroll to tree control on click, not really desirable\n\t# Cons: breaks keyboard navigation\n\tfocusOnClick: false\n\n\t#\n\t# Whole tree data\n\t# @var TreeItem[]\n\t#\n\ttree: null\n\t#\n\t# Node finder instance\n\t# @var TreeNodeFinder\n\t#\n\tfinder: null\n\n\t#\n\t# Draggable options\n\t#\n\t#\n\tdraggable: null\n\n\t#\n\t# Tree html element\n\t#\n\t#\n\t@el = null\n\n\t# Private\n\n\tt = (node) ->\n\t\treturn # Comment to log\n\t\tlog \"Node: #{node.title}\"\n\t\tchildren = []\n\t\tif node.children and node.children.length > 0\n\t\t\tfor childNode in node.children\n\t\t\t\tchildren.push childNode.title\n\t\t\tlog \"Children: #{children.join(',')}\"\n\n\tconstructor: (initialTree, element, events, options) ->\n\t\t@draggable = {}\n\t\t@draggable.scroll = false\n\n\t\t@tree = {}\n\t\t@tree = initialTree\n\t\t@finder = new TreeNodeFinder @tree\n\t\t@el = jQuery element\n\n\tdragStart: (node, data) ->\n\t\treturn true\n\n\tdragEnter: (node, data) ->\n\t\treturn false\n\n\tdragEnd: (node, data) =>\n\t\tlog 'drag end...'\n\t\treturn true\n\n\tdragDrop: (node, data) =>\n\t\treturn false\n\t\thitMode = data.hitMode\n\n\t\t# Dragged element - either draggable or tree element\n\t\tdragged = data.draggable.element[0]\n\n\t\tif not data.otherNode\n\t\t\t# Drop from ourside tree\n\t\t\tctx = ko.contextFor dragged\n\t\t\tcurrent = ctx.$data\n\t\telse\n\t\t\t# From from within tree\n\t\t\tparent = @finder.find(data.otherNode.parent.data.id)\n\t\t\tcurrent = @finder.find(data.otherNode.data.id)\n\n\t\t\tif not @el.is dragged\n\t\t\t\tlog 'From other instance...'\n\t\t\t\t# Drop from other tree instance\n\t\t\t\tdata = ko.dataFor dragged\n\t\t\t\tlog data\n\t\t\t\tsetTimeout handler, 0\n\n\t\ttarget = @finder.find(node.data.id)\n\t\ttargetParent = @finder.find(node.parent.data.id)\n\n\n\t\t# console.log \"Parent: #{parent.title}\"\n\t\t# console.log \"Current: #{current.title}\"\n\t\t# console.log \"Target: #{target.title}\"\n\t\t# console.log \"TargetParent: #{targetParent.title}\"\n\t\t# console.log hitMode\n\n\n\t\t# Update view model\n\t\t# Remove current element first\n\t\tif parent\n\t\t\tparent.children.remove current\n\t\t@tree.children.remove current\n\n\t\tif targetParent\n\t\t\ttargetParent.children.remove current\n\n\t\t# Just push at target end\n\t\tif hitMode is 'over'\n\t\t\t# log hitMode\n\t\t\t# log \"Target: #{target.title}\"\n\t\t\t# log \"Current: #{current.title}\"\n\t\t\ttarget.children.push current\n\n\t\t# Insert before target - at target parent\n\t\tif hitMode is 'before'\n\t\t\tif targetParent\n\t\t\t\t# Move over some node\n\t\t\t\tindex = targetParent.children.indexOf target\n\t\t\t\ttargetParent.children.splice index, 0, current\n\t\t\telse\n\t\t\t\t# Move over root node\n\t\t\t\tindex = @tree.children.indexOf target\n\t\t\t\t@tree.children.splice index, 0, current\n\t\t\t# console.log \"indexOf: #{index} (before)\"\n\n\t\t# Simply push at the end - but at targetParent\n\t\tif hitMode is 'after'\n\t\t\tif targetParent\n\t\t\t\ttargetParent.children.push current\n\t\t\telse\n\t\t\t\t@tree.children.push current\n\n\t\t# NOTE: This could possibly work, but it doesn't.\n\t\t# This would update whole tree with new data. Some infinite recursion occurs.\n\t\t# @handle element, valueAccessor, allBindingsAccessor\n\n\t\thandler = (e) =>\n\t\t\tlog e\n\t\t\t@el.fancytree 'option', 'source', @tree.children\n\t\t\t@el.fancytree('getRootNode').visit (node) ->\n\t\t\t\tnode.setExpanded true\n\t\t\t@el.focus()\n\t\t\tlog 'update tree..', @el\n\n\t\tsetTimeout handler, 0\n\t\t# Move fancytree node separatelly\n\t\t# data.otherNode.moveTo(node, hitMode)\n\n\t\t\t# Expand node as it looks better if it is expanded after drop\n\n\t\treturn true\n\n\nclass TreeEvents\n\t#\n\t# Events defined by binding\n\t#\n\tevents: null\n\n\t#\n\t# Drop event is handled differently\n\t# \n\t#\n\tdropEvent: null\n\n\t#\n\t# Fancy tree options\n\t#\n\t#\n\toptions: null\n\n\t# Private\n\n\t#\n\t# Finder instance\n\t# @var TreeNodeFinder\n\t#\n\tfinder = null\n\n\t# Check whether should handle event\n\tdoEvent = (data) ->\n\n\t\t# For most events just do event it has no target\n\t\tif typeof(data.targetType) is 'undefined'\n\t\t\treturn true\n\n\t\t# For click and double click react only on title and icon click\n\t\tif data.targetType is 'title'\n\t\t\treturn true\n\t\tif data.targetType is 'icon'\n\t\t\treturn true\n\n\t# Stop event propagation\n\tstop = (event) ->\n\t\tevent.stopPropagation()\n\n\tconstructor: (initialTree, @events, @options) ->\n\t\tfinder = new TreeNodeFinder initialTree\n\n\t\t@handle 'click'\n\t\t@handle 'dblclick'\n\t\t@handle 'activate'\n\t\t@handle 'deactivate'\n\n\t# Drop event\n\tdrop: (node, data) =>\n\t\tlog \"Drop...\"\n\t\tlog @events\n\t\tif @events.drop\n\t\t\t@dropEvent = new @events.drop(node, data)\n\t\t\tlog @dropEvent\n\n\t#\n\t# Handler to possibly recreate/transform node\n\t#\n\t#\n\tgetNode: (node) =>\n\t\tlog \"Tree event drop...\"\n\t\tlog @dropEvent\n\t\tif @dropEvent and @dropEvent.getNode\n\t\t\treturn @dropEvent.getNode node\n\t\telse\n\t\t\treturn node\n\n\thandle: (type) =>\n\t\tif @events[type]\n\t\t\t@options[type] = (event, data) =>\n\t\t\t\tif doEvent data\n\t\t\t\t\tmodel = finder.find data.node.data.id\n\t\t\t\t\t@events[type] model, data, event\n\t\t\t\t\tstop event\n\n\nclass TreeNodeCache\n  nodes = {}\n  constructor: () ->\n    # nodes = {}\n\n  get: (id) ->\n    if typeof(nodes[id]) is 'undefined'\n      return false\n    return nodes[id]\n\n  set: (id, val) ->\n    nodes[id] = val\nclass TreeNodeFinder\n\t# Private\n\tcache = new TreeNodeCache\n\ttrees = []\n\t\n\tconstructor: (initialTree) ->\n\t\ttrees.push initialTree\n\n\tfindNode = (node, id) ->\n\t\tif typeof(id) is 'undefined'\n\t\t\treturn false\n\t\tif found = cache.get id\n\t\t\treturn found\n\t\tif node.id is id\n\t\t\treturn node\n\t\tif  node._id is id\n\t\t\treturn node\n\n\t\tif node.children and node.children.length > 0\n\t\t\tfor child in node.children\n\t\t\t\tfoundNode = findNode(child, id)\n\t\t\t\tif foundNode isnt false\n\t\t\t\t\tcache.set id, foundNode\n\t\t\t\t\treturn foundNode\n\t\treturn false\n\n\tfind: (id) ->\n\t\tfor tree in trees\n\t\t\tnode = findNode tree, id\n\t\t\tif node\n\t\t\t\treturn node\n\t\treturn false\n\t\t\n\nclass TreeNodeRenderer\n\n\ticon: ''\n\t\n\tfolderIcon: ''\n\t\n\trenderer: null\n\t\n\t#\n\t# Node finder instance\n\t# @var TreeNodeFinder\n\t# @private\n\t#\n\tfinder = null\n\n\tconstructor: (tree, options, @icon, @folderIcon) ->\n\t\tfinder = new TreeNodeFinder tree\n\t\t\n\tsetRenderer: (@renderer) ->\n\t\tif typeof(@renderer.render) isnt 'function'\n\t\t\tconsole.error \"Renderer must have function `render`\"\n\t\n\trender: (event, data) =>\n\t\tnode = data.node\n\t\t\n\t\t# Skip event from child nodes\n\t\t# If not skipped, double icons will appear on folder nodes\n\t\t# TODO Investigate if there is more reliable methos for this\n\t\tfor index, val of data\n\t\t\tif index is 'originalEvent'\n\t\t\t\treturn\n\t\t\n\t\t\n\t\t# Operate only on title, not whole node html\n\t\t# This will prevent destroying expanders etc.\n\t\tspan = jQuery(node.span).find(\"> span.fancytree-title\")\n\t\t\n\t\t# Use custom render\n\t\tif @renderer and @renderer.render\n\t\t\tmodel = finder.find node.data.id\n\t\t\t@renderer.render(model, span)\n\t\t\n\t\t# Apply icon if applicable\n\t\tif @icon or @folderIcon\n\t\t\n\t\t\t# Use html here (not node.title) as it might be altered by custom renderer\n\t\t\thtml = span.html()\n\t\t\t\n\t\t\t# Check which icon to use\n\t\t\tif @folderIcon && node.children && node.children.length\n\t\t\t\ticon = @folderIcon\n\t\t\telse\n\t\t\t\ticon = @icon\n\t\t\t\n\t\t\t# Add icon tag just before title\n\t\t\t# This will ensure proper dnd for responsive icon size\n\t\t\tspan.html(\"<i class='node-title-icon' style='background-image:url(#{icon})'></i> #{html}\")\n\n#\n# Validation manager.\n#\n# This class applies proper styles and messages to configured DOM elements.\n#\n#\n#\nclass ValidationManager\n\n\t#\n\t# Input element\n\t# @var DomElement\n\t#\n\telement: null\n\n\t#\n\t# Parent of input element\n\t# @var DomElement\n\t#\n\tparent: null\n\n\t#\n\t# Errors container element\n\t# @var DomElement\n\t#\n\terrors: null\n\n\t#\n\t# Warnings container element\n\t# @var DomElement\n\t#\n\twarnings: null\n\n\t# Private\n\ttoggle = ko.utils.toggleDomNodeCssClass\n\n\thide = (element) ->\n\t\tko.utils.toggleDomNodeCssClass element, 'hide', true\n\n\tshow = (element) ->\n\t\tko.utils.toggleDomNodeCssClass element, 'hide', false\n\n\n\n\t#\n\t# Initialize validation manager\n\t#\n\t# @param validators Maslosoft.Binder.BaseValidator[]\n\t# @param options Maslosoft.Binder.ValidatorOptions\n\t#\n\t#\n\tconstructor: (@validators, @options) ->\n\n\t#\n\t# Trigger validation and warnigs on all items\n\t#\n\t# @param element DomElement\n\t# @param value mixed\n\t#\n\t# @return bool\n\t#\n\tvalidate: (element, value) =>\n\n\t\t# Set current element here, as it could be changed in some case, ie sorting\n\t\t@setElement element\n\n\t\t# Trigger all validators\n\t\tfor validator in @validators\n\t\t\tif not @validateOne validator, value\n\t\t\t\treturn false\n\n\t\t# Loop again for warnings, or they would be overriden\n\t\tfor validator in @validators\n\t\t\t# Ensure that validator handle warnings\n\t\t\tif typeof(validator.getWarnings) is 'function'\n\t\t\t\t@adviseOne validator, value\n\n\t\treturn true\n\n\t#\n\t# Set working element. No need to call it directly, it is called by validate method.\n\t#\n\t# @param element DomElement\n\t#\n\t# @return ValidationManager\n\t#\n\tsetElement: (@element) =>\n\t\t@parent = jQuery(@element).parents('.form-group')[0]\n\n\t\tif not @parent\n\t\t\treturn @\n\n\t\t@errors = @parent.querySelector @options.errorMessages\n\t\t@warnings = @parent.querySelector @options.warningMessages\n\t\thide @errors\n\t\thide @warnings\n\t\treturn @\n\n\t#\n\t# Initialize element. This sets proper state of helper elements,\n\t# like error/warning messages container\n\t#\n\t# @param element DomElement\n\t#\n\tinit: (element) =>\n\t\t@setElement element\n\n\t#\n\t# Apply validation of one validator\n\t#\n\t# @param validator Maslosoft.Binder.BaseValidator\n\t# @param element DomElement\n\t# @param value mixed\n\t#\n\t# @return bool\n\t#\n\tvalidateOne: (validator, value) =>\n\t\t# Reassign variables for local scope\n\t\telement = @element\n\t\tparent = @parent\n\t\terrors = @errors\n\t\twarnings = @warnings\n\n\t\tmessages = new Array\n\t\tvalidator.reset()\n\t\tisValid = false\n\t\tif validator.isValid(value)\n\t\t\t# Apply input error styles as needed\n\t\t\tif @options.inputError\n\t\t\t\ttoggle(element, @options.inputError, false);\n\t\t\tif @options.inputSuccess\n\t\t\t\ttoggle(element, @options.inputSuccess, true);\n\n\t\t\t# Apply parent styles as needed\n\t\t\tif parent\n\t\t\t\tif @options.parentError\n\t\t\t\t\ttoggle(parent, @options.parentError, false);\n\t\t\t\tif @options.parentSuccess\n\t\t\t\t\ttoggle(parent, @options.parentSuccess, true);\n\n\t\t\t# Reset error messages\n\t\t\tif errors\n\t\t\t\thide errors\n\t\t\t\terrors.innerHTML = ''\n\t\t\tisValid = true\n\t\telse\n\t\t\t# Errors...\n\t\t\tmessages = validator.getErrors()\n\n\t\t\t# Apply input error styles as needed\n\t\t\tif @options.inputError\n\t\t\t\ttoggle(element, @options.inputError, true);\n\t\t\tif @options.inputSuccess\n\t\t\t\ttoggle(element, @options.inputSuccess, false);\n\n\t\t\t# Apply parent styles as needed\n\t\t\tif parent\n\t\t\t\tif @options.parentError\n\t\t\t\t\ttoggle(parent, @options.parentError, true);\n\t\t\t\tif @options.parentSuccess\n\t\t\t\t\ttoggle(parent, @options.parentSuccess, false);\n\n\t\t\t# Show error messages\n\t\t\tif errors and messages\n\t\t\t\tshow errors\n\t\t\t\terrors.innerHTML = messages.join '<br />'\n\t\t\tisValid = false\n\n\t\t#\n\t\t#\n\t\t# Warnings part - this is required here to reset warnings\n\t\t#\n\t\t#\n\n\t\t# Reset warnings regardless of validation result\n\t\t# Remove input warning styles as needed\n\t\tif @options.inputWarning\n\t\t\ttoggle(element, @options.inputWarning, false);\n\n\t\t# Remove parent styles as needed\n\t\tif parent\n\t\t\tif @options.parentWarning\n\t\t\t\ttoggle(parent, @options.parentWarning, false);\n\t\tif warnings\n\t\t\thide warnings\n\t\t\twarnings.innerHTML = ''\n\n\t\treturn isValid\n\n\t#\n\t# Apply warnings of one input\n\t#\n\t# @param validator Maslosoft.Binder.BaseValidator\n\t# @param element DomElement\n\t# @param value mixed\n\t#\n\t# @return ValidationManager\n\t#\n\tadviseOne: (validator, value) =>\n\t\t# Reassign variables for local scope\n\t\telement = @element\n\t\tparent = @parent\n\t\terrors = @errors\n\t\twarnings = @warnings\n\n\t\tmessages = validator.getWarnings()\n\t\t# If has warnings remove success and add warnings to any applicable element\n\t\tif messages.length\n\n\t\t\t# Apply input warning styles as needed\n\t\t\tif @options.inputWarning\n\t\t\t\ttoggle(element, @options.inputWarning, true);\n\t\t\tif @options.inputSuccess\n\t\t\t\ttoggle(element, @options.inputSuccess, false);\n\n\t\t\t# Apply parent styles as needed\n\t\t\tif parent\n\t\t\t\tif @options.parentWarning\n\t\t\t\t\ttoggle(parent, @options.parentWarning, true);\n\t\t\t\tif @options.parentSuccess\n\t\t\t\t\ttoggle(parent, @options.parentSuccess, false);\n\n\t\t\t# Show warnings if any\n\t\t\tif warnings\n\t\t\t\tshow warnings\n\t\t\t\twarnings.innerHTML = messages.join '<br />'\n\n\t\treturn @\n\nif not @Maslosoft.Binder.Widgets.TreeGrid\n\t@Maslosoft.Binder.Widgets.TreeGrid = {}\n\n\nclass Maslosoft.Binder.Widgets.TreeGrid.Dnd\n\n\t#\n\t# Tree grid view instance\n\t#\n\t# @var Maslosoft.Binder.Widgets.TreeGrid.TreeGridView\n\t#\n\tgrid: null\n\n\t#\n\t# Drag helper\n\t#\n\t# @var jQuery element\n\t#\n\thelper: null\n\n\t#\n\t# Drop indicator\n\t#\n\t# @var Maslosoft.Binder.Widgets.TreeGrid.DropIndicator\n\t#\n\tindicator = null\n\n\t#\n\t# Element over which currently item is dragged\n\t# @var jQuery element\n\t#\n\tdraggedOver = null\n\n\t#\n\t# Element currently dragged\n\t# @var HTMLElement\n\t#\n\tdragged = null\n\n\t#\n\t# Hit mode\n\t# @var string\n\t#\n\thitMode = null\n\n\t#\n\t# Previous hit mode, this is used for rate limit of hitMode detection\n\t# @var string\n\t#\n\tprevHitMode = null\n\n\t#\n\t# Whether drop event occured, this is required for edge cases\n\t# @var boolean\n\t#\n\tdidDrop = false\n\n\tconstructor: (@grid) ->\n\t\t\n\t\t# DND must be explicitly enabled\n\t\tif not @grid.config.dnd\n\t\t\treturn\n\n\t\tif @grid.context is 'init'\n\t\t\t# handle disposal\n\t\t\tko.utils.domNodeDisposal.addDisposeCallback @grid.element.get(0), () ->\n\t\t\t\ttry\n\t\t\t\t\tif @grid.element\n\t\t\t\t\t\t@grid.element.draggable(\"destroy\")\n\t\t\t\t\t\t@grid.element.droppable(\"destroy\")\n\t\t\t\tcatch e\n\t\t\t\t\tconsole.log e.message\n\n\t\t\t@grid.element.on 'mousemove', '> tr', @move\n\n\t\tif not indicator\n\t\t\tindicator = new Maslosoft.Binder.Widgets.TreeGrid.DropIndicator @grid\n\n\t\tdefer = () =>\n\t\t\tdraggableOptions = {\n\t\t\t\thandle: '.tree-grid-drag-handle'\n\t\t\t\tcancel: '.expander, input, *[contenteditable], .no-drag'\n\t\t\t\trevert: false\n\t\t\t\tcursor: 'pointer'\n\t\t\t\tcursorAt: { top: 5, left: 5 }\n\t\t\t\tstart: @dragStart\n\t\t\t\tdrag: @drag\n\t\t\t\tstop: @stop\n\t\t\t\thelper: @dragHelper\n\t\t\t}\n\t\t\tdroppableOptions = {\n\t\t\t\ttolerance: \"pointer\"\n\t\t\t\tdrop: @drop\n\t\t\t\tover: @over\n\t\t\t}\n\t\t\t@grid.element.find('> tr').draggable(draggableOptions)\n\t\t\t@grid.element.find('> tr').droppable(droppableOptions)\n\n\t\tsetTimeout defer, 0\n\n\t#\n\t# On dragstart\n\t#\n\t#\n\tdragStart: (e) =>\n\t\tdragged = e.target\n\t\t# data = ko.dataFor e.target\n\t\t# console.log \"Started #{data.title}\"\n\n\tdrag: (e, helper) =>\n\n\t#\n\t# Drop if stopped dragging without dropping\n\t# This is required when dragging near top or bottom of container\n\t#\n\t#\n\tstop: (e, ui) =>\n\t\tif not didDrop\n\t\t\t@drop e, ui\n\n\t#\n\t# Drop in a normal manner, see also `stop` for edge case\n\t#\n\tdrop: (e, ui) =>\n\t\tdidDrop = true\n\n\t\tif not dragged\n\t\t\treturn @clear()\n\t\tif not draggedOver\n\t\t\treturn @clear()\n\t\tif not draggedOver.get(0)\n\t\t\treturn @clear()\n\t\tcurrent = ko.dataFor dragged\n\t\tover = ko.dataFor draggedOver.get(0)\n\n\t\tif not @grid.canDrop dragged, draggedOver, hitMode\n\t\t\treturn @clear()\n\n\t\t@grid.freeze()\n\n\t\toverParent = @grid.getParent over\n\t\troot = @grid.getRoot()\n\n\t\t# console.log \"Drop #{current.title} over #{over.title}\"\n\t\t# console.log arguments\n#\t\tlog \"CURR \" + current.title\n#\t\tlog \"OVER \" + over.title\n#\t\tlog \"PRNT \" + overParent.title\n#\t\tlog \"HITM \" + hitMode\n\n\t\tif overParent.children\n\t\t\t# Model initialized\n\t\t\tparentChilds = overParent.children\n\t\telse\n\t\t\t# Array initialized\n\t\t\tparentChilds = overParent\n\n\t\tdropDelay = () =>\n\n\t\t\t@grid.remove current\n\n\t\t\tif hitMode is 'over'\n\t\t\t\t# Most obvious case, when dragged node is directly over\n\t\t\t\t# dropped node, insert current node as it's last child\n\t\t\t\tover.children.push current\n\n\t\t\tif hitMode is 'before'\n\t\t\t\t# Insert node before current node, this is case when\n\t\t\t\t# insert mark is before dragged over node\n\t\t\t\tindex = parentChilds.indexOf over\n\t\t\t\tparentChilds.splice index, 0, current\n\n\t\t\tif hitMode is 'after'\n\n\t\t\t\t# When node has children, then add just at beginning\n\t\t\t\t# to match visual position of dragged node\n\t\t\t\tif over.children.length\n\t\t\t\t\tparentChilds.splice 0, 0, current\n\t\t\t\telse\n\t\t\t\t\t# When not having children, it means that node is\n\t\t\t\t\t# last on the level so insert as a last node\n\t\t\t\t\tparentChilds.push current\n\n\t\t\t# Special case for last item. This allow adding node to top\n\t\t\t# level on the end of tree. Without this, it would be\n\t\t\t# impossible to move node to the end if last node is not top node.\n\t\t\t#\n\t\t\t# TODO for some reason view does not update on push\n\t\t\t#\n\t\t\tif hitMode is 'last'\n#\t\t\t\tlog \"Delayed Drop on end of table...\"\n\t\t\t\tif root.children\n\t\t\t\t\troot.children.push current\n\t\t\t\telse\n\t\t\t\t\t#\n\t\t\t\t\t#\n\t\t\t\t\t# TODO Neither push or splice at end works!\n\t\t\t\t\t# It *does* add to view model but does not update UI!\n\t\t\t\t\t# However splice at beginning works properly!!!111\n\t\t\t\t\t#\n\t\t\t\t\t#\n\n#\t\t\t\t\troot.splice root.length, 0, current\n\t\t\t\t\troot.push current\n\n\t\t\t@clear()\n\n\t\t# Delay a bit to reduce flickering\n\t\t# See also TreeGridView.thaw() - this value should be lower than that in thaw\n\t\tdropDelay()\n#\t\tsetTimeout dropDelay, 50\n\n\t#\n\t# Handle over state to get element to be about to be dropped\n\t# This is bound to dropable `over`\n\t#\n\tover: (e) =>\n\t\t# Don't stop propagation, just detect row\n\t\tif e.target.tagName.toLowerCase() is 'tr'\n\n\t\t\t# Limit updates to only when dragging over different items\n\t\t\tif draggedOver isnt e.target\n\t\t\t\tdraggedOver = jQuery e.target\n\t\t\t\t@dragOver e\n\n\t#\n\t# On drag over, evaluated only if entering different element or hit mode\n\t#\n\t# \n\t#\n\t#\n\t#\n\tdragOver: (e) =>\n\t\tif indicator\n\t\t\tindicator.precise.over dragged, draggedOver, hitMode, indicator\n\n\t#\n\t# Move handler for mousemove for precise position calculation\n\t# * Detect over which tree element is cursor and if it's more\n\t# on top/bottom edge or on center\n\t#\n\tmove: (e) =>\n\t\tif dragged\n\t\t\t# Dragged over itself must be handled here,\n\t\t\t# as it is not evaluated on `over`\n\t\t\tif e.currentTarget is dragged\n\t\t\t\tif not draggedOver or dragged isnt draggedOver.get(0)\n\t\t\t\t\t# console.log dragged\n\t\t\t\t\te.target = dragged\n\t\t\t\t\t@over e\n\n\t\tif draggedOver\n\t\t\t\n\t\t\toffset = draggedOver.offset()\n\n\t\t\tpos = {}\n\t\t\tpos.x = e.pageX - offset.left\n\t\t\tpos.y = e.pageY - offset.top\n\n\t\t\trel = {}\n\t\t\trel.x = pos.x / draggedOver.outerWidth(true)\n\t\t\trel.y = pos.y / draggedOver.outerHeight(true)\n\t\t\thitMode = 'over'\n\t\t\tif rel.y > 0.65\n\t\t\t\thitMode = 'after'\n\t\t\tif rel.y <= 0.25\n\t\t\t\thitMode = 'before'\n\n\t\t\tif hitMode is 'after'\n\t\t\t\t# Last elem and after - switch to last hitmode\n\t\t\t\tif @grid.isLast(ko.dataFor(draggedOver.get(0)))\n\t\t\t\t\thitMode = 'last'\n\n\t\t\t# Rate limiting for hit mode\n\t\t\tif prevHitMode isnt hitMode\n\t\t\t\tprevHitMode = hitMode\n\t\t\t\te.target = draggedOver\n\t\t\t\t@dragOver e\n\n\n\t#\n\t# Reset appropriate things on drop\n\t#\n\t#\n\tclear: () =>\n\t\t@grid.thaw()\n\t\tdraggedOver = null\n\t\tdragged = null\n\t\thitMode = null\n\t\tprevHitMode = null\n\t\tdidDrop = false\n\t\t# Destroy helpers and indicators\n\t\tif @helper\n\t\t\t@helper.hide()\n\t\t\t@helper = null\n\t\tif indicator\n\t\t\tindicator.hide()\n\n\t#\n\t# Initialize drag helper\n\t#\n\t#\n\tdragHelper: (e) =>\n\t\t\n\t\ttbody = jQuery(e.currentTarget).parent()\n\t\tcell = tbody.find('.tree-grid-drag-handle').parents('td').first()\n\t\titem = cell.clone()\n\t\titem.find('.expander .expanded').remove()\n\t\titem.find('.expander .collapsed').remove()\n\t\titem.find('.expander').remove()\n\t\titem.find('.no-expander').remove()\n\t\tdropIndicator = \"<span class='drop-indicator'>&times;</span>\"\n\t\t@helper = jQuery(\"<div style='white-space:nowrap;'>#{dropIndicator}#{item.html()}</div>\")\n\t\t@helper.css(\"pointer-events\",\"none\")\n\t\t\n\t\tindicator.attach @helper.find('.drop-indicator')\n\t\treturn @helper\n\n\n\n\nclass Maslosoft.Binder.Widgets.TreeGrid.DropIndicator\n\n\t#\n\t# Precise indicator holder\n\t# @var Maslosoft.Binder.Widgets.TreeGrid.InsertIndicator\n\t#\n\t@precise: null\n\n\t#\n\t# Indicator element instance boud to draggable\n\t# @var jQuery element\n\t#\n\t@element: null\n\n\tconstructor: (@grid) ->\n\n\t\t@precise = new Maslosoft.Binder.Widgets.TreeGrid.InsertIndicator @grid\n\n\tattach: (@element) ->\n\t\t@element.css 'font-size': '1.5em'\n\t\t@element.css 'width': '1em'\n\t\t@element.css 'height': '1em'\n\t\t@element.css 'position': 'absolute'\n\t\t# 1/2 of font size\n\t\t@element.css 'left': '-.75em'\n\t\t# 1/4 of font size\n\t\t@element.css 'top': '-.35em'\n\n\thide: () ->\n\t\t@element.hide()\n\t\t@precise.hide()\n\n\tshow: () ->\n\t\t@element.show()\n\t\t@precise.show()\n\n\taccept: () ->\n\t\t@element.html('&check;')\n\t\t@element.css 'color': 'green'\n\t\t@precise.accept()\n\n\tdeny: () ->\n\t\t@element.html('&times;')\n\t\t@element.css 'color': 'red'\n\t\t@precise.deny()\n\nclass Maslosoft.Binder.Widgets.TreeGrid.Events\n\n\t#\n\t# Tree grid view instance\n\t#\n\t# @var Maslosoft.Binder.Widgets.TreeGrid.TreeGridView\n\t#\n\tgrid: null\n\n\tconstructor: (@grid, context) ->\n\t\n\t\tif not @grid.config.on\n\t\t\treturn\n\nclass Maslosoft.Binder.Widgets.TreeGrid.Expanders\n\n\t#\n\t# Init expands\n\t# @return boolean whether is expanded\n\t#\n\tinitExpand = (item) ->\n\t\tel = item.find('.expander')\n\t\tif el.find('.expanded:visible').length\n\t\t\tel.find('.expanded').hide()\n\t\t\tel.find('.collapsed').show()\n\t\t\tshow = false\n\t\telse\n\t\t\tel.find('.collapsed').hide()\n\t\t\tel.find('.expanded').show()\n\t\t\tshow = true\n\t\treturn show\n\n\t#\n\t# Expand expanders\n\t#\n\texpand = (item) ->\n\t\tel = item.find('.expander')\n\t\tel.find('.collapsed').hide()\n\t\tel.find('.expanded').show()\n\n\t#\n\t# Collapse expanders\n\t#\n\tcollapse = (item) ->\n\t\tel = item.find('.expander')\n\t\tel.find('.expanded').hide()\n\t\tel.find('.collapsed').show()\n\n\t#\n\t# Tree grid view instance\n\t#\n\t# @var Maslosoft.Binder.Widgets.TreeGrid.TreeGridView\n\t#\n\tgrid: null\n\n\tconstructor: (@grid, context) ->\n\n\t\t# Expanders explicitly disabled\n\t\tif @grid.config.expanders is false\n\t\t\treturn\n\n\t\t# Initialize click handlers only on init\n\t\tif @grid.context is 'init'\n\t\t\t@grid.element.on 'mousedown', '.expander', @handler\n\t\t\t@grid.element.on 'click', '.expander', @cancelClick\n\n\t\tif @grid.context is 'update'\n\t\t\t@updateExpanders()\n\n\tupdateExpanders: () =>\n\n\t\tone = (item, data) =>\n\t\t\thasChildren = data.children && data.children.length\n\t\t\tif hasChildren\n\t\t\t\titem.find('.no-expander').hide()\n\t\t\t\titem.find('.expander').show()\n\t\t\t\tif not item.find('.expander .collapsed').is(':visible')\n\t\t\t\t\titem.find('.expander .expanded').show()\n\t\t\telse\n\t\t\t\titem.find('.expander').hide()\n\t\t\t\titem.find('.no-expander').show()\n#\t\t\titem.find('.debug').html data.children.length\n\t\tdefer = () =>\n\t\t\t@grid.visit one\n\n#\t\tdefer()\n\t\tsetTimeout defer, 0\n\n\thandler: (e) =>\n\t\tcurrent = ko.contextFor(e.target).$data\n\n\t\t# Expanding tree node should not call action\n\t\t# @see https://github.com/Maslosoft/Binder/issues/33\n\t\te.stopPropagation()\n\t\te.preventDefault()\n\n\t\tdepth = -1\n\t\tshow = false\n\n\t\tlog \"clicked on expander #{current.title}\"\n\n\t\tinitOne = (item, data) =>\n\t\t\titemDepth = data._treeGrid.depth\n\t\t\tif data is current\n\t\t\t\tdepth = itemDepth\n\t\t\t\tshow = initExpand(item)\n\t\t\t\titem.data 'treegrid-manual-state', show\n\t\t\t\t# Current item should be left intact, so skip to next item\n\t\t\t\treturn\n\n\t\t\t# Not found yet, so continue\n\t\t\tif depth is -1 then return\n\n\t\t\t# Found item on same depth, skip further changes\n\t\t\tif itemDepth is depth\n\t\t\t\tdepth = -1\n\t\t\t\treturn\n\n\t\t\t# toggle all one depth lower\n\t\t\tif itemDepth >= depth\n\n\t\t\t\t# TODO: Below is a scratch of logic to re-expand or re-collapse\n\t\t\t\tif false\n\t\t\t\t\t# nodes that were manually toggled.\n\t\t\t\t\tshowChildItems = show\n\n\t\t\t\t\t# Manually expanded/collapsed sub nodes\n\t\t\t\t\t# should have state restored\n\t\t\t\t\tmanuallyToggled = item.data 'treegrid-manual-state'\n\t\t\t\t\tif typeof(manuallyToggled) isnt 'undefined'\n\t\t\t\t\t\tconsole.log manuallyToggled\n\t\t\t\t\t\tshowChildItems = manuallyToggled\n\n\t\t\t\tif show\n\t\t\t\t\titem.show()\n\t\t\t\t\texpand item\n\t\t\t\telse\n\t\t\t\t\titem.hide()\n\t\t\t\t\tcollapse item\n\n\t\t@grid.visit initOne\n\n\t# Cancel expander click event, as it reacts on mousedown\n\t# however click would propagate and call action\n\tcancelClick: (e) =>\n\t\te.stopPropagation()\n\t\te.preventDefault()\n\n\n#\n# Insert indicator\n#\n#\n#\n\nclass Maslosoft.Binder.Widgets.TreeGrid.InsertIndicator\n\n\t#\n\t# Tree grid view instance\n\t#\n\t# @var Maslosoft.Binder.Widgets.TreeGrid.TreeGridView\n\t#\n\tgrid: null\n\n\t#\n\t#\n\t# @private\n\t# @static\n\t#\n\tinitialized = false\n\n\t#\n\t# Indicator main wrapper\n\t# @var jQuery element\n\t# @private\n\t# @static\n\t#\n\tindicator = null\n\n\t#\n\t# Indicator coarse item\n\t# @var jQuery element\n\t# @private\n\t# @static\n\t#\n\tcoarse = null\n\n\t#\n\t# Indicator precise item\n\t# @var jQuery element\n\t# @private\n\t# @static\n\t#\n\tprecise = null\n\n\tconstructor: (@grid) ->\n\n\t\tif not initialized\n\t\t\t@create()\n\t\t\tinitialized = true\n\n\thide: () ->\n\t\tindicator.hide()\n\n\tshow: () ->\n\t\tindicator.show()\n\n\taccept: () ->\n\t\tindicator.css color: 'green'\n\n\tdeny: () ->\n\t\tindicator.css color: 'red'\n\n\t#\n\t# Place over element, with hitMode param\n\t#\n\t#\n\tover: (dragged, draggedOver, hitMode = 'over', accepter) ->\n\n\t\t@accept()\n\t\taccepter.accept()\n\n\t\tif hitMode is 'over'\n\t\t\t@precise false\n\t\telse\n\t\t\t@precise true\n\n\t\tif @grid.canDrop dragged, draggedOver, hitMode\n\t\t\t@accept()\n\t\t\taccepter.accept()\n\t\telse\n\t\t\t@deny()\n\t\t\taccepter.deny()\n\n\t\tnode = draggedOver.find('.tree-grid-drag-handle')\n\n\t\twidthOffset = 0\n\t\tmidFactor = 1.5\n\n\t\toffset = node.offset()\n\t\tmid = indicator.outerHeight(true) / midFactor\n\t\t\n\t\tif hitMode is 'over'\n\t\t\tnodeMid = node.outerHeight(true) / midFactor\n\t\t\ttop = offset.top + nodeMid - mid\n\n\t\tif hitMode is 'before'\n\t\t\ttop = offset.top - mid\n\n\t\tif hitMode is 'after'\n\t\t\ttop = offset.top + node.outerHeight(true) - mid\n\n\t\tleft = offset.left + widthOffset\n\n\t\tindicator.css left: left\n\t\tindicator.css top: top\n\n\t\t@show()\n\n\n\t#\n\t# Show or hide precise indicator\n\t#\n\t#\n\tprecise: (showPrecise = true) ->\n\t\tif showPrecise\n\t\t\tprecise.show()\n\t\telse\n\t\t\tprecise.hide()\n\n\tcreate: () ->\n\t\tindicator = jQuery '''\n\t\t<div class=\"tree-grid-insert-indicator\" style=\"display:none;position:absolute;z-index: 10000;color:green;line-height: 1em;\">\n\t\t\t<span class=\"tree-grid-insert-indicator-coarse\" style=\"font-size: 1.5em;\">\n\t\t\t\t&#9654;\n\t\t\t</span>\n\t\t\t<span class=\"tree-grid-insert-indicator-precise\" style=\"font-size:1.4em;\">\n\t\t\t\t&#11835;\n\t\t\t</span>\n\t\t</div>\n\t\t'''\n\t\tindicator.appendTo 'body'\n\t\tcoarse = indicator.find '.tree-grid-insert-indicator-coarse'\n\t\tprecise = indicator.find '.tree-grid-insert-indicator-precise'\n\nclass Maslosoft.Binder.Widgets.TreeGrid.TreeGridView\n\n\t#\n\t# Plugins for tree grid\n\t#\n\t# NOTE: Order of plugins *might* be important, especially for built-in plugins\n\t#\n\t# @var Object[]\n\t#\n\t@plugins = [\n\t\tMaslosoft.Binder.Widgets.TreeGrid.Expanders\n\t\tMaslosoft.Binder.Widgets.TreeGrid.Dnd\n\t\tMaslosoft.Binder.Widgets.TreeGrid.Events\n\t]\n\n\t#\n\t# TBODY element - root of tree\n\t#\n\t# @var jQuery element\n\t#\n\telement: null\n\n\t#\n\t# Configuration of binding\n\t#\n\t# @var Object\n\t#\n\tconfig: null\n\n\tconstructor: (element, valueAccessor = null, @context = 'init') ->\n\n\t\t@element = jQuery element\n\t\t\n\t\tif valueAccessor\n\t\t\t@config = {}\n\t\t\t@config = ko.unwrap(valueAccessor())\n\n\t\t\tfor plugin in TreeGridView.plugins\n\t\t\t\tnew plugin(@)\n\n#\t\t\tconsole.log data\n\n\tinit: () ->\n\t\tjQuery(document).on 'ajaxStart', @freeze\n\t\tjQuery(document).on 'ajaxComplete', @thaw\n\n\tdispose: () ->\n\t\tjQuery(document).off 'ajaxStart', @freeze\n\t\tjQuery(document).off 'ajaxComplete', @thaw\n\n\t#\n\t# Visit each node and apply callback.\n\t# Callback accepts two parameters:\n\t#\n\t# * element - contains current row jQuery element\n\t# * data - contains data attached to element\n\t#\n\t#\n\tvisit: (callback) ->\n\t\titems = @element.find('> tr')\n\t\tfor item in items\n\t\t\tdata = ko.dataFor(item)\n\t\t\tcallback(jQuery(item), data)\n\n\t#\n\t# Visit each node starting from tree root and apply callback.\n\t# Callback accepts two parameters:\n\t#\n\t# * parent - contains current element parent item, might be null\n\t# * data - contains data attached to element\n\t#\n\t#\n\tvisitRecursive: (callback, model = null) =>\n\t\tif not model\n\t\t\tmodel = @getRoot()\n\t\t\tcallback null, model\n\t\t\tif model.children and model.children.length\n\t\t\t\tfor child in model.children\n\t\t\t\t\tcallback model, child\n\t\t\t\t\t@visitRecursive callback, child\n\t\t\t# Array node\n\t\t\tif model.length\n\t\t\t\tfor child in model\n\t\t\t\t\tcallback model, child\n\t\t\t\t\t@visitRecursive callback, child\n\t\telse\n\t\t\tif model.children and model.children.length\n\t\t\t\tfor child in model.children\n\t\t\t\t\tcallback model, child\n\t\t\t\t\t@visitRecursive callback, child\n\t\t\t# Array node\n\t\t\tif model.length\n\t\t\t\tfor child in model\n\t\t\t\t\tcallback model, child\n\t\t\t\t\t@visitRecursive callback, child\n\n\tgetParent: (model) =>\n\t\tfound = null\n\n\t\tone = (parent, data) ->\n\t\t\tif data is model\n\t\t\t\tfound = parent\n\t\t# Don't set model here to start from root\n\t\t@visitRecursive one\n\t\treturn found\n\n\tgetRoot: () =>\n\t\tctx = ko.contextFor @element.get(0)\n\t\treturn ctx.tree\n\n\tgetContext: () =>\n\t\treturn ko.contextFor @element.get(0)\n\n\t#\n\t# Check if parent have child\n\t#\n\t#\n\thave: (parent, child) =>\n\n\t\tfound = false\n\n\t\tone = (parent, data) ->\n\t\t\tif data is child\n\t\t\t\tfound = true\n\n\t\t# Start from parent here\n\t\t@visitRecursive one, parent\n\t\treturn found\n\n\t#\n\t# Check if it is last on list of table rows\n\t#\n\t#\n\tisLast: (model) =>\n\t\tlastRow = @element.find('> tr:last()')\n\t\tlast = ko.dataFor lastRow.get(0)\n\t\tif model is last\n\t\t\treturn true\n\t\treturn false\n\n\t#\n\t# Check if can actually drop on draggedOver\n\t#\n\tcanDrop: (dragged, draggedOver, hitMode) =>\n\t\tcurrent = ko.dataFor dragged\n\t\tover = ko.dataFor draggedOver.get(0)\n\n#\t\tlog current.title\n#\t\tlog over.title\n\n\t\t# Allow adding to the end of table\n\t\tif hitMode is 'last'\n\t\t\treturn true\n\n\t\t# Allow adding to the end of list\n\t\tif hitMode is 'after'\n\t\t\treturn true\n\n\t\t# Forbid dropping on itself\n\t\tif current is over\n\t\t\treturn false;\n\n\t\t# Forbid dropping on children of current node\n\t\tif @have current, over\n\t\t\treturn false\n\n\t\treturn true\n\n\tremove: (model) =>\n\t\tone = (parent, data) ->\n\t\t\tif parent\n\t\t\t\t# Model initialized\n\t\t\t\tif parent.children\n\t\t\t\t\tparent.children.remove model\n\t\t\t\t# Array initialized\n\t\t\t\telse\n\t\t\t\t\tparent.remove model\n\n\t\t# Don't set model here to start from root\n\t\t@visitRecursive one\n\n\texpandAll: () ->\n\n\tcollapseAll: () ->\n\n\n\tcellsStyles = []\n\n\t#\n\t# Set widths of table cells to strict values.\n\t# This prevents flickering table when moving nodes.\n\t#\n\t#\n\tfreeze: () =>\n\t\tconsole.log \"Freeze\"\n\t\t# Reset stored width values\n\t\tcellsStyles = []\n\t\tcells = @getFirstCells()\n\t\tconsole.log cells\n\t\tfor cell in cells\n#\t\t\tlog cell\n\t\t\tcellsStyles.push cell.style\n\t\t\t$cell = jQuery cell\n#\t\t\tlog $cell.width()\n\t\t\t$cell.css 'width', $cell.width() + 'px'\n\n\n\t#\n\t# Set widths of table cells back to original style, set by freeze()\n\t#\n\t#\n\tthaw: () =>\n\t\tdefer = () =>\n\t\t\tconsole.log 'thaw'\n\t\t\tcells = @getFirstCells()\n\n\t\t\tfor cell, index in cells\n\t\t\t\tcell.style = cellsStyles[index]\n\t\t# TODO setTimeout should be avoided, investigate if should be used\n\t\t# Unfreezing takes some time...\n\t\t# This needs to be delayed a bit or flicker will still occur\n\t\tdefer()\n#\t\tsetTimeout defer, 0\n\n\tgetFirstCells: () =>\n\t\ttable = @element\n\t\tif @element.is 'tbody'\n\t\t\ttable = @element.parent()\n\t\tcells = table.find('thead tr:first() th')\n\t\tif not cells or not cells.length\n\t\t\tcells = table.find('tr:first() td')\n\t\tif not cells or not cells.length\n\t\t\tcells = table.find('tbody tr:first() td')\n\t\tif not cells or not cells.length\n\t\t\tcells = table.find('tfoot tr:first() th')\n\t\treturn cells\n@Maslosoft.Ko.getType = (type) ->\n\tif x and typeof x is 'object'\n\t\tif x.constructor is Date then return 'date'\n\t\tif x.constructor is Array then return 'array'\n\treturn typeof x\n\n@Maslosoft.Ko.objByName = (name, context = window) ->\n\targs = Array.prototype.slice.call(arguments, 2)\n\tns = name.split \".\"\n\tfunc = context\n\tpart = []\n\tfor n, i in ns\n\t\tpart.push n\n\t\tif typeof func[n] is 'undefined'\n\t\t\tthrow new Error \"Name part `#{part.join('.')}` not found while accesing #{name}\"\n\t\tfunc = func[n]\n\treturn func\n\nclass @Maslosoft.Ko.Track\n\n\tfactory: (data) =>\n\t\t# Return if falsey value\n\t\tif not data then return data\n\n\t\t# Check if has prototype\n\t\tif data._class and typeof(data._class) is 'string'\n\t\t\t# Convert PHP class name to js class name\n\t\t\tclassName = data._class.replace(/\\\\/g, '.')\n\t\t\ttry\n\t\t\t\tref = Maslosoft.Ko.objByName(className)\n\t\t\tcatch Error\n\t\t\t\tconsole.warn(\"Could not resolve class name `#{className}`\")\n\n\t\t\tif ref\n\t\t\t\treturn new ref(data)\n\t\t\telse\n\t\t\t\tconsole.warn(\"Class `#{className}` not found, using default object\")\n\t\t\t\tconsole.debug(data)\n\n\t\t# Track generic object\n\t\tif typeof(data) is 'object'\n\t\t\tdata = ko.track(data, {deep: true})\n\t\t\t# Check if array (different loop used here)\n\t\t\tif Array.isArray data\n\t\t\t\tfor model, index in data\n\t\t\t\t\tdata[index] = @factory model\n\t\t\telse\n\t\t\t\tfor name, value of data\n\t\t\t\t\tdata[name] = @factory(value)\n\t\t\n\t\treturn data\n\n\tfromJs: (model, jsData) =>\n\t\tfor name, value of jsData\n\t\t\tif typeof(value) is 'object'\n\t\t\t\tif Array.isArray value\n\t\t\t\t\tmodel[name] = @factory value\n\t\t\t\t\tcontinue\n\t\t\t\tif model[name]\n\t\t\t\t\t@fromJs model[name], value\n\t\t\t\telse\n\t\t\t\t\tmodel[name] = @factory value\n\t\t\telse\n\t\t\t\tmodel[name] = value\n\nko.tracker = new @Maslosoft.Ko.Track\n\n#\n# Model class with automatically applied knockout bindings\n#\n\n# Stub to ignore fatal errors\nif !window.Proxy\n\tconsole.warn 'Your browser does not support Proxy, will not work properly in some cases...'\n\tclass window.Proxy\n\nclass ModelProxyHandler\n\tconstructor: (@parent, @field) ->\n\n\tset: (target, name, value, receiver) ->\n\t\tchanged = false\n\n\t\t# Detect value change\n\t\tif target[name] isnt value\n#\t\t\tlog \"Changed: #{@parent.constructor.name}.#{@field} @ #{target.constructor.name}.#{name}\"\n\t\t\tchanged = true\n\n\t\t# Detect keys change\n\t\tbefore = Object.keys(target).length\n\t\ttarget[name] = value\n\t\tafter = Object.keys(target).length\n\t\tif before isnt after\n#\t\t\tlog \"New key: #{@parent.constructor.name}.#{@field} @ #{target.constructor.name}.#{name}\"\n\t\t\tchanged = true\n\t\t\n\t\t# Notify change\n\t\tif changed\n\t\t\tko.valueHasMutated(@parent, @field)\n\t\treturn true\n\n\tdeleteProperty: (target, name) ->\n\t\tdelete target[name]\n\t\t# Notify change\n#\t\tlog \"Deleted: #{@parent.constructor.name}.#{@field} @ #{target.constructor.name}.#{name}\"\n\t\tko.valueHasMutated(@parent, @field)\n\t\treturn true\n\n# Map for concrete objects initializations\nif WeakMap\n\tinitMap = new WeakMap()\nelse\n\tinitMap = new Map()\n\nclass @Maslosoft.Binder.Model\n\n\tconstructor: (data = null) ->\n\n\t\tinitialized = initMap.get @\n\n\t\t# Dereference first\n\t\tfor name, value of @\n\t\t\tif isPlainObject @[name]\n\t\t\t\t@[name] = {}\n\t\t\tif Array.isArray @[name]\n\t\t\t\t@[name] = []\n\n\t\t# Initialize new object\n\t\tif not initialized\n\t\t\tinitMap.set @, true\n\t\t\t# Reassign here is required - when using model with values from class prototype only\n\t\t\tfor name, value of @\n\n\t\t\t\t@[name] = ko.tracker.factory(value)\n\n\t\t\t\t# Extra track of object properties.\n\t\t\t\tif isPlainObject @[name]\n\t\t\t\t\t@[name] = new Proxy(@[name], new ModelProxyHandler(@, name))\n\n\t\t# Apply data\n\t\tfor name, value of data\n\t\t\t@[name] = ko.tracker.factory(value)\n\n\t\t# Track plain objects always\n\t\tfor name, value of @\n\t\t\tif isPlainObject @[name]\n\t\t\t\t@[name] = new Proxy(@[name], new ModelProxyHandler(@, name))\n\t\tko.track(@, {deep: true})\n\n# For backward compatibility\n@Maslosoft.Ko.Balin = @Maslosoft.Binder\n\n@Maslosoft.Ko.escapeRegExp = escapeRegExp\n\n@Maslosoft.Ko.escapeHtml = escapeHtml\n\n@Maslosoft.Ko.equals = equals\n\n@Maslosoft.Ko.stringToColour = stringToColour\n\n@Maslosoft.Ko.preload = preload\n\n@Maslosoft.Ko.numberFormat = numberFormat\n\n@Maslosoft.Ko.lcfirst = lcfirst\n\n@Maslosoft.Ko.ucfirst = ucfirst"
  ]
}