!function(){"use strict";function f(t,e){if(!(t instanceof e))throw new Error("Bound instance method accessed before binding")}var r,l,R,L,Q,t,a,I,G,n,e,o,d,z,h,u,K,c,p,i,U,g,_,m,v,Y,J,s,y,b,M,q,Z,B,X,tt,w,et,k,V,C,T,D,E,F,j,st,it,rt,nt,ot,O,A,S,H,N,at,lt,dt,ht,ut,ct,pt,P,ft,gt,mt,vt,yt,bt,Mt,Bt,W=function(t){if(console)return console.log.apply(console,arguments)},wt=function(t,e=0){if(console)return console.warn.apply(console,arguments)},xt=function(t,e=0){if(console)return console.error.apply(console,arguments)};Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),u=function(t){return!!t&&"object"==typeof t&&t.constructor===Object},Object.keys||(Object.keys=(yt=Object.prototype.hasOwnProperty,bt=!{toString:null}.propertyIsEnumerable("toString"),Bt=(Mt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(t){var e,s,i;if("object"!=typeof t&&("function"!=typeof t||null===t))throw new TypeError("Object.keys called on non-object");for(s in i=[],e=s=void 0,t)yt.call(t,s)&&i.push(s);if(bt)for(e=0;e<Bt;)yt.call(t,Mt[e])&&i.push(Mt[e]),e++;return i})),gt=function(t,e,s=window){Array.prototype.slice.call(arguments,2);for(var i,r,n=t.split("."),o=s,a=i=0,l=n.length;i<l;a=++i)r=n[a],console.log(a),a===n.length-1&&(console.log(r),o[r]=e),o=o[r];return o},z=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},d=function(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return e[t]})},o=function(t,e,s=[]){var i,r=function(t){return-1!==s.indexOf(t)};if(t!==e){if(!(t instanceof Object&&e instanceof Object))return!1;if(t.constructor!==e.constructor)return!1;for(i in t)if(!r(i)&&t.hasOwnProperty(i)){if(!e.hasOwnProperty(i))return!1;if(t[i]!==e[i]){if("object"!=typeof t[i])return!1;if(!o(t[i],e[i],s))return!1}}for(i in e)if(!r(i)&&e.hasOwnProperty(i)&&!t.hasOwnProperty(i))return!1}return!0},mt=function(t){var e,s=0,i=0;for(i=0;i<t.length;)s=t.charCodeAt(i)+(s<<5)-s,i++;for(e="#",i=0;i<3;)e+=("00"+(s>>8*i&255).toString(16)).substr(-2),i++;return e},i={},p=function(t,e){var s;if(!i[e])return(s=new Image).src=e,s.onload=function(){return s=null,i[e]=!0,t.attr("src",e)};t.attr("src",e)},n=function(t,e){var s;if(!t.hasAttribute(e))return(s=document.createAttribute(e)).value="",t.setAttributeNode(s),t.setAttribute(e,""),jQuery(t).attr(e,"")},c=function(t,e=2,s=3,i=" ",r=","){s="\\d(?=(\\d{"+(s||3)+"})+"+(0<e?"\\D":"$")+")",t=t.toFixed(Math.max(0,~~e));return(r?t.replace(".",r):t).replace(new RegExp(s,"g"),"$&"+(i||","))},K=function(t){return t.substring(0,1).toLocaleLowerCase()+t.substring(1)},vt=function(t){return t.substring(0,1).toLocaleUpperCase()+t.substring(1)},this.Maslosoft||(this.Maslosoft={}),this.Maslosoft.Ko||(this.Maslosoft.Ko={}),this.Maslosoft.Ko.Balin||(this.Maslosoft.Ko.Balin={}),this.Maslosoft.Binder||(this.Maslosoft.Binder={}),this.Maslosoft.Binder.Helpers||(this.Maslosoft.Binder.Helpers={}),this.Maslosoft.Binder.Widgets||(this.Maslosoft.Binder.Widgets={}),this.Maslosoft.Ko.debounce=function(r,n,o){var a=void 0;return function(){var t=this,e=arguments,s=function(){a=null,o||r.apply(t,e)},i=o&&!a;clearTimeout(a),a=setTimeout(s,n||200),i&&r.apply(t,e)}},this.Maslosoft.Binder.register=function(t,e){var s=!1;if(t.match(/[A-Z]/)&&(s=t.toLowerCase()),e.writable&&ko.expressionRewriting&&ko.expressionRewriting.twoWayBindings&&(ko.expressionRewriting.twoWayBindings[t]=!0,s)&&(ko.expressionRewriting.twoWayBindings[s]=!0),ko.bindingHandlers[t]=e,s)return ko.bindingHandlers[s]=e},this.Maslosoft.Binder.registerDefaults=function(t=null){var e,s,i,r,n={acl:Maslosoft.Binder.Acl,active:Maslosoft.Binder.Active,action:Maslosoft.Binder.WidgetAction,activity:Maslosoft.Binder.WidgetActivity,asset:Maslosoft.Binder.Asset,cssClasses:Maslosoft.Binder.CssClasses,cssColumnSizes:Maslosoft.Binder.CssColumnSizes,cssColumns:Maslosoft.Binder.CssColumns,data:Maslosoft.Binder.Data,dateFormatter:Maslosoft.Binder.DateFormatter,datePicker:Maslosoft.Binder.DatePicker,datePickerPickaDate:Maslosoft.Binder.PickaDate,dateTimeFormatter:Maslosoft.Binder.DateTimeFormatter,decimalFormatter:Maslosoft.Binder.DecimalFormatter,disabled:Maslosoft.Binder.Disabled,enumCssClassFormatter:Maslosoft.Binder.EnumCssClassFormatter,enumFormatter:Maslosoft.Binder.EnumFormatter,eval:Maslosoft.Binder.Eval,fancytree:Maslosoft.Binder.Fancytree,fileSizeFormatter:Maslosoft.Binder.FileSizeFormatter,googlemap:Maslosoft.Binder.GoogleMap,hidden:Maslosoft.Binder.Hidden,href:Maslosoft.Binder.Href,html:Maslosoft.Binder.Html,htmlTree:Maslosoft.Binder.HtmlTree,htmlValue:Maslosoft.Binder.HtmlValue,icon:Maslosoft.Binder.Icon,id:Maslosoft.Binder.Id,log:Maslosoft.Binder.Log,model:Maslosoft.Binder.DataModel,placeholder:Maslosoft.Binder.Placeholder,ref:Maslosoft.Binder.Widget,src:Maslosoft.Binder.Src,tags:Maslosoft.Binder.Tags,text:Maslosoft.Binder.Text,textToBg:Maslosoft.Binder.TextToBg,textValue:Maslosoft.Binder.TextValue,textValueHlJs:Maslosoft.Binder.TextValueHLJS,timeAgoFormatter:Maslosoft.Binder.TimeAgoFormatter,timeFormatter:Maslosoft.Binder.TimeFormatter,timePicker:Maslosoft.Binder.TimePicker,tooltip:Maslosoft.Binder.Tooltip,treegrid:Maslosoft.Binder.TreeGrid,treegridnode:Maslosoft.Binder.TreeGridNode,selected:Maslosoft.Binder.Selected,select2:Maslosoft.Binder.Select2,validator:Maslosoft.Binder.Validator,videoPlaylist:Maslosoft.Binder.VideoPlaylist,videoThumb:Maslosoft.Binder.VideoThumb,widget:Maslosoft.Binder.Widget};if(null!==t){for(e in s=[],t)r=t[e],s.push(Maslosoft.Binder.register(r,new n[r]));return s}for(e in i=[],n)r=n[e],i.push(Maslosoft.Binder.register(e,new r));return i},this.Maslosoft.Binder.registerEvents=function(t=null){var e,s,i,r,n={dblclick:"dblclick",mousedown:"mousedown",mouseup:"mouseup",mouseover:"mouseover",mouseout:"mouseout"};if(null!==t){for(e in s=[],t)r=t[e],s.push(Maslosoft.Binder.makeEventHandlerShortcut(r));return s}for(e in i=[],n)r=n[e],i.push(Maslosoft.Binder.makeEventHandlerShortcut(r));return i},this.Maslosoft.Binder.makeEventHandlerShortcut=function(n){ko.bindingHandlers[n]={init:function(t,e,s,i,r){return ko.bindingHandlers.event.init.call(this,t,function(){var t={};return t[n]=e(),t},s,i,r)}}},this.Maslosoft.Binder.Base=function(){class t{constructor(t={}){var e,s;for(e in this.getValue=this.getValue.bind(this),this.options={},t)s=t[e],this.options[e]=s}getValue(t,e=""){t="function"==typeof t?ko.unwrap(t()):ko.unwrap(t);return void 0===(t=this.options.valueField?this.options.ec5?t[this.options.valueField]:t[this.options.valueField]():t)?e:t}}return t.prototype.writable=!0,t.prototype.options={},t}.call(this),this.Maslosoft.Binder.Options=function(){class t{constructor(t={}){var e,s;for(e in t)s=t[e],this[e]=s;null===this.ec5&&(this.ec5=!!ko.track),null===this.afterUpdate&&(this.afterUpdate=function(t,e){})}}return t.prototype.valueField=null,t.prototype.ec5=null,t.prototype.afterUpdate=null,t}.call(this),this.Maslosoft.Binder.CssOptions=function(){class t extends this.Maslosoft.Binder.Options{}return t.prototype.className="active",t}.call(this),this.Maslosoft.Binder.DateOptions=function(){class t extends this.Maslosoft.Binder.Options{}return t.prototype.lang="en",t.prototype.sourceFormat="unix",t.prototype.displayFormat="YYYY-MM-DD",t}.call(this),this.Maslosoft.Binder.DateTimeOptions=function(){class t extends this.Maslosoft.Binder.Options{}return t.prototype.lang="en",t.prototype.sourceFormat="unix",t.prototype.displayFormat="YYYY-MM-DD hh:mm",t}.call(this),this.Maslosoft.Binder.TimeAgoOptions=function(){class t extends this.Maslosoft.Binder.Options{}return t.prototype.lang="en",t.prototype.sourceFormat="unix",t.prototype.displayFormat="hh:mm",t}.call(this),this.Maslosoft.Binder.TimeOptions=function(){class t extends this.Maslosoft.Binder.Options{}return t.prototype.lang="en",t.prototype.sourceFormat="unix",t.prototype.displayFormat="hh:mm",t}.call(this),this.Maslosoft.Binder.ValidatorOptions=function(){class t extends this.Maslosoft.Binder.Options{}return t.prototype.classField="_class",t.prototype.parentSelector=".form-group",t.prototype.inputError="error",t.prototype.parentError="has-error",t.prototype.inputWarning="warning",t.prototype.parentWarning="has-warning",t.prototype.inputSuccess="success",t.prototype.parentSuccess="has-success",t.prototype.errorMessages=".error-messages",t.prototype.warningMessages=".warning-messages",t}.call(this),this.Maslosoft.Binder.BaseValidator=function(){class t{constructor(t){var e,s;for(e in this.reset(),t)s=t[e],this[e]=null,this[e]=s}reset(){return this.messages=new Array,this.rawMessages=new Object,this.warningMessages=new Array,this.rawWarningMessages=new Object}isValid(){throw new Error("Validator must implement `isValid` method")}getErrors(){return this.messages}getWarnings(){return this.warningMessages}addError(t,e){var s,i,r,n=t;for(s in t=t.replace("{attribute}",this.label),this)r=this[s],t=t.replace(`{${s}}`,r);for(s in e)r=e[s],t=t.replace(`{${s}}`,r);for(s in i=this.model)r=i[s],t=t.replace(`{${s}}`,r);if(!this.rawMessages[n])return this.messages.push(t),this.rawMessages[n]=!0}addWarning(t,e){var s,i,r,n=t;for(s in t=t.replace("{attribute}",this.label),this)r=this[s],t=t.replace(`{${s}}`,r);for(s in e)r=e[s],t=t.replace(`{${s}}`,r);for(s in i=this.model)r=i[s],t=t.replace(`{${s}}`,r);if(!this.rawWarningMessages[n])return this.warningMessages.push(t),this.rawWarningMessages[n]=!0}}return t.prototype.label="",t.prototype.model=null,t.prototype.messages=[],t.prototype.rawMessages=[],t.prototype.warningMessages=[],t.prototype.rawWarningMessages=[],t}.call(this),U=this.Maslosoft.Binder.CssClass=function(){class t extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e){f(this,U),this.getValue(e)?ko.utils.toggleDomNodeCssClass(t,this.options.className,!0):ko.utils.toggleDomNodeCssClass(t,this.options.className,!1)}}return t.prototype.writable=!1,t}.call(this),q=this.Maslosoft.Binder.CssColumnsBase=function(){class t extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.applyColumns=this.applyColumns.bind(this)}applyColumns(t,e,s){var i,r,n,o;for(o in f(this,q),r=[],s)n=(i=s[o]).replace("{num}","\\d"),i=i.replace("{num}",""),n=new RegExp(`(?:^|\\s)${n}+(?!\\S)`,"g"),t.className=t.className.replace(n,""),r.push(i+e[o]);jQuery(t).addClass(r.join(" "))}}return t.prototype.writable=!1,t}.call(this),D=this.Maslosoft.Binder.MomentFormatter=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e,s,i){f(this,D),moment.locale(this.options.lang)}update(t,e,s,i){f(this,D),(e=this.getValue(e))?t.innerHTML=moment[this.options.sourceFormat](e).format(this.options.displayFormat):t.innerHTML=""}},this.Maslosoft.Binder.Picker=class extends this.Maslosoft.Binder.Base{},S=this.Maslosoft.Binder.Video=function(){var r,t;class e extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.isVideoUrl=this.isVideoUrl.bind(this),this.setThumb=this.setThumb.bind(this)}isVideoUrl(t){var e,s,i;for(f(this,S),s=0,i=r.length;s<i;s++)if((e=r[s]).match(t))return e;return!1}setThumb(t,e){var s,i;if(f(this,S),s=this.isVideoUrl(t))return i=function(t){return"img"===e.tagName.toLowerCase()?e.src=t:jQuery(e).css("background-image",`url('${t}')`)},console.log(t),(s=new s).setUrl(t),s.setThumb(i)}}return r=null,jQuery(document).ready(function(){return t=new Maslosoft.Playlist.Options,r=t.adapters}),e}.call(this),ut=this.Maslosoft.Binder.WidgetUrl=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.createUrl=this.createUrl.bind(this),this.setRel=this.setRel.bind(this)}getData(t,e,s,i){var e=this.getValue(e),r={};return r.id=s.get("widgetId")||e.id,s.get("widget")&&(r.id=s.get("widget").id),r[i]=s.get(i)||e[i],s=s.get("params"),r.params=s,r.params=this.getValue(r.params),"string"==typeof e&&(r[i]=e),r}createUrl(t,e,s,i){var r,n,o;if(f(this,ut),r=[],"string"==typeof s||"number"==typeof s)""===s&&"number"!=typeof s||r.push(""+s);else for(n in s)o=s[n],n=encodeURIComponent(""+n),o=encodeURIComponent(""+o),r.push(n+":"+o);return i=""+i+t+"."+e,0===r.length?i:i+"="+(r=r.join(",",r))}setRel(t){var e,s,i,r,n,o,a;if(f(this,ut),s=e=!1,a=[],n=t.getAttribute("rel"))for(i=0,r=(a=n.split(" ")).length;i<r;i++)"plain"===(o=a[i])&&(s=!0),"virtual"===o&&(e=!0);return e||s||a.push("virtual"),t.setAttribute("rel",a.join(" "))}},ct=this.Maslosoft.Binder.Acl=function(){class t extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(){if(f(this,ct),!Maslosoft.Binder.Acl.allow)throw new Error("Acl binding handler requires Maslosoft.Binder.Acl.allow to be function checking permissions");if("function"!=typeof Maslosoft.Binder.Acl.allow)throw new Error("Acl binding handler requires Maslosoft.Binder.Acl.allow to be function checking permissions")}update(t,e){var s;return f(this,ct),e=this.getValue(e),s=Maslosoft.Binder.Acl.allow(e),ko.bindingHandlers.visible.update(t,function(){return s})}}return t}.call(this),this.Maslosoft.Binder.Active=class extends this.Maslosoft.Binder.CssClass{constructor(t){super(new Maslosoft.Binder.CssOptions({className:"active"}))}},pt=this.Maslosoft.Binder.Asset=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e,s){var i,r,n,o,a;f(this,pt),t=$(t),a=s.get("w"),i=s.get("h"),r=s.get("p"),e=this.getValue(e),s=this.getValue(s),e.updateDate&&("number"==typeof(o=e.updateDate)&&(n=o),"number"==typeof o.sec)&&(n=o.sec),o=e.url,(e=[]).push(o),a&&e.push("w/"+a),i&&e.push("h/"+i),!1===r&&e.push("p/0"),n&&e.push(n),e=e.join("/"),t.attr("src")!==e&&(s.preloader&&t.attr("src",s.preloader),p(t,e))}},P=this.Maslosoft.Binder.CssClasses=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.getClassList=this.getClassList.bind(this),this.init=this.init.bind(this),this.update=this.update.bind(this)}getClassList(t){return f(this,P),null==(t=this.getValue(t))?"":("string"==typeof t?t:t.join(" ")).replace(/^\s*/,"").replace(/\s*$/,"")}init(t,e){return f(this,P),e=this.getClassList(e),t.setAttribute("data-css-classes",e)}update(t,e,s,i){var r;return f(this,P),r=t.getAttribute("data-css-classes"),ko.utils.toggleDomNodeCssClass(t,r,!1),(r=this.getClassList(e))&&ko.utils.toggleDomNodeCssClass(t,r,!0),t.setAttribute("data-css-classes",r)}},ft=this.Maslosoft.Binder.CssColumns=function(){class d extends this.Maslosoft.Binder.CssColumnsBase{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e){f(this,ft)}update(t,e,s,i){var r,n,o,a,l;for(o in f(this,ft),r=this.getValue(e),a={},n=d.columns)n[o],l=parseInt(r[o]),l=parseInt(12/l),a[o]=l;return this.applyColumns(t,a,d.columns)}}return d.columns={xs:"col-xs-{num}",sm:"col-sm-{num}",md:"col-md-{num}",lg:"col-lg-{num}"},d}.call(this),g=this.Maslosoft.Binder.CssColumnSizes=function(){class r extends this.Maslosoft.Binder.CssColumnsBase{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e){f(this,g)}update(t,e,s,i){return f(this,g),e=this.getValue(e),this.applyColumns(t,e,r.columns)}}return r.columns={xs:"col-xs-{num}",sm:"col-sm-{num}",md:"col-md-{num}",lg:"col-lg-{num}"},r}.call(this),this.Maslosoft.Binder.Data=class extends this.Maslosoft.Binder.Base{getNamespacedHandler(i){return{update:(t,e)=>{var s,e=this.getValue(e);return"string"!=(s=typeof e)&&"number"!=s&&(e=JSON.stringify(e)),t.setAttribute("data-"+i,e)}}}},_=this.Maslosoft.Binder.DataModel=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e,s){var i,r,n,o,a,l,d;if(f(this,_),a=this.getValue(e),null!==(r=s.get("fields")||null)){for(l={},d=[],n=0,o=r.length;n<o;n++)void 0===a[i=r[n]]?wt(`Model field \`${i}\` is undefined on element:`,t):l[i]=a[i],d.push(this.bindModel(t,l));return d}this.bindModel(t,a)}bindModel(t,e){var s,i;return"string"!=(i=typeof value)&&"number"!=i&&(s=JSON.stringify(e)),t.setAttribute("data-model",s)}},this.Maslosoft.Binder.DateFormatter=class extends this.Maslosoft.Binder.MomentFormatter{constructor(t){super(new Maslosoft.Binder.DateOptions(t))}},m=this.Maslosoft.Binder.DatePicker=class extends this.Maslosoft.Binder.Picker{constructor(t){super(new Maslosoft.Binder.DateOptions(t)),this.updateModel=this.updateModel.bind(this),this.getDisplayValue=this.getDisplayValue.bind(this),this.getModelValue=this.getModelValue.bind(this),this.init=this.init.bind(this),this.update=this.update.bind(this)}getData(t){return t?(t=this.getValue(t)||[]).data?t.data:t:""}getOptions(t){var e,s,i={lang:this.options.lang,sourceFormat:this.options.sourceFormat,displayFormat:this.options.displayFormat,format:this.options.displayFormat.toLowerCase(),forceParse:!1,todayHighlight:!0,showOnFocus:!1},r=t.get("dateOptions")||[];if(r)for(e in r)s=r[e],"data"!==e&&"template"!==e&&("format"===e&&(i.displayFormat=s.toUpperCase()),i[e]=s);return i}updateModel(t,e,s){var i,r;if(f(this,m),r=this.getOptions(s),i=this.getData(e),t=this.getModelValue(t.value,r),r=e(),i!==t)return r&&r.data?ko.expressionRewriting.writeValueToProperty(ko.unwrap(e()).data,s,"datePicker.data",t):ko.expressionRewriting.writeValueToProperty(e(),s,"datePicker",t)}getDisplayValue(t,e){return f(this,m),!t||t&&0===t.length?"":("unix"===e.sourceFormat?moment.unix(t):moment(t,e.sourceFormat)).format(e.displayFormat)}getModelValue(t,e){return f(this,m),t?"unix"===e.sourceFormat?moment(t,e.displayFormat).unix():moment(t,e.displayFormat).format(e.sourceFormat):null}init(s,i,r,t){var n,e,o,a,l,d,h;f(this,m),l=this.getOptions(r),h=this.getDisplayValue(this.getData(i),l),s.value=h||"",n=jQuery(s),d=l.template||`<div class="input-group-addon">
	<a class="picker-trigger-link" style="cursor: pointer;">
		<i class="glyphicon glyphicon-calendar"></i>
	</a>
</div>`,(d=jQuery(d)).insertBefore(n),d=d.find("a.picker-trigger-link"),n.datepicker(l),a=t=>((h=n.datepicker("getDate"))&&this.updateModel(s,i,r),!1),o=t=>{var e=Date.parse(s.value);return!(!e||t.isTrigger||(s.value=this.getDisplayValue(Math.round(e.getTime()/1e3),l),this.updateModel(s,i,r),n.datepicker("update"),0))},n.on("changeDate",t=>(a(),!0)),n.on("change",o),n.on("blur",o),e=!1,n.on("show",t=>e=!0),n.on("hide",t=>e=!1),d.on("mousedown",function(t){e?n.datepicker("hide"):n.datepicker("show"),t.stopPropagation(),t.preventDefault()})}update(t,e,s){var i;if(f(this,m),(i=e())&&i.data?ko.utils.setTextContent(t,i.data):ko.utils.setTextContent(t,i),i=this.getOptions(s),s=this.getDisplayValue(this.getData(e),i),t.value!==s)return t.value=s}},this.Maslosoft.Binder.DateTimeFormatter=class extends this.Maslosoft.Binder.MomentFormatter{constructor(t){super(new Maslosoft.Binder.DateTimeOptions(t))}},v=this.Maslosoft.Binder.DecimalFormatter=function(){class t extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e,s,i){f(this,v)}update(t,e,s,i){var r,n,o,a,l,d;for(f(this,v),e=this.getValue(e)||0,e=parseFloat(e),n={},o=0,a=(d=["precision","decimalSeparator","thousandSeparator","suffix","prefix"]).length;o<a;o++)n[l=d[o]]=this[l],void 0!==(r=s.get(l))&&(n[l]=this.getValue(r));return e=c(e,n.precision,3,n.thousandSeparator,n.decimalSeparator),t.innerHTML=n.prefix+e+n.suffix}}return t.prototype.precision=2,t.prototype.decimalSeparator=",",t.prototype.thousandSeparator=" ",t.prototype.suffix="",t.prototype.prefix="",t}.call(this),this.Maslosoft.Binder.Disabled=class extends this.Maslosoft.Binder.CssClass{constructor(t){super(new Maslosoft.Binder.CssOptions({className:"disabled"}))}},Y=this.Maslosoft.Binder.EnumCssClassFormatter=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e,s,i){var r,n,o,a;for(f(this,Y),r=0,n=(a=(e=this.getValue(e)).values).length;r<n;r++)o=a[r],o=new RegExp(`(?:^|\\s)${o}(?!\\S)`,"g"),t.className=t.className.replace(o,"");t.className+=" "+e.values[e.data]}},J=this.Maslosoft.Binder.EnumFormatter=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e,s,i){f(this,J),void 0!==(e=this.getValue(e)).values[e.data]?t.innerHTML=e.values[e.data]:t.innerHTML=e.data}},s=this.Maslosoft.Binder.Eval=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e){return f(this,s),e=this.getValue(e),console.log(e),{controlsDescendantBindings:!e}}update(t,e){return f(this,s),e=this.getValue(e),console.log(e),{controlsDescendantBindings:!e}}},y=this.Maslosoft.Binder.Fancytree=function(){class t extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.handle=this.handle.bind(this),this.update=this.update.bind(this)}getData(t){t=this.getValue(t)||[];return t.data||t}init(t,e,s,i){var r,n,o,a,l;if(f(this,y),a=this.getData(e),o=e().options||{},l=this.getValue(e).on||!1,o.toggleEffect=!1,o.source=a.children,o.extensions=[],l=new Q(a,l,o),r=e().dnd||!1,n=e().drag||!1,r&&n)throw new Error("Cannot use both `dnd` and `drag`");return r&&(o.autoScroll=!1,o.extensions.push("dnd"),o.dnd=new R(a,t,l)),n&&(o.autoScroll=!1,o.extensions.push("dnd"),o.dnd=new L(a,t)),r=e().nodeIcon||!1,l=e().folderIcon||!1,n=e().nodeRenderer||!1,l&&!r&&wt("Option `folderIcon` require also `nodeIcon` or it will not work at all"),(r||n)&&(r&&(o.icon=!1),e=new I(a,o,r,l),n&&e.setRenderer(new n(a,o)),o.renderNode=e.render),jQuery(t).fancytree(o)}handle(t,e,s){var i;return f(this,y),i=this.getValue(e),t=jQuery(t),setTimeout(()=>{if(t.find(".ui-fancytree").length)return t.fancytree("option","source",this.getData(e).children),i.autoExpand&&t.fancytree("getRootNode").visit(function(t){return t.setExpanded(!0)}),t.focus()},0)}update(t,e,s,i){return f(this,y),this.handle(t,e,s)}}return t.prototype.tree=null,t.prototype.element=null,t}.call(this),b=this.Maslosoft.Binder.FileSizeFormatter=function(){class t extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e,s,i){f(this,b)}update(t,e,s,i){var r,n,o;return f(this,b),e=this.getValue(e)||0,r=this.binary,n=!this.binary,r&&(o=1024),n&&(o=1e3),t.innerHTML=(t=>{var e,s;if((t=parseInt(t))<o)return t+" B";for(e=-1,r&&(s=this.units.binary),n&&(s=this.units.decimal);;)if(e++,!(o<(t/=o)))break;return s[e]?Math.max(t,.1).toFixed(1)+" "+s[e]:Math.max(t,.1).toFixed(1)+` ~*${e*o} * ${o} B`})(e)}}return t.prototype.units={binary:["kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimal:["kB","MB","GB","TB","PB","EB","ZB","YB"]},t.prototype.binary=!0,t}.call(this),M=this.Maslosoft.Binder.GoogleMap=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this),this.apply=this.apply.bind(this)}init(t,e,s,i){return f(this,M),this.apply(t,this.getValue(e))}update(t,e,s,i){return f(this,M),this.apply(t,this.getValue(e))}apply(t,e){var s,i;if(f(this,M),console.log(t,e),s=new google.maps.LatLng(e.lat,e.lng),i={zoom:e.zoom,center:s,mapTypeId:e.type},t=new google.maps.Map(t,i),e.markers)return new google.maps.Marker({position:s,map:t})}},Z=this.Maslosoft.Binder.Hidden=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e){var s;return f(this,Z),s=!this.getValue(e),ko.bindingHandlers.visible.update(t,function(){return s})}},B=this.Maslosoft.Binder.Href=function(){var i;class t extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e,s){if(f(this,B),e=this.getValue(e),!t.href&&e&&n(t,"href"),i(t),s.get("stopPropagation")||!1)return ko.utils.registerEventHandler(t,"click",function(t){return t.stopPropagation()})}update(t,e,s){return f(this,B),i(t),(e=this.getValue(e))?(s=s.get("target")||"",n(t,"href"),n(t,"target"),t.getAttribute("href")!==e&&t.setAttribute("href",e),t.getAttribute("target")!==s?t.setAttribute("target",s):void 0):t.removeAttribute("href")}}return i=function(n){if("a"===n.tagName.toLowerCase())return setTimeout(function(){for(var t,e=jQuery(n).find("a"),s=[],i=0,r=e.length;i<r;i++)t=e[i],t=jQuery(t),s.push(t.replaceWith(t.contents()));return s},0)},t}.call(this),X=this.Maslosoft.Binder.Html=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}init(t,e,s,i){return{controlsDescendantBindings:!0}}update(t,e,s,i){var r;return f(this,X),e=this.getValue(e),s=this.getValue(s).plugins,(r=new l(t)).from(s),e=r.getElementValue(t,e),ko.utils.setHtml(t,e)}},tt=this.Maslosoft.Binder.HtmlTree=class kt extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}static drawNode(t){var e,s,i,r,n,o=document.createElement("li");if(o.innerHTML=t.title,t.children&&0<t.children.length){for(e=document.createElement("ul"),s=0,i=(n=t.children).length;s<i;s++)r=n[s],r=kt.drawNode(r),e.appendChild(r);o.appendChild(e)}return o}getData(t){t=this.getValue(t)||[];return t.data?this.getValue(t.data)||[]:t}update(e,t,s,i){var r;return f(this,tt),r=this.getValue(t),wt("HtmlTree is experimental, do not use"),setTimeout(()=>{var t=kt.drawNode(r);return e.innerHTML="",e.appendChild(t)},0)}},w=this.Maslosoft.Binder.HtmlValue=function(){var o;class t extends this.Maslosoft.Binder.Base{constructor(t={}){super(t),this.init=this.init.bind(this),this.update=this.update.bind(this),ko.bindingHandlers.sortable&&ko.bindingHandlers.sortable.options&&(ko.bindingHandlers.sortable.options.cancel=":input,button,[contenteditable]")}getElementValue(t){return t.innerHTML}setElementValue(t,e){return t.innerHTML=e}init(i,r,t){var e,s,n;f(this,w),i.setAttribute("contenteditable",!0),i.id||(i.id="maslosoft-binder-htmlvalue-"+o++),t=this.getValue(t).plugins,(n=new l(i)).from(t),s=()=>{var t,e,s;if(i=i&&document.getElementById(i.id))return t=r(),s=this.getValue(r),e=this.getElementValue(i),ko.isWriteableObservable(t)&&s!==(e=n.getModelValue(i,e))?t(e):void 0},e=()=>setTimeout(s,0),jQuery(i).on("keyup, input",s),jQuery(document).on("mouseup",e),jQuery(document).on("changed.htmlvalue",s),ko.utils.domNodeDisposal.addDisposeCallback(i,function(t){return jQuery(t).off("keyup, input",s),jQuery(document).off("mouseup",e),jQuery(document).off("changed.htmlvalue",s)})}update(t,e,s){var i;f(this,w),e=this.getValue(e),s=this.getValue(s).plugins,(i=new l(t)).from(s),e=i.getElementValue(t,e),this.getElementValue(t)!==e&&this.setElementValue(t,e)}}return o=0,t}.call(this),et=this.Maslosoft.Binder.Icon=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e,s){var i,r,n,o,a,l,d;f(this,et),i=$(t),e=this.getValue(e),r=this.getValue(s),d=s.get("iconField")||"icon",e?(o=!1,(d=e[d]).match(/\.(svg)$/)&&(o=!0),a="",d.match(/\.(jpg|jped|gif|png|svg)$/)&&(a=d.match(/[^\/]*?\.(jpg|jped|gif|png|svg)$/)[0],d=d.replace(/[^\/]*?\.(jpg|jped|gif|png|svg)$/,"")),!a&&e.filename&&(a=e.filename),l=void 0===e.iconSize?16:e.iconSize,s=s.get("iconSize")||l,l=new RegExp("/"+l+"/","g"),n=void 0===e.isImage||e.isImage,(n=o?!1:n)?(d.match(new RegExp("/$"))||(d+="/"),d.match(new RegExp("/w/","g"))?d=d.replace(l,"/"+s+"/"):d+=`w/${s}/h/${s}/p/0/`,e.updateDate&&(o=null,"number"==typeof(o=e.updateDate.sec||e.updateDate)&&(d+=o),"string"==typeof o)&&(d+=o)):((n=16)<s&&(n=32),32<s&&(n=48),d=d.replace(l,"/"+(n=48<s?512:n)+"/")),d.match(/\/$/)?d+=a:d=d+"/"+a,r.cachebusting&&(d=d+"?"+(new Date).getTime()),i.attr("src")!==d&&(r.preloader&&i.attr("src",r.preloader),p(i,d)),i.css({width:s+"px",height:"auto",maxWidth:"100%"})):console&&(console.warn("Binding value for `icon` binding not defined, skipping. Element:"),console.warn(t),console.warn((new Error).stack))}},k=this.Maslosoft.Binder.Id=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t){return f(this,k),n(t,"id")}update(t,e){if(f(this,k),e=this.getValue(e),t.getAttribute("id")!==e)return t.setAttribute("id",e)}},V=this.Maslosoft.Binder.Log=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this),this.init=this.init.bind(this)}update(t,e,s){return f(this,V),console.log(this.getValue(e),t)}init(t,e,s,i){return f(this,V),console.log(this.getValue(e),t)}},C=this.Maslosoft.Binder.PickaDate=class extends this.Maslosoft.Binder.Picker{constructor(t){super(new Maslosoft.Binder.DateOptions(t)),this.updateModel=this.updateModel.bind(this),this.getDisplayValue=this.getDisplayValue.bind(this),this.getModelValue=this.getModelValue.bind(this),this.init=this.init.bind(this),this.update=this.update.bind(this)}updateModel(t,e,s){var i;if(f(this,C),i=this.getValue(e),t=this.getModelValue(t.value),ko.isWriteableObservable(e),i!==t)return ko.expressionRewriting.writeValueToProperty(e(),s,"datePicker",t),t}getDisplayValue(t){return f(this,C),("unix"===this.options.sourceFormat?moment.unix(t):moment(t,this.options.sourceFormat)).format(this.options.displayFormat)}getModelValue(t){return f(this,C),"unix"===this.options.sourceFormat?moment(t,this.options.displayFormat).unix():moment(t,this.options.displayFormat).format(this.options.sourceFormat)}init(e,s,i,t){var r,n,o,a,l;f(this,C),a=this.getDisplayValue(this.getValue(s)),(l=jQuery(e)).val(a),a=this.options.template||`<div class="input-group-addon">
	<a class="picker-trigger-link" style="cursor: pointer;">
		<i class="glyphicon glyphicon-calendar"></i>
	</a>
</div>`,(a=jQuery(a)).insertAfter(l),a=a.find("a.picker-trigger-link"),n={format:this.options.displayFormat.toLowerCase(),selectMonths:!0,selectYears:!0},n=a.pickadate(n),(o=n.pickadate("picker")).on("set",()=>{l.val(o.get("value")),this.updateModel(e,s,i)}),(r={}).change=()=>{var t=Date.parse(e.value);t&&(o.set("select",[t.getFullYear(),t.getMonth(),t.getDate()]),this.updateModel(e,s,i))},r.keyup=function(t){86===t.which&&t.ctrlKey&&r.change()},r.mouseup=r.change,r.focus=()=>{o.open(!1)},r.blur=t=>{t.relatedTarget||(o.close(),this.updateModel(e,s,i))},l.on(r),a.on("click",function(t){var e=jQuery(o.$root[0]);0<jQuery(e.children()[0]).height()?o.close():o.open(!1),t.stopPropagation(),t.preventDefault()})}update(t,e){if(f(this,C),ko.utils.setTextContent(t,e()),e=this.getDisplayValue(this.getValue(e)),t.value!==e)return t.value=e}},T=this.Maslosoft.Binder.Placeholder=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t){return f(this,T),n(t,"placeholder")}update(t,e){if(f(this,T),e=this.getValue(e),t.getAttribute("placeholder")!==e)return e=$("<div/>").html(e).text(),t.setAttribute("placeholder",e)}},E=this.Maslosoft.Binder.Select2=function(){var d,e,h;class t extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(){var t;return f(this,E),t=arguments,setTimeout(function(){return e.apply(null,t)},0)}update(t,e,s){f(this,E)}}return d="select2Data",h=function(t,e){var s=ko.isObservable(e),i=void 0;s&&(i=e.equalityComparer,e.equalityComparer=function(){return!0}),$(t).trigger("change"),s&&(e.equalityComparer=i)},e=function(e,t,s,i,r){var t=ko.unwrap(t()),n=s(),o=!1,a=null,l=null;$(e).on("select2:selecting select2:unselecting",function(){o=!0}),$(e).on("select2:select select2:unselect",function(){o=!1}),ko.isObservable(n.value)?l=n.value.subscribe(function(t){o||h(e,this._target||this.target)}):ko.isObservable(n.selectedOptions)&&(l=n.selectedOptions.subscribe(function(t){o||h(e,this._target||this.target)})),ko.isWriteableObservable(n[d])&&(a=function(){$(e).data("select2")&&n[d]($(e).select2("data"))},$(e).on("change",a)),$(e).select2(t),n.selectedOptions&&$(e).val(n.selectedOptions).trigger("change"),ko.utils.domNodeDisposal.addDisposeCallback(e,function(){$(e).select2("destroy"),null!==a&&$(e).off("change",a),null!==l&&l.dispose()})},t}.call(this),this.Maslosoft.Binder.Selected=class extends this.Maslosoft.Binder.CssClass{constructor(t){super(new Maslosoft.Binder.CssOptions({className:"selected"}))}},F=this.Maslosoft.Binder.Src=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t){return f(this,F),n(t,"src")}update(t,e){if(f(this,F),e=this.getValue(e),t.getAttribute("src")!==e)return t.setAttribute("src",e)}},j=this.Maslosoft.Binder.Tags=function(){var c,p;class t extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.setTags=this.setTags.bind(this),this.init=this.init.bind(this),this.update=this.update.bind(this)}setTags(t,e){var s,i,r,n,o,a,l;for(f(this,j),(o=t.find("option")).length&&o.remove(),a=[],s=i=0,r=e.length;i<r;s=++i)l=e[s],(n=jQuery("<option selected='true'></option>")).val(l),n.text(l),a.push(t.append(n));return a}init(t,e,s,i,r){var n,o,a,l,d,h,u;if(f(this,j),"select"!==t.tagName.toLowerCase())throw new Error("Tags binding must be placed on `select` element");return p&&(jQuery(c).appendTo("head"),p=!1),o=this.getValue(e),u=o.data||o,e=JSON.parse(JSON.stringify(u)),(l=jQuery(t)).data("tags",!0),l.attr("multiple",!0),this.setTags(l,e),n={placeholder:o.placeholder,tags:!0,tokenSeparators:[","," "]},h=function(){var t;if(o.inputCss)return(t=l.parent().find(".select2-search__field")).addClass(o.inputCss),t.attr("placeholder",o.placeholder)},o.tagCss&&(n.templateSelection=function(t,e){return e.removeClass("select2-selection__choice"),e.addClass(o.tagCss),t.selected,jQuery(`<span>${t.text}</span>`)}),d=()=>{var t,e,s,i,r;if(u.removeAll?u.removeAll():u=[],t=l.val())for(e=s=0,i=t.length;s<i;e=++s)(r=(r=t[e]).replace(",","").replace(" ","").trim())&&u.push(r);return h()},a=t=>{if(jQuery(t.target).data())return jQuery("body").toggleClass("kill-all-select2-dropdowns","select2:opening"===t.type)},setTimeout(()=>(l.select2(n),h(),l.on("change",d),l.on("select2:select select2:unselect",d),l.on("select2:opening select2:close",a),ko.utils.domNodeDisposal.addDisposeCallback(t,()=>{if(l.select2("destroy"),null!==d)return l.off("change",d),l.off("select2:select select2:unselect",d)})),0)}update(t,e,s){var i,r,n;return f(this,j),e=this.getValue(e),n=e.data||e,i=JSON.parse(JSON.stringify(n)),r=jQuery(t),setTimeout(()=>{var t=null===r.val()?"":r.val().join(",").replace(/(,+)/g,",").replace(/(\s+)/g," ");if(t!==n.join(","))return this.setTags(r,i)},0)}}return c=`<style>
	body.kill-all-select2-dropdowns .select2-dropdown {
		display: none !important;
	}
	body.kill-all-select2-dropdowns .select2-container--default.select2-container--open.select2-container--below .select2-selection--single, .select2-container--default.select2-container--open.select2-container--below .select2-selection--multiple
	{
		border-bottom-left-radius: 4px;
		border-bottom-right-radius: 4px;
	}
	.select2-container--default.select2-container--focus .select2-selection--multiple {
		border-color: #66afe9;
		outline: 0;
		-webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102,175,233,.6);
		box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102,175,233,.6);
	}
</style>`,p=!0,t}.call(this),st=this.Maslosoft.Binder.Text=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}init(t,e,s,i){return{controlsDescendantBindings:!0}}update(t,e,s,i){var r;return f(this,st),e=d(this.getValue(e)),s=this.getValue(s).plugins,(r=new l(t)).from(s),e=r.getElementValue(t,e),ko.utils.setHtml(t,e)}},it=this.Maslosoft.Binder.TextToBg=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}init(t,e,s,i){}update(t,e,s,i){return f(this,it),e=this.getValue(e),jQuery(t).css("background-color",mt(e))}},this.Maslosoft.Binder.TextValue=class extends this.Maslosoft.Binder.HtmlValue{getElementValue(t){return t.textContent||t.innerText||""}setElementValue(t,e){if(void 0!==t.textContent&&(t.textContent=e),void 0!==t.innerText)return t.innerText=e}},this.Maslosoft.Binder.TextValueHLJS=class extends this.Maslosoft.Binder.HtmlValue{getElementValue(t){return t.textContent||t.innerText||""}setElementValue(t,e){if(void 0!==t.textContent&&(t.textContent=e,hljs)&&hljs.highlightBlock(t),void 0!==t.innerText&&(t.innerText=e,hljs))return hljs.highlightBlock(t)}},rt=this.Maslosoft.Binder.TimeAgoFormatter=class extends this.Maslosoft.Binder.MomentFormatter{constructor(t){super(new Maslosoft.Binder.TimeAgoOptions(t)),this.update=this.update.bind(this)}update(t,e){f(this,rt),e=this.getValue(e),t.innerHTML=moment[this.options.sourceFormat](e).fromNow()}},this.Maslosoft.Binder.TimeFormatter=class extends this.Maslosoft.Binder.MomentFormatter{constructor(t){super(new Maslosoft.Binder.TimeOptions(t))}},this.Maslosoft.Binder.TimePicker=class extends this.Maslosoft.Binder.Base{},nt=this.Maslosoft.Binder.Tooltip=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e){f(this,nt),e=this.getValue(e),$(t).attr("title",e),$(t).attr("data-original-title",e),$(t).attr("rel","tooltip")}},ot=this.Maslosoft.Binder.Tree=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e){f(this,ot)}},O=this.Maslosoft.Binder.TreeGrid=function(){var h;class t extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e,s,i,r){var n,o,a,l,d;return f(this,O),l=this.getValue(e),n=l.activeClass,a=jQuery(t),(d=new Maslosoft.Binder.Widgets.TreeGrid.TreeGridView(t,e)).init(),n&&(o=function(t){return a.find("tr").removeClass(n),jQuery(t.currentTarget).addClass(n),!0},a.on("click","tr",o),ko.utils.domNodeDisposal.addDisposeCallback(t,function(t){return d.dispose(),jQuery(t).off("click","tr",o)})),ko.bindingHandlers.template.init(t,h(t,e,r,d),s,i,r),{controlsDescendantBindings:!0}}update(t,e,s,i,r){var n;return f(this,O),n=new Maslosoft.Binder.Widgets.TreeGrid.TreeGridView(t,e,"update"),ko.bindingHandlers.template.update(t,h(t,e,r,n),s,i,r)}}return h=function(t,s,i,r){return function(){var a,l,d,h,t=s(),e=ko.utils.peekObservable(t);return e&&"number"!=typeof e.length?(a=ko.observableArray([]),d=ko.observableArray([]),l=-1,h=function(t){var e,s,i,r,n,o;for(l++,o=[],r=0,n=t.length;r<n;r++)s=(i=t[r]).children&&i.children.length&&0<i.children.length,e={depth:l,hasChilds:s},i._treeGrid=ko.tracker.factory(e),a.push(i),d.push(l),s?(h(i.children),o.push(l--)):o.push(void 0);return o},e.data.children?h(e.data.children):h(e.data),i&&(i.tree=e.data,i.data=a,i.widget=r),ko.utils.unwrapObservable(t),{foreach:a,depths:d,as:e.as,includeDestroyed:e.includeDestroyed,afterAdd:e.afterAdd,beforeRemove:e.beforeRemove,afterRender:e.afterRender,beforeMove:e.beforeMove,afterMove:e.afterMove,templateEngine:ko.nativeTemplateEngine.instance}):{foreach:t,templateEngine:ko.nativeTemplateEngine.instance}}},t}.call(this),A=this.Maslosoft.Binder.TreeGridNode=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e,s,i,r){f(this,A)}update(t,e,s,i,r){var n,o,a,l;return f(this,A),ko.utils.toggleDomNodeCssClass(t,"tree-grid-drag-handle",!0),a=[],e=this.getValue(e)._treeGrid,l=(r=r.widget.config).nodeIcon,o=r.folderIcon,r=r.expanderIcon||"<i class='glyphicon glyphicon-triangle-bottom'></i>",o&&e.hasChilds&&(l=o),o=e.depth,(n=[]).push(`<div class='collapsed' style='display:none;transform: rotate(-90deg);'>${r}</div>`),n.push(`<div class='expanded' style='display:none;transform: rotate(-45deg);'>${r}</div>`),a.push(`<a class='expander' style='cursor:pointer;text-decoration:none;width:1em;margin-left:${o}em;display:inline-block;'>${n.join("")}</a>`),o=e.depth+1,a.push(`<i class='no-expander' style='margin-left:${o}em;display:inline-block;'></i>`),a.push(`<img src='${l}' style='width: 1em;height:1em;margin-top: -.3em;display: inline-block;'/>`),t.innerHTML=a.join("")+t.innerHTML}},H=this.Maslosoft.Binder.Validator=function(){var a;class t extends this.Maslosoft.Binder.Base{constructor(t){super(new Maslosoft.Binder.ValidatorOptions),this.init=this.init.bind(this),this.update=this.update.bind(this)}getElementValue(t){return"input"===t.tagName.toLowerCase()||"textarea"===t.tagName.toLowerCase()?t.value:t.textContent||t.innerText||""}init(s,t,e,i){var r,n,o;return f(this,H),t=this.getValue(t),o=this.options.classField,o=new l(s,o).from(t),(n=new G(o,this.options)).init(s),s.id||(s.id="Maslosoft-Ko-Binder-Validator-"+a++),r=this.getElementValue(s),t=t=>{var e;if(s=s&&document.getElementById(s.id))return e=this.getElementValue(s),r!==e?(r=e,n.validate(s,e)):void 0},ko.utils.registerEventHandler(s,"keyup, input",t),ko.utils.registerEventHandler(document,"mouseup",t)}update(t,e,s){f(this,H)}}return a=0,t}.call(this),N=this.Maslosoft.Binder.VideoPlaylist=function(){class t extends this.Maslosoft.Binder.Video{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}getData(t){t=this.getValue(t)||[];return t.data||t}init(t,e,s,i){f(this,N)}update(t,e,s,i){var r,n,o,a,l,d,h,u;for(f(this,N),r=this.getData(e),h=(e=this.getValue(e||{})).urlField||"url",l=e.urlField||"title",n=[],o=0,a=r.length;o<a;o++)d=(u=r[o])[h],u=u[l],this.isVideoUrl(d)&&n.push(`<a href='${d}'>${u}</a>`);return t.innerHTML=n.join("\n"),n.length?(ko.utils.toggleDomNodeCssClass(t,"maslosoft-playlist",!0),new Maslosoft.Playlist(t)):ko.utils.toggleDomNodeCssClass(t,"maslosoft-playlist",!1)}}return t.prototype.initVideos=null,t}.call(this),at=this.Maslosoft.Binder.VideoThumb=class extends this.Maslosoft.Binder.Video{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e,s,i){f(this,at)}update(t,e){return f(this,at),e=this.getValue(e),this.setThumb(e,t)}},lt=this.Maslosoft.Binder.Widget=class extends this.Maslosoft.Binder.Base{constructor(){super(...arguments),this.init=this.init.bind(this),this.update=this.update.bind(this)}init(t,e,s,i){var r,n,o,a,l;if(f(this,lt),e=this.getValue(e),"string"!=typeof(o=s.get("ref"))&&o)"object"==typeof o&&(l=o);else{if("function"!=typeof e)return;if("function"!=typeof e.constructor)return;try{l=new e}catch(t){return void 0}o&&gt(o,l),o=o&&l}if(n=s.get("params"))for(r in n)a=n[r],l[r]=a;if("function"==typeof l.init&&l.init(t),"function"==typeof l.dispose)return ko.utils.domNodeDisposal.addDisposeCallback(t,l.dispose)}update(t,e){f(this,lt)}},dt=this.Maslosoft.Binder.WidgetAction=class extends this.Maslosoft.Binder.WidgetUrl{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e,s){return f(this,dt),e=this.getData(t,e,s,"action"),s=this.createUrl(e.id,e.action,e.params,"?"),t.setAttribute("href",s),this.setRel(t)}},ht=this.Maslosoft.Binder.WidgetActivity=class extends this.Maslosoft.Binder.WidgetUrl{constructor(){super(...arguments),this.update=this.update.bind(this)}update(t,e,s){return f(this,ht),e=this.getData(t,e,s,"activity"),s=this.createUrl(e.id,e.activity,e.params,"#"),t.setAttribute("href",s),this.setRel(t)}},l=function(){class t{constructor(t=null,e="_class"){this.getElementValue=this.getElementValue.bind(this),this.getModelValue=this.getModelValue.bind(this),this.element=t,this.classField=e,this.plugins=new Array}from(t){var e,s,i,r,n,o,a,l,d=this.element,h=this.classField;if(this.plugins=new Array,!(t=ko.isObservable(t)?ko.unwrap(t):t))return this.plugins;for(n=0,o=(e=t.constructor===Array?t:[t]).length;n<o;n++)if((i=e[n])[h]){if("function"==typeof i[h]){for(r in s=i[h],delete i[h],a=new s,i)l=i[r],a[r]=null,a[r]=l;return this.plugins.push(a),this.plugins}xt(`Parameter \`${h}\` must be plugin compatible class, binding defined on element:`,d)}else xt(`Parameter \`${h}\` must be defined for plugin on element:`,d)}getElementValue(t,e){for(var s,i=this.plugins,r=0,n=i.length;r<n;r++)"function"==typeof(s=i[r]).getElementValue&&(e=s.getElementValue(t,e));return e}getModelValue(t,e){for(var s,i=this.plugins,r=0,n=i.length;r<n;r++)"function"==typeof(s=i[r]).getModelValue&&(e=s.getModelValue(t,e));return e}}return t.prototype.classField="_class",t.prototype.element=null,t.prototype.plugins=null,t}.call(this),R=function(){class t{constructor(t,e,s,i){this.dragEnd=this.dragEnd.bind(this),this.dragDrop=this.dragDrop.bind(this),this.events=s,this.draggable={},this.draggable.scroll=!1,this.tree={},this.tree=t,this.finder=new a(this.tree),this.el=jQuery(e)}dragStart(t,e){return!0}dragEnter(t,e){return!0}dragEnd(t,e){return W("drag end..."),!0}dragDrop(t,e){var s,i,r,n,o=e.hitMode,a=e.draggable.element[0];return this.events.drop(t,e),e.otherNode?(n=this.finder.find(e.otherNode.parent.data.id),s=this.events.getNode(this.finder.find(e.otherNode.data.id)),this.el.is(a)||(W("From other instance..."),e=ko.dataFor(a),W(e),setTimeout(i,0))):(e=ko.contextFor(a),s=this.events.getNode(e.$data)),a=this.finder.find(t.data.id),e=this.finder.find(t.parent.data.id),n&&n.children.remove(s),this.tree.children.remove(s),e&&e.children.remove(s),"over"===o&&a.children.push(s),"before"===o&&(e?(r=e.children.indexOf(a),e):(r=this.tree.children.indexOf(a),this.tree)).children.splice(r,0,s),"after"===o&&(e||this.tree).children.push(s),i=t=>(W(t),this.el.fancytree("option","source",this.tree.children),this.el.fancytree("getRootNode").visit(function(t){return t.setExpanded(!0)}),this.el.focus(),W("update tree..",this.el)),setTimeout(i,0),!0}}return t.prototype.autoExpandMS=400,t.prototype.focusOnClick=!1,t.prototype.preventVoidMoves=!0,t.prototype.preventRecursiveMoves=!0,t.prototype.tree=null,t.prototype.finder=null,t.prototype.draggable=null,t.prototype.events=null,t.el=null,t}.call(this),L=function(){class t{constructor(t,e,s,i){this.dragEnd=this.dragEnd.bind(this),this.dragDrop=this.dragDrop.bind(this),this.draggable={},this.draggable.scroll=!1,this.tree={},this.tree=t,this.finder=new a(this.tree),this.el=jQuery(e)}dragStart(t,e){return!0}dragEnter(t,e){return!1}dragEnd(t,e){return W("drag end..."),!0}dragDrop(t,e){return!1}}return t.prototype.focusOnClick=!1,t.prototype.tree=null,t.prototype.finder=null,t.prototype.draggable=null,t.el=null,t}.call(this),Q=function(){var r,n,o;class t{constructor(t,e,s){this.drop=this.drop.bind(this),this.getNode=this.getNode.bind(this),this.handle=this.handle.bind(this),this.events=e,this.options=s,n=new a(t),this.handle("click"),this.handle("dblclick"),this.handle("activate"),this.handle("deactivate")}drop(t,e){if(W("Drop..."),W(this.events),this.events.drop)return this.dropEvent=new this.events.drop(t,e),W(this.dropEvent)}getNode(t){return W("Tree event drop..."),W(this.dropEvent),this.dropEvent&&this.dropEvent.getNode?this.dropEvent.getNode(t):t}handle(i){if(this.events[i])return this.options[i]=(t,e)=>{var s;if(r(e))return s=n.find(e.node.data.id),this.events[i](s,e,t),o(t)}}}return t.prototype.events=null,t.prototype.dropEvent=null,n=t.prototype.options=null,r=function(t){return void 0===t.targetType||"title"===t.targetType||"icon"===t.targetType||void 0},o=function(t){return t.stopPropagation()},t}.call(this),t=function(){var s;return s={},class{constructor(){}get(t){return void 0!==s[t]&&s[t]}set(t,e){return s[t]=e}}}.call(this),a=function(){var a,l,r;return a=new t,r=[],l=function(t,e){var s,i,r,n,o;if(void 0!==e){if(s=a.get(e))return s;if(t.id===e)return t;if(t._id===e)return t;if(t.children&&0<t.children.length)for(r=0,n=(o=t.children).length;r<n;r++)if(i=o[r],!1!==(i=l(i,e)))return a.set(e,i),i}return!1},class{constructor(t){r.push(t)}find(t){for(var e,s=0,i=r.length;s<i;s++)if(e=r[s],e=l(e,t))return e;return!1}}}.call(this),I=function(){var o;class t{constructor(t,e,s,i){this.render=this.render.bind(this),this.icon=s,this.folderIcon=i,o=new a(t)}setRenderer(t){if(this.renderer=t,"function"!=typeof this.renderer.render)return console.error("Renderer must have function `render`")}render(t,e){var s,i,r,n=e.node;for(s in e)if(e[s],"originalEvent"===s)return;if(r=jQuery(n.span).find("> span.fancytree-title"),this.renderer&&this.renderer.render&&(i=o.find(n.data.id),this.renderer.render(i,r)),this.icon||this.folderIcon)return i=r.html(),n=this.folderIcon&&n.children&&n.children.length?this.folderIcon:this.icon,r.html(`<i class='node-title-icon' style='background-image:url(${n})'></i> `+i)}}return t.prototype.icon="",t.prototype.folderIcon="",o=t.prototype.renderer=null,t}.call(this),G=function(){var l,d,h;class t{constructor(t,e){this.validate=this.validate.bind(this),this.setElement=this.setElement.bind(this),this.init=this.init.bind(this),this.validateOne=this.validateOne.bind(this),this.adviseOne=this.adviseOne.bind(this),this.validators=t,this.options=e}validate(t,e){var s,i,r,n,o,a,l;for(this.setElement(t),s=0,r=(o=this.validators).length;s<r;s++)if(l=o[s],!this.validateOne(l,e))return!1;for(i=0,n=(a=this.validators).length;i<n;i++)"function"==typeof(l=a[i]).getWarnings&&this.adviseOne(l,e);return!0}setElement(t){return this.element=t,this.parent=jQuery(this.element).parents(".form-group")[0],this.parent&&(this.errors=this.parent.querySelector(this.options.errorMessages),this.warnings=this.parent.querySelector(this.options.warningMessages),l(this.errors),l(this.warnings)),this}init(t){return this.setElement(t)}validateOne(t,e){var s,i=this.element,r=this.parent,n=this.errors,o=this.warnings,a=new Array;return t.reset(),s=!1,s=t.isValid(e)?(this.options.inputError&&h(i,this.options.inputError,!1),this.options.inputSuccess&&h(i,this.options.inputSuccess,!0),r&&(this.options.parentError&&h(r,this.options.parentError,!1),this.options.parentSuccess)&&h(r,this.options.parentSuccess,!0),n&&(l(n),n.innerHTML=""),!0):(a=t.getErrors(),this.options.inputError&&h(i,this.options.inputError,!0),this.options.inputSuccess&&h(i,this.options.inputSuccess,!1),r&&(this.options.parentError&&h(r,this.options.parentError,!0),this.options.parentSuccess)&&h(r,this.options.parentSuccess,!1),n&&a&&(d(n),n.innerHTML=a.join("<br />")),!1),this.options.inputWarning&&h(i,this.options.inputWarning,!1),r&&this.options.parentWarning&&h(r,this.options.parentWarning,!1),o&&(l(o),o.innerHTML=""),s}adviseOne(t,e){var s=this.element,i=this.parent,r=(this.errors,this.warnings),t=t.getWarnings();return t.length&&(this.options.inputWarning&&h(s,this.options.inputWarning,!0),this.options.inputSuccess&&h(s,this.options.inputSuccess,!1),i&&(this.options.parentWarning&&h(i,this.options.parentWarning,!0),this.options.parentSuccess)&&h(i,this.options.parentSuccess,!1),r)&&(d(r),r.innerHTML=t.join("<br />")),this}}return t.prototype.element=null,t.prototype.parent=null,t.prototype.errors=null,t.prototype.warnings=null,h=ko.utils.toggleDomNodeCssClass,l=function(t){return ko.utils.toggleDomNodeCssClass(t,"hide",!0)},d=function(t){return ko.utils.toggleDomNodeCssClass(t,"hide",!1)},t}.call(this),this.Maslosoft.Binder.Widgets.TreeGrid||(this.Maslosoft.Binder.Widgets.TreeGrid={}),Maslosoft.Binder.Widgets.TreeGrid.Dnd=function(){var a,l,d,h,e,i;class t{constructor(t){this.dragStart=this.dragStart.bind(this),this.drag=this.drag.bind(this),this.stop=this.stop.bind(this),this.drop=this.drop.bind(this),this.over=this.over.bind(this),this.dragOver=this.dragOver.bind(this),this.move=this.move.bind(this),this.clear=this.clear.bind(this),this.dragHelper=this.dragHelper.bind(this),this.grid=t,this.grid.config.dnd&&("init"===this.grid.context&&(ko.utils.domNodeDisposal.addDisposeCallback(this.grid.element.get(0),function(){try{if(this.grid.element)return this.grid.element.draggable("destroy"),this.grid.element.droppable("destroy")}catch(t){return console.log(t.message)}}),this.grid.element.on("mousemove","> tr",this.move)),e=e||new Maslosoft.Binder.Widgets.TreeGrid.DropIndicator(this.grid),setTimeout(()=>{var t={handle:".tree-grid-drag-handle",cancel:".expander, input, *[contenteditable], .no-drag",revert:!1,cursor:"pointer",cursorAt:{top:5,left:5},start:this.dragStart,drag:this.drag,stop:this.stop,helper:this.dragHelper},e={tolerance:"pointer",drop:this.drop,over:this.over};return this.grid.element.find("> tr").draggable(t),this.grid.element.find("> tr").droppable(e)},0))}dragStart(t){return l=t.target}drag(t,e){}stop(t,e){if(!a)return this.drop(t,e)}drop(t,e){var s,i,r,n,o;return a=!0,l&&d&&d.get(0)&&(s=ko.dataFor(l),i=ko.dataFor(d.get(0)),this.grid.canDrop(l,d,h))?(this.grid.freeze(),r=this.grid.getParent(i),o=this.grid.getRoot(),n=r.children||r,(()=>{var t;return this.grid.remove(s),"over"===h&&i.children.push(s),"before"===h&&(t=n.indexOf(i),n.splice(t,0,s)),"after"===h&&(i.children.length?n.splice(0,0,s):n.push(s)),"last"===h&&(o.children||o).push(s),this.clear()})()):this.clear()}over(t){if("tr"===t.target.tagName.toLowerCase()&&d!==t.target)return d=jQuery(t.target),this.dragOver(t)}dragOver(t){if(e)return e.precise.over(l,d,h,e)}move(t){var e,s;if(!l||t.currentTarget!==l||d&&l===d.get(0)||(t.target=l,this.over(t)),d&&(s=d.offset(),(e={}).x=t.pageX-s.left,e.y=t.pageY-s.top,(s={}).x=e.x/d.outerWidth(!0),s.y=e.y/d.outerHeight(!0),h=.65<s.y?"after":"over","after"===(h=s.y<=.25?"before":h)&&this.grid.isLast(ko.dataFor(d.get(0)))&&(h="last"),i!==h))return i=h,t.target=d,this.dragOver(t)}clear(){if(this.grid.thaw(),i=h=l=d=null,a=!1,this.helper&&(this.helper.hide(),this.helper=null),e)return e.hide()}dragHelper(t){t=jQuery(t.currentTarget).parent().find(".tree-grid-drag-handle").parents("td").first().clone();return t.find(".expander .expanded").remove(),t.find(".expander .collapsed").remove(),t.find(".expander").remove(),t.find(".no-expander").remove(),this.helper=jQuery(`<div style='white-space:nowrap;'><span class='drop-indicator'>&times;</span>${t.html()}</div>`),this.helper.css("pointer-events","none"),e.attach(this.helper.find(".drop-indicator")),this.helper}}return t.prototype.grid=null,i=h=l=d=e=t.prototype.helper=null,a=!1,t}.call(this),Maslosoft.Binder.Widgets.TreeGrid.DropIndicator=function(){class t{constructor(t){this.grid=t,this.precise=new Maslosoft.Binder.Widgets.TreeGrid.InsertIndicator(this.grid)}attach(t){return this.element=t,this.element.css({"font-size":"1.5em"}),this.element.css({width:"1em"}),this.element.css({height:"1em"}),this.element.css({position:"absolute"}),this.element.css({left:"-.75em"}),this.element.css({top:"-.35em"})}hide(){return this.element.hide(),this.precise.hide()}show(){return this.element.show(),this.precise.show()}accept(){return this.element.html("&check;"),this.element.css({color:"green"}),this.precise.accept()}deny(){return this.element.html("&times;"),this.element.css({color:"red"}),this.precise.deny()}}return t.precise=null,t.element=null,t}.call(this),Maslosoft.Binder.Widgets.TreeGrid.Events=function(){class t{constructor(t,e){this.grid=t,this.grid.config.on}}return t.prototype.grid=null,t}.call(this),Maslosoft.Binder.Widgets.TreeGrid.Expanders=function(){var o,a,l;class t{constructor(t,e){this.updateExpanders=this.updateExpanders.bind(this),this.handler=this.handler.bind(this),this.cancelClick=this.cancelClick.bind(this),this.grid=t,!1!==this.grid.config.expanders&&("init"===this.grid.context&&(this.grid.element.on("mousedown",".expander",this.handler),this.grid.element.on("click",".expander",this.cancelClick)),"update"===this.grid.context)&&this.updateExpanders()}updateExpanders(){var t=(t,e)=>{return e.children&&e.children.length?(t.find(".no-expander").hide(),t.find(".expander").show(),t.find(".expander .collapsed").is(":visible")?void 0:t.find(".expander .expanded").show()):(t.find(".expander").hide(),t.find(".no-expander").show())};return setTimeout(()=>this.grid.visit(t),0)}handler(t){var i,r,n=ko.contextFor(t.target).$data;return t.stopPropagation(),t.preventDefault(),r=!(i=-1),W("clicked on expander "+n.title),this.grid.visit((t,e)=>{var s=e._treeGrid.depth;if(e===n)i=s,r=l(t),t.data("treegrid-manual-state",r);else if(-1!==i){if(s!==i)return i<=s?(r?(t.show(),a):(t.hide(),o))(t):void 0;i=-1}})}cancelClick(t){return t.stopPropagation(),t.preventDefault()}}return l=function(t){t=t.find(".expander"),t=t.find(".expanded:visible").length?(t.find(".expanded").hide(),t.find(".collapsed").show(),!1):(t.find(".collapsed").hide(),t.find(".expanded").show(),!0);return t},a=function(t){t=t.find(".expander");return t.find(".collapsed").hide(),t.find(".expanded").show()},o=function(t){t=t.find(".expander");return t.find(".expanded").hide(),t.find(".collapsed").show()},t.prototype.grid=null,t}.call(this),Maslosoft.Binder.Widgets.TreeGrid.InsertIndicator=function(){var n,e,s;class t{constructor(t){this.grid=t,e||(this.create(),e=!0)}hide(){return n.hide()}show(){return n.show()}accept(){return n.css({color:"green"})}deny(){return n.css({color:"red"})}over(t,e,s="over",i){var r;return this.accept(),i.accept(),"over"===s?this.precise(!1):this.precise(!0),this.grid.canDrop(t,e,s)?(this.accept(),i.accept()):(this.deny(),i.deny()),i=(t=e.find(".tree-grid-drag-handle")).offset(),e=n.outerHeight(!0)/1.5,"over"===s&&(r=t.outerHeight(!0)/1.5,r=i.top+r-e),"before"===s&&(r=i.top-e),"after"===s&&(r=i.top+t.outerHeight(!0)-e),s=i.left+0,n.css({left:s}),n.css({top:r}),this.show()}precise(t=!0){return t?s.show():s.hide()}create(){return(n=jQuery(`<div class="tree-grid-insert-indicator" style="display:none;position:absolute;z-index: 10000;color:green;line-height: 1em;">
	<span class="tree-grid-insert-indicator-coarse" style="font-size: 1.5em;">
		&#9654;
	</span>
	<span class="tree-grid-insert-indicator-precise" style="font-size:1.4em;">
		&#11835;
	</span>
</div>`)).appendTo("body"),n.find(".tree-grid-insert-indicator-coarse"),s=n.find(".tree-grid-insert-indicator-precise")}}return e=!1,s=n=t.prototype.grid=null,t}.call(this),Maslosoft.Binder.Widgets.TreeGrid.TreeGridView=function(){var o;class a{constructor(t,e=null,s="init"){var i,r,n;if(this.visitRecursive=this.visitRecursive.bind(this),this.getParent=this.getParent.bind(this),this.getRoot=this.getRoot.bind(this),this.getContext=this.getContext.bind(this),this.have=this.have.bind(this),this.isLast=this.isLast.bind(this),this.canDrop=this.canDrop.bind(this),this.remove=this.remove.bind(this),this.freeze=this.freeze.bind(this),this.thaw=this.thaw.bind(this),this.getFirstCells=this.getFirstCells.bind(this),this.context=s,this.element=jQuery(t),e)for(this.config={},this.config=ko.unwrap(e()),i=0,r=(n=a.plugins).length;i<r;i++)new n[i](this)}init(){return jQuery(document).on("ajaxStart",this.freeze),jQuery(document).on("ajaxComplete",this.thaw)}dispose(){return jQuery(document).off("ajaxStart",this.freeze),jQuery(document).off("ajaxComplete",this.thaw)}visit(t){for(var e,s,i=this.element.find("> tr"),r=[],n=0,o=i.length;n<o;n++)s=i[n],e=ko.dataFor(s),r.push(t(jQuery(s),e));return r}visitRecursive(t,e=null){var s,i,r,n,o,a,l,d,h,u,c,p,f;if(e){if(e.children&&e.children.length)for(n=0,l=(c=e.children).length;n<l;n++)t(e,s=c[n]),this.visitRecursive(t,s);if(e.length){for(f=[],h=0,d=e.length;h<d;h++)t(e,s=e[h]),f.push(this.visitRecursive(t,s));return f}}else{if(t(null,e=this.getRoot()),e.children&&e.children.length)for(i=0,o=(u=e.children).length;i<o;i++)t(e,s=u[i]),this.visitRecursive(t,s);if(e.length){for(p=[],r=0,a=e.length;r<a;r++)t(e,s=e[r]),p.push(this.visitRecursive(t,s));return p}}}getParent(s){var i=null;return this.visitRecursive(function(t,e){if(e===s)return i=t}),i}getRoot(){return ko.contextFor(this.element.get(0)).tree}getContext(){return ko.contextFor(this.element.get(0))}have(t,s){var i=!1;return this.visitRecursive(function(t,e){if(e===s)return i=!0},t),i}isLast(t){var e=this.element.find("> tr:last()");return t===ko.dataFor(e.get(0))}canDrop(t,e,s){t=ko.dataFor(t),e=ko.dataFor(e.get(0));return"last"===s||"after"===s||t!==e&&!this.have(t,e)}remove(s){return this.visitRecursive(function(t,e){if(t)return(t.children||t).remove(s)})}expandAll(){}collapseAll(){}freeze(){var t,e,s,i,r;for(console.log("Freeze"),o=[],e=this.getFirstCells(),console.log(e),r=[],s=0,i=e.length;s<i;s++)t=e[s],o.push(t.style),t=jQuery(t),r.push(t.css("width",t.width()+"px"));return r}thaw(){var t,e,s,i,r,n;for(console.log("thaw"),n=[],s=i=0,r=(e=this.getFirstCells()).length;i<r;s=++i)t=e[s],n.push(t.style=o[s]);return n}getFirstCells(){var t,e=this.element;return t=(t=(t=(t=(e=this.element.is("tbody")?this.element.parent():e).find("thead tr:first() th"))&&t.length?t:e.find("tr:first() td"))&&t.length?t:e.find("tbody tr:first() td"))&&t.length?t:e.find("tfoot tr:first() th")}}return a.plugins=[Maslosoft.Binder.Widgets.TreeGrid.Expanders,Maslosoft.Binder.Widgets.TreeGrid.Dnd,Maslosoft.Binder.Widgets.TreeGrid.Events],a.prototype.element=null,a.prototype.config=null,o=[],a}.call(this),this.Maslosoft.Ko.getType=function(t){if(x&&"object"==typeof x){if(x.constructor===Date)return"date";if(x.constructor===Array)return"array"}return typeof x},this.Maslosoft.Ko.objByName=function(t,e=window){Array.prototype.slice.call(arguments,2);for(var s,i,r=t.split("."),n=e,o=[],a=s=0,l=r.length;s<l;a=++s){if(i=r[a],o.push(i),void 0===n[i])throw new Error(`Name part \`${o.join(".")}\` not found while accesing `+t);n=n[i]}return n},this.Maslosoft.Ko.Track=class{constructor(){this.factory=this.factory.bind(this),this.fromJs=this.fromJs.bind(this)}factory(t){var e,s,i,r,n,o,a,l;if(t){if(t._class&&"string"==typeof t._class){e=t._class.replace(/\\/g,".");try{a=Maslosoft.Ko.objByName(e)}catch(t){console.warn(`Could not resolve class name \`${e}\``)}if(a)return new a(t);console.warn(`Class \`${e}\` not found, using default object`),console.debug(t)}if("object"==typeof t)if(t=ko.track(t,{deep:!0}),Array.isArray(t))for(s=i=0,r=t.length;i<r;s=++i)n=t[s],t[s]=this.factory(n);else for(o in t)l=t[o],t[o]=this.factory(l)}return t}fromJs(t,e){var s,i,r=[];for(s in e)"object"==typeof(i=e[s])?Array.isArray(i)?t[s]=this.factory(i):t[s]?r.push(this.fromJs(t[s],i)):r.push(t[s]=this.factory(i)):r.push(t[s]=i);return r}},ko.tracker=new this.Maslosoft.Ko.Track,window.Proxy||(console.warn("Your browser does not support Proxy, will not work properly in some cases..."),window.Proxy=class{}),r=class{constructor(t,e){this.parent=t,this.field=e}set(t,e,s,i){var r,n=!1;return t[e]!==s&&(n=!0),r=Object.keys(t).length,t[e]=s,(n=r!==Object.keys(t).length?!0:n)&&ko.valueHasMutated(this.parent,this.field),!0}deleteProperty(t,e){return delete t[e],ko.valueHasMutated(this.parent,this.field),!0}},h=new(WeakMap||Map),this.Maslosoft.Binder.Model=class{constructor(t=null){var e,s,i=h.get(this);for(e in this)s=this[e],u(this[e])&&(this[e]={}),Array.isArray(this[e])&&(this[e]=[]);if(!i)for(e in h.set(this,!0),this)s=this[e],this[e]=ko.tracker.factory(s),u(this[e])&&(this[e]=new Proxy(this[e],new r(this,e)));for(e in t)s=t[e],this[e]=ko.tracker.factory(s);for(e in this)s=this[e],u(this[e])&&(this[e]=new Proxy(this[e],new r(this,e)));ko.track(this,{deep:!0})}},this.Maslosoft.Ko.Balin=this.Maslosoft.Binder,this.Maslosoft.Ko.escapeRegExp=z,this.Maslosoft.Ko.escapeHtml=d,this.Maslosoft.Ko.equals=o,this.Maslosoft.Ko.stringToColour=mt,this.Maslosoft.Ko.preload=p,this.Maslosoft.Ko.numberFormat=c,this.Maslosoft.Ko.lcfirst=K,this.Maslosoft.Ko.ucfirst=vt,this.Maslosoft.Binder.registerDefaults(),ko.punches.enableAll()}.call(this);