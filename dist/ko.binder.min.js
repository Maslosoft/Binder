(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,y,z,A,B=function(a,b){return function(){return a.apply(b,arguments)}},C={}.hasOwnProperty,D=function(a,b){function c(){this.constructor=a}for(var d in b)C.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};s=function(a){if(console)return console.log.apply(console,arguments)},A=function(a,b){if(null==b&&(b=null),console)return console.warn.apply(console,arguments)},m=function(a,b){if(null==b&&(b=null),console)return console.error.apply(console,arguments)},Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),q=function(a){return!!a&&"object"==typeof a&&a.constructor===Object},Object.keys||(Object.keys=function(){var a,b,c,d;return d=Object.prototype.hasOwnProperty,c=!{toString:null}.propertyIsEnumerable("toString"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],b=a.length,function(e){var f,g,h;if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");h=[],g=void 0,f=void 0;for(g in e)g=g,d.call(e,g)&&h.push(g);if(c)for(f=0;f<b;)d.call(e,a[f])&&h.push(a[f]),f++;return h}}()),w=function(a,b,c){var d,e,f,g,h,i;for(null==c&&(c=window),Array.prototype.slice.call(arguments,2),g=a.split("."),d=c,e=h=0,i=g.length;h<i;e=++h)f=g[e],console.log(e),e===g.length-1&&(console.log(f),d[f]=b),d=d[f];return d},o=function(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},n=function(a){return String(a).replace(/[&<>"'`=\/]/g,function(a){return k[a]})},l=function(a,b,c){var d,e;if(null==c&&(c=[]),d=function(a){return-1!==c.indexOf(a)},a===b)return!0;if(!(a instanceof Object&&b instanceof Object))return!1;if(a.constructor!==b.constructor)return!1;for(e in a)if(!d(e)&&a.hasOwnProperty(e)){if(!b.hasOwnProperty(e))return!1;if(a[e]!==b[e]){if("object"!=typeof a[e])return!1;if(!l(a[e],b[e],c))return!1}}for(e in b)if(!d(e)&&(e=e,b.hasOwnProperty(e)&&!a.hasOwnProperty(e)))return!1;return!0},y=function(a){var b,c,d,e;for(c=0,d=0,d=0;d<a.length;)c=a.charCodeAt(d)+(c<<5)-c,d++;for(b="#",d=0;d<3;)e=c>>8*d&255,b+=("00"+e.toString(16)).substr(-2),d++;return b},v={},u=function(a,b){var c;return v[b]?void a.attr("src",b):(c=new Image,c.src=b,c.onload=function(){return c=null,v[b]=!0,a.attr("src",b)})},j=function(a,b){var c;if(!a.hasAttribute(b))return c=document.createAttribute(b),c.value="",a.setAttributeNode(c),a.setAttribute(b,""),jQuery(a).attr(b,"")},t=function(a,b,c,d,e){var f,g;return null==b&&(b=2),null==c&&(c=3),null==d&&(d=" "),null==e&&(e=","),g="\\d(?=(\\d{"+(c||3)+"})+"+(b>0?"\\D":"$")+")",f=a.toFixed(Math.max(0,~~b)),(e?f.replace(".",e):f).replace(new RegExp(g,"g"),"$&"+(d||","))},r=function(a){return a=a.substring(0,1).toLocaleLowerCase()+a.substring(1)},z=function(a){return a=a.substring(0,1).toLocaleUpperCase()+a.substring(1)},this.Maslosoft||(this.Maslosoft={}),this.Maslosoft.Ko||(this.Maslosoft.Ko={}),this.Maslosoft.Ko.Balin||(this.Maslosoft.Ko.Balin={}),this.Maslosoft.Binder||(this.Maslosoft.Binder={}),this.Maslosoft.Binder.Helpers||(this.Maslosoft.Binder.Helpers={}),this.Maslosoft.Binder.Widgets||(this.Maslosoft.Binder.Widgets={}),this.Maslosoft.Ko.debounce=function(a,b,c){var d;return d=void 0,function(){var e,f,g,h;g=this,e=arguments,h=function(){d=null,c||a.apply(g,e)},f=c&&!d,clearTimeout(d),d=setTimeout(h,b||200),f&&a.apply(g,e)}},this.Maslosoft.Binder.register=function(a,b){var c;if(c=!1,a.match(/[A-Z]/)&&(c=a.toLowerCase()),b.writable&&ko.expressionRewriting&&ko.expressionRewriting.twoWayBindings&&(ko.expressionRewriting.twoWayBindings[a]=!0,c&&(ko.expressionRewriting.twoWayBindings[c]=!0)),ko.bindingHandlers[a]=b,c)return ko.bindingHandlers[c]=b},this.Maslosoft.Binder.registerDefaults=function(a){var b,c,d,e,f;if(null==a&&(a=null),b={acl:Maslosoft.Binder.Acl,active:Maslosoft.Binder.Active,action:Maslosoft.Binder.WidgetAction,activity:Maslosoft.Binder.WidgetActivity,asset:Maslosoft.Binder.Asset,cssClasses:Maslosoft.Binder.CssClasses,cssColumnSizes:Maslosoft.Binder.CssColumnSizes,cssColumns:Maslosoft.Binder.CssColumns,data:Maslosoft.Binder.Data,dateFormatter:Maslosoft.Binder.DateFormatter,datePicker:Maslosoft.Binder.DatePicker,datePickerPickaDate:Maslosoft.Binder.PickaDate,dateTimeFormatter:Maslosoft.Binder.DateTimeFormatter,decimalFormatter:Maslosoft.Binder.DecimalFormatter,disabled:Maslosoft.Binder.Disabled,enumCssClassFormatter:Maslosoft.Binder.EnumCssClassFormatter,enumFormatter:Maslosoft.Binder.EnumFormatter,eval:Maslosoft.Binder.Eval,fancytree:Maslosoft.Binder.Fancytree,fileSizeFormatter:Maslosoft.Binder.FileSizeFormatter,googlemap:Maslosoft.Binder.GoogleMap,hidden:Maslosoft.Binder.Hidden,href:Maslosoft.Binder.Href,html:Maslosoft.Binder.Html,htmlTree:Maslosoft.Binder.HtmlTree,htmlValue:Maslosoft.Binder.HtmlValue,icon:Maslosoft.Binder.Icon,id:Maslosoft.Binder.Id,log:Maslosoft.Binder.Log,model:Maslosoft.Binder.DataModel,placeholder:Maslosoft.Binder.Placeholder,ref:Maslosoft.Binder.Widget,src:Maslosoft.Binder.Src,tags:Maslosoft.Binder.Tags,text:Maslosoft.Binder.Text,textToBg:Maslosoft.Binder.TextToBg,textValue:Maslosoft.Binder.TextValue,textValueHlJs:Maslosoft.Binder.TextValueHLJS,timeAgoFormatter:Maslosoft.Binder.TimeAgoFormatter,timeFormatter:Maslosoft.Binder.TimeFormatter,timePicker:Maslosoft.Binder.TimePicker,tooltip:Maslosoft.Binder.Tooltip,treegrid:Maslosoft.Binder.TreeGrid,treegridnode:Maslosoft.Binder.TreeGridNode,selected:Maslosoft.Binder.Selected,select2:Maslosoft.Binder.Select2,validator:Maslosoft.Binder.Validator,videoPlaylist:Maslosoft.Binder.VideoPlaylist,videoThumb:Maslosoft.Binder.VideoThumb,widget:Maslosoft.Binder.Widget},null!==a){e=[];for(c in a)d=a[c],e.push(Maslosoft.Binder.register(d,new b[d]));return e}f=[];for(c in b)d=b[c],f.push(Maslosoft.Binder.register(c,new d));return f},this.Maslosoft.Binder.registerEvents=function(a){var b,c,d,e,f;if(null==a&&(a=null),b={dblclick:"dblclick",mousedown:"mousedown",mouseup:"mouseup",mouseover:"mouseover",mouseout:"mouseout"},null!==a){e=[];for(c in a)d=a[c],e.push(Maslosoft.Binder.makeEventHandlerShortcut(d));return e}f=[];for(c in b)d=b[c],f.push(Maslosoft.Binder.makeEventHandlerShortcut(d));return f},this.Maslosoft.Binder.makeEventHandlerShortcut=function(a){ko.bindingHandlers[a]={init:function(b,c,d,e,f){var g;return g=function(){var b;return b={},b[a]=c(),b},ko.bindingHandlers.event.init.call(this,b,g,d,e,f)}}},this.Maslosoft.Binder.Base=function(){function a(a){var b,c;null==a&&(a={}),this.getValue=B(this.getValue,this),this.options={};for(b in a)c=a[b],this.options[b]=c}return a.prototype.writable=!0,a.prototype.options={},a.prototype.getValue=function(a,b){var c;return null==b&&(b=""),c="function"==typeof a?ko.unwrap(a()):ko.unwrap(a),this.options.valueField&&(c=this.options.ec5?c[this.options.valueField]:c[this.options.valueField]()),void 0===c?b:c},a}(),this.Maslosoft.Binder.Options=function(){function a(a){var b,c;null==a&&(a={});for(b in a)c=a[b],this[b]=c;null===this.ec5&&(this.ec5=!!ko.track),null===this.afterUpdate&&(this.afterUpdate=function(a,b){})}return a.prototype.valueField=null,a.prototype.ec5=null,a.prototype.afterUpdate=null,a}(),this.Maslosoft.Binder.CssOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.className="active",b}(this.Maslosoft.Binder.Options),this.Maslosoft.Binder.DateOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="YYYY-MM-DD",b}(this.Maslosoft.Binder.Options),this.Maslosoft.Binder.DateTimeOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="YYYY-MM-DD hh:mm",b}(this.Maslosoft.Binder.Options),this.Maslosoft.Binder.TimeAgoOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="hh:mm",b}(this.Maslosoft.Binder.Options),this.Maslosoft.Binder.TimeOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="hh:mm",b}(this.Maslosoft.Binder.Options),this.Maslosoft.Binder.ValidatorOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.classField="_class",b.prototype.parentSelector=".form-group",b.prototype.inputError="error",b.prototype.parentError="has-error",b.prototype.inputWarning="warning",b.prototype.parentWarning="has-warning",b.prototype.inputSuccess="success",b.prototype.parentSuccess="has-success",b.prototype.errorMessages=".error-messages",b.prototype.warningMessages=".warning-messages",b}(this.Maslosoft.Binder.Options),this.Maslosoft.Binder.BaseValidator=function(){function a(a){var b,c;this.reset();for(b in a)c=a[b],this[b]=null,this[b]=c}return a.prototype.label="",a.prototype.model=null,a.prototype.messages=[],a.prototype.rawMessages=[],a.prototype.warningMessages=[],a.prototype.rawWarningMessages=[],a.prototype.reset=function(){return this.messages=new Array,this.rawMessages=new Object,this.warningMessages=new Array,this.rawWarningMessages=new Object},a.prototype.isValid=function(){throw new Error("Validator must implement `isValid` method")},a.prototype.getErrors=function(){return this.messages},a.prototype.getWarnings=function(){return this.warningMessages},a.prototype.addError=function(a,b){var c,d,e,f;d=a,a=a.replace("{attribute}",this.label);for(c in this)e=this[c],a=a.replace("{"+c+"}",e);for(c in b)e=b[c],a=a.replace("{"+c+"}",e);f=this.model;for(c in f)e=f[c],a=a.replace("{"+c+"}",e);if(!this.rawMessages[d])return this.messages.push(a),this.rawMessages[d]=!0},a.prototype.addWarning=function(a,b){var c,d,e,f;d=a,a=a.replace("{attribute}",this.label);for(c in this)e=this[c],a=a.replace("{"+c+"}",e);for(c in b)e=b[c],a=a.replace("{"+c+"}",e);f=this.model;for(c in f)e=f[c],a=a.replace("{"+c+"}",e);if(!this.rawWarningMessages[d])return this.warningMessages.push(a),this.rawWarningMessages[d]=!0},a}(),this.Maslosoft.Binder.CssClass=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.writable=!1,b.prototype.update=function(a,b){var c;c=this.getValue(b),c?ko.utils.toggleDomNodeCssClass(a,this.options.className,!0):ko.utils.toggleDomNodeCssClass(a,this.options.className,!1)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.CssColumnsBase=function(a){function b(){return this.applyColumns=B(this.applyColumns,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.writable=!1,b.prototype.applyColumns=function(a,b,c){var d,e,f,g,h;e=[];for(h in c)d=c[h],g=d.replace("{num}","\\d"),d=d.replace("{num}",""),f=new RegExp("(?:^|\\s)"+g+"+(?!\\S)","g"),a.className=a.className.replace(f,""),e.push(d+b[h]);jQuery(a).addClass(e.join(" "))},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.MomentFormatter=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.init=function(a,b,c,d){moment.locale(this.options.lang)},b.prototype.update=function(a,b,c,d){var e;if(!(e=this.getValue(b)))return void(a.innerHTML="");a.innerHTML=moment[this.options.sourceFormat](e).format(this.options.displayFormat)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Picker=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Video=function(a){function b(){return this.setThumb=B(this.setThumb,this),this.isVideoUrl=B(this.isVideoUrl,this),b.__super__.constructor.apply(this,arguments)}var c,d;return D(b,a),d=null,c=null,jQuery(document).ready(function(){return d=new Maslosoft.Playlist.Options,c=d.adapters}),b.prototype.isVideoUrl=function(a){var b,d,e;for(d=0,e=c.length;d<e;d++)if(b=c[d],b.match(a))return b;return!1},b.prototype.setThumb=function(a,b){var c,d,e;if(d=this.isVideoUrl(a))return e=function(a){return"img"===b.tagName.toLowerCase()?b.src=a:jQuery(b).css("background-image","url('"+a+"')")},console.log(a),c=new d,c.setUrl(a),c.setThumb(e)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.WidgetUrl=function(a){function b(){return this.setRel=B(this.setRel,this),this.createUrl=B(this.createUrl,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.getData=function(a,b,c,d){var e,f,g;return g=this.getValue(b),f={},f.id=c.get("widgetId")||g.id,c.get("widget")&&(f.id=c.get("widget").id),f[d]=c.get(d)||g[d],e=c.get("params"),f.params=void 0===typeof e?g.params:e,f.params=this.getValue(f.params),"string"==typeof g&&(f[d]=g),f},b.prototype.createUrl=function(a,b,c,d){var e,f,g,h;if(e=[],"string"==typeof c||"number"==typeof c)""===c&&"number"!=typeof c||e.push(""+c);else for(g in c)h=c[g],g=encodeURIComponent(""+g),h=encodeURIComponent(""+h),e.push(g+":"+h);return f=""+d+a+"."+b,0===e.length?f:(e=e.join(",",e),f+"="+e)},b.prototype.setRel=function(a){var b,c,d,e,f,g,h;if(b=!1,c=!1,f=[],d=a.getAttribute("rel"))for(f=d.split(" "),g=0,h=f.length;g<h;g++)e=f[g],"plain"===e&&(c=!0),"virtual"===e&&(b=!0);return b||c||f.push("virtual"),a.setAttribute("rel",f.join(" "))},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Acl=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),null,b.prototype.init=function(){if(!Maslosoft.Binder.Acl.allow)throw new Error("Acl binding handler requires Maslosoft.Binder.Acl.allow to be function checking permissions");if("function"!=typeof Maslosoft.Binder.Acl.allow)throw new Error("Acl binding handler requires Maslosoft.Binder.Acl.allow to be function checking permissions")},b.prototype.update=function(a,b){var c,d;return c=this.getValue(b),d=Maslosoft.Binder.Acl.allow(c),ko.bindingHandlers.visible.update(a,function(){return d})},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Active=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Binder.CssOptions({className:"active"}))}return D(b,a),b}(this.Maslosoft.Binder.CssClass),this.Maslosoft.Binder.Asset=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b,c){var d,e,f,g,h,i,j,k,l,m;d=$(a),m=c.get("w"),g=c.get("h"),i=c.get("p"),h=this.getValue(b),f=this.getValue(c),h.updateDate&&(e=h.updateDate,"number"==typeof e&&(j=e),"number"==typeof e.sec&&(j=e.sec)),l=h.url,k=[],k.push(l),m&&k.push("w/"+m),g&&k.push("h/"+g),!1===i&&k.push("p/0"),j&&k.push(j),k=k.join("/"),d.attr("src")!==k&&(f.preloader&&d.attr("src",f.preloader),u(d,k))},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.CssClasses=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),this.getClassList=B(this.getClassList,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.getClassList=function(a){var b,c;return void 0===(c=this.getValue(a))?"":null===c?"":(b="string"==typeof c?c:c.join(" "),b.replace(/^\s*/,"").replace(/\s*$/,""))},b.prototype.init=function(a,b){var c;return c=this.getClassList(b),a.setAttribute("data-css-classes",c)},b.prototype.update=function(a,b,c,d){var e,f;return f=a.getAttribute("data-css-classes"),ko.utils.toggleDomNodeCssClass(a,f,!1),e=this.getClassList(b),e&&ko.utils.toggleDomNodeCssClass(a,e,!0),a.setAttribute("data-css-classes",e)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.CssColumnSizes=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.columns={xs:"col-xs-{num}",sm:"col-sm-{num}",md:"col-md-{num}",lg:"col-lg-{num}"},b.prototype.init=function(a,b){},b.prototype.update=function(a,c,d,e){var f;return f=this.getValue(c),this.applyColumns(a,f,b.columns)},b}(this.Maslosoft.Binder.CssColumnsBase),this.Maslosoft.Binder.CssColumns=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.columns={xs:"col-xs-{num}",sm:"col-sm-{num}",md:"col-md-{num}",lg:"col-lg-{num}"},b.prototype.init=function(a,b){},b.prototype.update=function(a,c,d,e){var f,g,h,i,j,k;g=this.getValue(c),i={},k=b.columns;for(h in k)k[h],j=parseInt(g[h]),f=parseInt(12/j),i[h]=f;return this.applyColumns(a,i,b.columns)},b}(this.Maslosoft.Binder.CssColumnsBase),this.Maslosoft.Binder.Data=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.getNamespacedHandler=function(a){return{update:function(b){return function(c,d){var e,f;return e=b.getValue(d),"string"!=(f=typeof e)&&"number"!==f&&(e=JSON.stringify(e)),c.setAttribute("data-"+a,e)}}(this)}},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.DataModel=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b,c){var d,e,f,g,h,i,j;if(f=this.getValue(b),null===(e=c.get("fields")||null))return void this.bindModel(a,f);for(g={},j=[],h=0,i=e.length;h<i;h++)d=e[h],void 0===f[d]?A("Model field `"+d+"` is undefined on element:",a):g[d]=f[d],j.push(this.bindModel(a,g));return j},b.prototype.bindModel=function(a,b){var c,d;return"string"!=(d=typeof value)&&"number"!==d&&(c=JSON.stringify(b)),a.setAttribute("data-model",c)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.DateFormatter=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Binder.DateOptions(a))}return D(b,a),b}(this.Maslosoft.Binder.MomentFormatter),this.Maslosoft.Binder.DatePicker=function(a){function b(a){this.update=B(this.update,this),this.init=B(this.init,this),this.getModelValue=B(this.getModelValue,this),this.getDisplayValue=B(this.getDisplayValue,this),this.updateModel=B(this.updateModel,this),b.__super__.constructor.call(this,new Maslosoft.Binder.DateOptions(a))}return D(b,a),b.prototype.getData=function(a){var b;return a?(b=this.getValue(a)||[],b.data?b.data:b):""},b.prototype.getOptions=function(a){var b,c,d,e;if(d={lang:this.options.lang,sourceFormat:this.options.sourceFormat,displayFormat:this.options.displayFormat,format:this.options.displayFormat.toLowerCase(),forceParse:!1,todayHighlight:!0,showOnFocus:!1},b=a.get("dateOptions")||[])for(c in b)e=b[c],"data"!==c&&"template"!==c&&("format"===c&&(d.displayFormat=e.toUpperCase()),d[c]=e);return d},b.prototype.updateModel=function(a,b,c){var d,e,f,g;if(g=this.getOptions(c),f=this.getData(b),e=this.getModelValue(a.value,g),d=b(),f!==e)return d&&d.data?ko.expressionRewriting.writeValueToProperty(ko.unwrap(b()).data,c,"datePicker.data",e):ko.expressionRewriting.writeValueToProperty(b(),c,"datePicker",e)},b.prototype.getDisplayValue=function(a,b){return a?a&&0===a.length?"":"unix"===b.sourceFormat?moment.unix(a).format(b.displayFormat):moment(a,b.sourceFormat).format(b.displayFormat):""},b.prototype.getModelValue=function(a,b){return a?"unix"===b.sourceFormat?moment(a,b.displayFormat).unix():moment(a,b.displayFormat).format(b.sourceFormat):null},b.prototype.init=function(a,b,c,d){var e,f,g,h,i,j,k,l,m;j=this.getOptions(c),m=this.getDisplayValue(this.getData(b),j),a.value=m||"",f=jQuery(a),k=j.template?j.template:'<div class="input-group-addon">\n\t<a class="picker-trigger-link" style="cursor: pointer;">\n\t\t<i class="glyphicon glyphicon-calendar"></i>\n\t</a>\n</div>',e=jQuery(k),e.insertBefore(f),l=e.find("a.picker-trigger-link"),f.datepicker(j),i=function(d){return function(e){return m=f.datepicker("getDate"),m&&d.updateModel(a,b,c),!1}}(this),h=function(d){return function(e){var g;return!(!(g=Date.parse(a.value))||e.isTrigger)&&(a.value=d.getDisplayValue(Math.round(g.getTime()/1e3),j),d.updateModel(a,b,c),f.datepicker("update"),!0)}}(this),f.on("changeDate",function(a){return function(a){return i(a),!0}}()),f.on("change",h),f.on("blur",h),g=!1,f.on("show",function(a){return function(a){return g=!0}}()),f.on("hide",function(a){return function(a){return g=!1}}()),l.on("mousedown",function(a){g?f.datepicker("hide"):f.datepicker("show"),a.stopPropagation(),a.preventDefault()})},b.prototype.update=function(a,b,c){var d,e,f;if(e=b(),e&&e.data?ko.utils.setTextContent(a,e.data):ko.utils.setTextContent(a,e),d=this.getOptions(c),f=this.getDisplayValue(this.getData(b),d),a.value!==f)return a.value=f},b}(this.Maslosoft.Binder.Picker),this.Maslosoft.Binder.DateTimeFormatter=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Binder.DateTimeOptions(a))}return D(b,a),b}(this.Maslosoft.Binder.MomentFormatter),this.Maslosoft.Binder.DecimalFormatter=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.precision=2,b.prototype.decimalSeparator=",",b.prototype.thousandSeparator=" ",b.prototype.suffix="",b.prototype.prefix="",b.prototype.init=function(a,b,c,d){},b.prototype.update=function(a,b,c,d){var e,f,g,h,i,j,k,l;for(j=this.getValue(b)||0,j=parseFloat(j),f={},i=["precision","decimalSeparator","thousandSeparator","suffix","prefix"],k=0,l=i.length;k<l;k++)h=i[k],f[h]=this[h],void 0!==(e=c.get(h))&&(f[h]=this.getValue(e));return g=t(j,f.precision,3,f.thousandSeparator,f.decimalSeparator),a.innerHTML=f.prefix+g+f.suffix},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Disabled=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Binder.CssOptions({className:"disabled"}))}return D(b,a),b}(this.Maslosoft.Binder.CssClass),this.Maslosoft.Binder.EnumCssClassFormatter=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b,c,d){var e,f,g,h,i,j;for(e=this.getValue(b),j=e.values,h=0,i=j.length;h<i;h++)f=j[h],g=new RegExp("(?:^|\\s)"+f+"(?!\\S)","g"),a.className=a.className.replace(g,"");a.className+=" "+e.values[e.data]},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.EnumFormatter=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b,c,d){var e;e=this.getValue(b),void 0!==e.values[e.data]?a.innerHTML=e.values[e.data]:a.innerHTML=e.data},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Eval=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.init=function(a,b){var c;return c=this.getValue(b),console.log(c),{controlsDescendantBindings:!c}},b.prototype.update=function(a,b){var c;return c=this.getValue(b),console.log(c),{controlsDescendantBindings:!c}},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Fancytree=function(a){function b(){return this.update=B(this.update,this),this.handle=B(this.handle,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.tree=null,b.prototype.element=null,b.prototype.getData=function(a){var b;return b=this.getValue(a)||[],b.data?b.data:b},b.prototype.init=function(a,b,f,g){var i,j,k,l,m,n,o,p,q,r;if(q=this.getData(b),o=b().options||{},k=this.getValue(b).on||!1,o.toggleEffect=!1,o.source=q.children,o.extensions=[],r=new e(q,k,o),i=b().dnd||!1,j=b().drag||!1,i&&j)throw new Error("Cannot use both `dnd` and `drag`");return i&&(o.autoScroll=!1,o.extensions.push("dnd"),o.dnd=new c(q,a,r)),j&&(o.autoScroll=!1,o.extensions.push("dnd"),o.dnd=new d(q,a)),m=b().nodeIcon||!1,l=b().folderIcon||!1,n=b().nodeRenderer||!1,l&&!m&&A("Option `folderIcon` require also `nodeIcon` or it will not work at all"),(m||n)&&(m&&(o.icon=!1),p=new h(q,o,m,l),n&&p.setRenderer(new n(q,o)),o.renderNode=p.render),jQuery(a).fancytree(o)},b.prototype.handle=function(a,b,c){var d,e;return d=this.getValue(b),a=jQuery(a),e=function(c){return function(){if(a.find(".ui-fancytree").length)return a.fancytree("option","source",c.getData(b).children),d.autoExpand&&a.fancytree("getRootNode").visit(function(a){return a.setExpanded(!0)}),a.focus()}}(this),setTimeout(e,0)},b.prototype.update=function(a,b,c,d){return this.handle(a,b,c)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.FileSizeFormatter=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.units={binary:["kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimal:["kB","MB","GB","TB","PB","EB","ZB","YB"]},b.prototype.binary=!0,b.prototype.init=function(a,b,c,d){},b.prototype.update=function(a,b,c,d){var e,f,g,h,i;return i=this.getValue(b)||0,e=this.binary,f=!this.binary,e&&(h=1024),f&&(h=1e3),g=function(a){return function(b){var c,d;if((b=parseInt(b))<h)return b+" B";for(c=-1,e&&(d=a.units.binary),f&&(d=a.units.decimal);;)if(b/=h,c++,!(b>h))break;return d[c]?Math.max(b,.1).toFixed(1)+" "+d[c]:Math.max(b,.1).toFixed(1)+" ~*"+c*h+" * "+h+" B"}}(this),a.innerHTML=g(i)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.GoogleMap=function(a){function b(){return this.apply=B(this.apply,this),this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.init=function(a,b,c,d){return this.apply(a,this.getValue(b))},b.prototype.update=function(a,b,c,d){return this.apply(a,this.getValue(b))},b.prototype.apply=function(a,b){var c,d,e,f;if(console.log(a,b),c=new google.maps.LatLng(b.lat,b.lng),e={zoom:b.zoom,center:c,mapTypeId:b.type},d=new google.maps.Map(a,e),b.markers)return f={position:c,map:d},new google.maps.Marker(f)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Hidden=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b){var c;return c=!this.getValue(b),ko.bindingHandlers.visible.update(a,function(){return c})},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Href=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}var c;return D(b,a),c=function(a){var b;if("a"===a.tagName.toLowerCase())return b=function(){var b,c,d,e,f,g;for(f=jQuery(a).find("a"),g=[],d=0,e=f.length;d<e;d++)c=f[d],b=jQuery(c),g.push(b.replaceWith(b.contents()));return g},setTimeout(b,0)},b.prototype.init=function(a,b,d){var e;if(e=this.getValue(b),!a.href&&e&&j(a,"href"),c(a),d.get("stopPropagation")||!1)return ko.utils.registerEventHandler(a,"click",function(a){return a.stopPropagation()})},b.prototype.update=function(a,b,d){var e,f;return c(a),e=this.getValue(b),e?(f=d.get("target")||"",j(a,"href"),j(a,"target"),a.getAttribute("href")!==e&&a.setAttribute("href",e),a.getAttribute("target")!==f?a.setAttribute("target",f):void 0):a.removeAttribute("href")},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Html=function(a){function c(){return this.update=B(this.update,this),c.__super__.constructor.apply(this,arguments)}return D(c,a),c.prototype.init=function(a,b,c,d){return{controlsDescendantBindings:!0}},c.prototype.update=function(a,c,d,e){var f,g,h;return h=this.getValue(c),f=this.getValue(d).plugins,g=new b(a),g.from(f),h=g.getElementValue(a,h),ko.utils.setHtml(a,h)},c}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.HtmlTree=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.drawNode=function(a){var c,d,e,f,g,h,i;if(f=document.createElement("li"),f.innerHTML=a.title,a.children&&a.children.length>0){for(d=document.createElement("ul"),i=a.children,g=0,h=i.length;g<h;g++)e=i[g],c=b.drawNode(e),d.appendChild(c);f.appendChild(d)}return f},b.prototype.getData=function(a){var b;return b=this.getValue(a)||[],b.data?this.getValue(b.data)||[]:b},b.prototype.update=function(a,c,d,e){var f,g;return f=this.getValue(c),A("HtmlTree is experimental, do not use"),g=function(c){return function(){var c;return c=b.drawNode(f),a.innerHTML="",a.appendChild(c)}}(),setTimeout(g,0)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.HtmlValue=function(a){function c(a){null==a&&(a={}),this.update=B(this.update,this),this.init=B(this.init,this),c.__super__.constructor.call(this,a),ko.bindingHandlers.sortable&&ko.bindingHandlers.sortable.options&&(ko.bindingHandlers.sortable.options.cancel=":input,button,[contenteditable]")}var d;return D(c,a),d=0,c.prototype.getElementValue=function(a){return a.innerHTML},c.prototype.setElementValue=function(a,b){return a.innerHTML=b},c.prototype.init=function(a,c,e){var f,g,h,i,j;a.setAttribute("contenteditable",!0),a.id||(a.id="maslosoft-binder-htmlvalue-"+d++),f=this.getValue(e).plugins,j=new b(a),j.from(f),i=function(b){return function(){var d,e,f;if(a&&(a=document.getElementById(a.id)))return d=c(),f=b.getValue(c),e=b.getElementValue(a),ko.isWriteableObservable(d)&&(e=j.getModelValue(a,e),f!==e)?d(e):void 0}}(this),g=function(a){return function(){return setTimeout(i,0)}}(),jQuery(a).on("keyup, input",i),jQuery(document).on("mouseup",g),jQuery(document).on("changed.htmlvalue",i),h=function(a){return jQuery(a).off("keyup, input",i),jQuery(document).off("mouseup",g),jQuery(document).off("changed.htmlvalue",i)},ko.utils.domNodeDisposal.addDisposeCallback(a,h)},c.prototype.update=function(a,c,d){var e,f,g;g=this.getValue(c),e=this.getValue(d).plugins,f=new b(a),f.from(e),g=f.getElementValue(a,g),this.getElementValue(a)!==g&&this.setElementValue(a,g)},c}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Icon=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(d=$(a),m=this.getValue(b),g=this.getValue(c),i=c.get("iconField")||"icon",!m)return void(console&&(console.warn("Binding value for `icon` binding not defined, skipping. Element:"),console.warn(a),console.warn((new Error).stack)));q=m[i],k=!1,q.match(/\.(svg)$/)&&(k=!0),n="",q.match(/\.(jpg|jped|gif|png|svg)$/)&&(l=q.match(/[^\/]*?\.(jpg|jped|gif|png|svg)$/),n=l[0],q=q.replace(/[^\/]*?\.(jpg|jped|gif|png|svg)$/,"")),!n&&m.filename&&(n=m.filename),f=void 0===m.iconSize?16:m.iconSize,p=c.get("iconSize")||f,o=new RegExp("/"+f+"/","g"),j=void 0===m.isImage||m.isImage,k&&(j=!1),j?(q.match(new RegExp("/$"))||(q+="/"),q=q.match(new RegExp("/w/","g"))?q.replace(o,"/"+p+"/"):q+"w/"+p+"/h/"+p+"/p/0/",m.updateDate&&(e=null,e=m.updateDate.sec?m.updateDate.sec:m.updateDate,"number"==typeof e&&(q+=e),"string"==typeof e&&(q+=e))):(h=16,p>16&&(h=32),p>32&&(h=48),p>48&&(h=512),q=q.replace(o,"/"+h+"/")),q.match(/\/$/)?q+=n:q=q+"/"+n,g.cachebusting&&(q=q+"?"+(new Date).getTime()),d.attr("src")!==q&&(g.preloader&&d.attr("src",g.preloader),u(d,q)),d.css({width:p+"px",height:"auto",maxWidth:"100%"})},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Id=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.init=function(a){return j(a,"id")},b.prototype.update=function(a,b){var c;if(c=this.getValue(b),a.getAttribute("id")!==c)return a.setAttribute("id",c)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Log=function(a){function b(){return this.init=B(this.init,this),this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b,c){return console.log(this.getValue(b),a)},b.prototype.init=function(a,b,c,d){return console.log(this.getValue(b),a)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.PickaDate=function(a){function b(a){this.update=B(this.update,this),this.init=B(this.init,this),this.getModelValue=B(this.getModelValue,this),this.getDisplayValue=B(this.getDisplayValue,this),this.updateModel=B(this.updateModel,this),b.__super__.constructor.call(this,new Maslosoft.Binder.DateOptions(a))}return D(b,a),b.prototype.updateModel=function(a,b,c){var d,e;if(e=this.getValue(b),d=this.getModelValue(a.value),ko.isWriteableObservable(b),e!==d)return ko.expressionRewriting.writeValueToProperty(b(),c,"datePicker",d),d},b.prototype.getDisplayValue=function(a){return"unix"===this.options.sourceFormat?moment.unix(a).format(this.options.displayFormat):moment(a,this.options.sourceFormat).format(this.options.displayFormat)},b.prototype.getModelValue=function(a){return"unix"===this.options.sourceFormat?moment(a,this.options.displayFormat).unix():moment(a,this.options.displayFormat).format(this.options.sourceFormat)},b.prototype.init=function(a,b,c,d){var e,f,g,h,i,j,k,l,m;g=this.getDisplayValue(this.getValue(b)),m=jQuery(a),m.val(g),l=this.options.template?this.options.template:'<div class="input-group-addon">\n\t<a class="picker-trigger-link" style="cursor: pointer;">\n\t\t<i class="glyphicon glyphicon-calendar"></i>\n\t</a>\n</div>',k=jQuery(l),k.insertAfter(m),j=k.find("a.picker-trigger-link"),h={format:this.options.displayFormat.toLowerCase(),selectMonths:!0,selectYears:!0},e=j.pickadate(h),i=e.pickadate("picker"),i.on("set",function(d){return function(){m.val(i.get("value")),d.updateModel(a,b,c)}}(this)),f={},f.change=function(d){return function(){var e;(e=Date.parse(a.value))&&(i.set("select",[e.getFullYear(),e.getMonth(),e.getDate()]),d.updateModel(a,b,c))}}(this),f.keyup=function(a){86===a.which&&a.ctrlKey&&f.change()},f.mouseup=f.change,f.focus=function(a){return function(){i.open(!1)}}(),f.blur=function(d){return function(e){e.relatedTarget||(i.close(),d.updateModel(a,b,c))}}(this),m.on(f),j.on("click",function(a){var b,c;c=jQuery(i.$root[0]),b=jQuery(c.children()[0]).height()>0,b?i.close():i.open(!1),a.stopPropagation(),a.preventDefault()})},b.prototype.update=function(a,b){var c;if(ko.utils.setTextContent(a,b()),c=this.getDisplayValue(this.getValue(b)),a.value!==c)return a.value=c},b}(this.Maslosoft.Binder.Picker),this.Maslosoft.Binder.Placeholder=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.init=function(a){return j(a,"placeholder")},b.prototype.update=function(a,b){var c;if(c=this.getValue(b),a.getAttribute("placeholder")!==c)return c=$("<div/>").html(c).text(),a.setAttribute("placeholder",c)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Select2=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}var c,d,e,f;return D(b,a),c="select2",d=c+"Data",f=function(a,b){var c,d;c=ko.isObservable(b),d=void 0,c&&(d=b.equalityComparer,b.equalityComparer=function(){return!0}),$(a).trigger("change"),c&&(b.equalityComparer=d)},e=function(a,b,c,e,g){var h,i,j,k,l;i=ko.unwrap(b()),h=c(),k=!1,j=null,l=null,$(a).on("select2:selecting select2:unselecting",function(){k=!0}),$(a).on("select2:select select2:unselect",function(){k=!1}),ko.isObservable(h.value)?l=h.value.subscribe(function(b){k||f(a,this._target||this.target)}):ko.isObservable(h.selectedOptions)&&(l=h.selectedOptions.subscribe(function(b){k||f(a,this._target||this.target)})),ko.isWriteableObservable(h[d])&&(j=function(){$(a).data("select2")&&h[d]($(a).select2("data"))},$(a).on("change",j)),$(a).select2(i),h.selectedOptions&&$(a).val(h.selectedOptions).trigger("change"),ko.utils.domNodeDisposal.addDisposeCallback(a,function(){$(a).select2("destroy"),null!==j&&$(a).off("change",j),null!==l&&l.dispose()})},b.prototype.init=function(){var a,b;return a=arguments,b=function(){return e.apply(null,a)},setTimeout(b,0)},b.prototype.update=function(a,b,c){},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Selected=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Binder.CssOptions({className:"selected"}))}return D(b,a),b}(this.Maslosoft.Binder.CssClass),this.Maslosoft.Binder.Src=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.init=function(a){return j(a,"src")},b.prototype.update=function(a,b){var c;if(c=this.getValue(b),a.getAttribute("src")!==c)return a.setAttribute("src",c)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Tags=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),this.setTags=B(this.setTags,this),b.__super__.constructor.apply(this,arguments)}var c,d;return D(b,a),c="<style>\n\tbody.kill-all-select2-dropdowns .select2-dropdown {\n\t\tdisplay: none !important;\n\t}\n\tbody.kill-all-select2-dropdowns .select2-container--default.select2-container--open.select2-container--below .select2-selection--single, .select2-container--default.select2-container--open.select2-container--below .select2-selection--multiple\n\t{\n\t\tborder-bottom-left-radius: 4px;\n\t\tborder-bottom-right-radius: 4px;\n\t}\n\t.select2-container--default.select2-container--focus .select2-selection--multiple {\n\t\tborder-color: #66afe9;\n\t\toutline: 0;\n\t\t-webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102,175,233,.6);\n\t\tbox-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102,175,233,.6);\n\t}\n</style>",d=!0,b.prototype.setTags=function(a,b){var c,d,e,f,g,h,i;for(e=a.find("option"),e.length&&e.remove(),i=[],c=g=0,h=b.length;g<h;c=++g)f=b[c],d=jQuery("<option selected='true'></option>"),d.val(f),d.text(f),i.push(a.append(d));return i},b.prototype.init=function(a,b,e,f,g){var h,i,j,k,l,m,n,o,p;if("select"!==a.tagName.toLowerCase())throw new Error("Tags binding must be placed on `select` element");return d&&(jQuery(c).appendTo("head"),d=!1),k=this.getValue(b),p=k.data?k.data:k,j=JSON.parse(JSON.stringify(p)),m=jQuery(a),m.data("tags",!0),m.attr("multiple",!0),this.setTags(m,j),i={placeholder:k.placeholder,tags:!0,tokenSeparators:[","," "]},o=function(){var a;if(k.inputCss)return a=m.parent().find(".select2-search__field"),a.addClass(k.inputCss),a.attr("placeholder",k.placeholder)},k.tagCss&&(i.templateSelection=function(a,b){return b.removeClass("select2-selection__choice"),b.addClass(k.tagCss),a.selected,jQuery("<span>"+a.text+"</span>")}),n=function(a){return function(){var a,b,c,d,e;if(p.removeAll?p.removeAll():p=[],a=m.val())for(b=d=0,e=a.length;d<e;b=++d)c=a[b],(c=c.replace(",","").replace(" ","").trim())&&p.push(c);return o()}}(),l=function(a){return function(a){if(jQuery(a.target).data())return jQuery("body").toggleClass("kill-all-select2-dropdowns","select2:opening"===a.type)}}(),h=function(b){return function(){return m.select2(i),o(),m.on("change",n),m.on("select2:select select2:unselect",n),m.on("select2:opening select2:close",l),ko.utils.domNodeDisposal.addDisposeCallback(a,function(){if(m.select2("destroy"),null!==n)return m.off("change",n),m.off("select2:select select2:unselect",n)})}}(),setTimeout(h,0)},b.prototype.update=function(a,b,c){var d,e,f,g,h;return e=this.getValue(b),h=e.data?e.data:e,d=JSON.parse(JSON.stringify(h)),f=jQuery(a),g=function(a){return function(){var b,c;if(b=null===f.val()?"":f.val().join(",").replace(/(,+)/g,",").replace(/(\s+)/g," "),c=h.join(","),b!==c)return a.setTags(f,d)}}(this),setTimeout(g,0)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Text=function(a){function c(){return this.update=B(this.update,this),c.__super__.constructor.apply(this,arguments)}return D(c,a),c.prototype.init=function(a,b,c,d){return{controlsDescendantBindings:!0}},c.prototype.update=function(a,c,d,e){var f,g,h;return h=n(this.getValue(c)),f=this.getValue(d).plugins,g=new b(a),g.from(f),h=g.getElementValue(a,h),ko.utils.setHtml(a,h)},c}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.TextToBg=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.init=function(a,b,c,d){},b.prototype.update=function(a,b,c,d){var e;return e=this.getValue(b),jQuery(a).css("background-color",y(e))},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.TextValue=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.getElementValue=function(a){return a.textContent||a.innerText||""},b.prototype.setElementValue=function(a,b){if(void 0!==a.textContent&&(a.textContent=b),void 0!==a.innerText)return a.innerText=b},b}(this.Maslosoft.Binder.HtmlValue),this.Maslosoft.Binder.TextValueHLJS=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.getElementValue=function(a){return a.textContent||a.innerText||""},b.prototype.setElementValue=function(a,b){if(void 0!==a.textContent&&(a.textContent=b,hljs&&hljs.highlightBlock(a)),void 0!==a.innerText&&(a.innerText=b,hljs))return hljs.highlightBlock(a)},b}(this.Maslosoft.Binder.HtmlValue),this.Maslosoft.Binder.TimeAgoFormatter=function(a){function b(a){this.update=B(this.update,this),b.__super__.constructor.call(this,new Maslosoft.Binder.TimeAgoOptions(a))}return D(b,a),b.prototype.update=function(a,b){var c;c=this.getValue(b),a.innerHTML=moment[this.options.sourceFormat](c).fromNow()},b}(this.Maslosoft.Binder.MomentFormatter),this.Maslosoft.Binder.TimeFormatter=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Binder.TimeOptions(a))}return D(b,a),b}(this.Maslosoft.Binder.MomentFormatter),this.Maslosoft.Binder.TimePicker=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Tooltip=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b){var c;c=this.getValue(b),$(a).attr("title",c),$(a).attr("data-original-title",c),$(a).attr("rel","tooltip")},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Tree=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b){},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.TreeGrid=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}var c;return D(b,a),c=function(a,b,c,d){return function(){var a,e,f,g,h,i;return g=b(),(i=ko.utils.peekObservable(g))&&"number"!=typeof i.length?(a=ko.observableArray([]),f=ko.observableArray([]),e=-1,h=function(b){var c,d,g,i,j,k;for(e++,k=[],i=0,j=b.length;i<j;i++)g=b[i],d=g.children&&g.children.length&&g.children.length>0,c={depth:e,hasChilds:d},g._treeGrid=ko.tracker.factory(c),a.push(g),f.push(e),d?(h(g.children),k.push(e--)):k.push(void 0);return k},h(i.data.children?i.data.children:i.data),c&&(c.tree=i.data,c.data=a,c.widget=d),ko.utils.unwrapObservable(g),{foreach:a,depths:f,as:i.as,includeDestroyed:i.includeDestroyed,afterAdd:i.afterAdd,beforeRemove:i.beforeRemove,afterRender:i.afterRender,beforeMove:i.beforeMove,afterMove:i.afterMove,templateEngine:ko.nativeTemplateEngine.instance}):{foreach:g,templateEngine:ko.nativeTemplateEngine.instance}}},b.prototype.init=function(a,b,d,e,f){var g,h,i,j,k,l;return k=this.getValue(b),g=k.activeClass,j=jQuery(a),l=new Maslosoft.Binder.Widgets.TreeGrid.TreeGridView(a,b),l.init(),g&&(h=function(a){return j.find("tr").removeClass(g),jQuery(a.currentTarget).addClass(g),!0},j.on("click","tr",h),i=function(a){return l.dispose(),jQuery(a).off("click","tr",h)},ko.utils.domNodeDisposal.addDisposeCallback(a,i)),ko.bindingHandlers.template.init(a,c(a,b,f,l),d,e,f),{controlsDescendantBindings:!0}},b.prototype.update=function(a,b,d,e,f){var g;return g=new Maslosoft.Binder.Widgets.TreeGrid.TreeGridView(a,b,"update"),ko.bindingHandlers.template.update(a,c(a,b,f,g),d,e,f)},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.TreeGridNode=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.init=function(a,b,c,d,e){},b.prototype.update=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;return ko.utils.toggleDomNodeCssClass(a,"tree-grid-drag-handle",!0),m=[],g=this.getValue(b),k=g._treeGrid,f=e.widget.config,n=f.nodeIcon,l=f.folderIcon,i=f.expanderIcon||"<i class='glyphicon glyphicon-triangle-bottom'></i>",l&&k.hasChilds&&(n=l),h=k.depth,j=[],j.push("<div class='collapsed' style='display:none;transform: rotate(-90deg);'>"+i+"</div>"),j.push("<div class='expanded' style='display:none;transform: rotate(-45deg);'>"+i+"</div>"),m.push("<a class='expander' style='cursor:pointer;text-decoration:none;width:1em;margin-left:"+h+"em;display:inline-block;'>"+j.join("")+"</a>"),h=k.depth+1,m.push("<i class='no-expander' style='margin-left:"+h+"em;display:inline-block;'></i>"),m.push("<img src='"+n+"' style='width: 1em;height:1em;margin-top: -.3em;display: inline-block;'/>"),a.innerHTML=m.join("")+a.innerHTML},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.Validator=function(a){function c(a){this.update=B(this.update,this),this.init=B(this.init,this),c.__super__.constructor.call(this,new Maslosoft.Binder.ValidatorOptions)}var d;return D(c,a),d=0,c.prototype.getElementValue=function(a){return"input"===a.tagName.toLowerCase()?a.value:"textarea"===a.tagName.toLowerCase()?a.value:a.textContent||a.innerText||""},c.prototype.init=function(a,c,e,f){var g,h,j,k,l,m,n;return h=this.getValue(c),g=this.options.classField,m=new b(a,g),n=m.from(h),l=new i(n,this.options),l.init(a),a.id||(a.id="Maslosoft-Ko-Binder-Validator-"+d++),k=this.getElementValue(a),j=function(b){return function(c){var d;if(a&&(a=document.getElementById(a.id)))return d=b.getElementValue(a),k!==d?(k=d,l.validate(a,d)):void 0}}(this),ko.utils.registerEventHandler(a,"keyup, input",j),ko.utils.registerEventHandler(document,"mouseup",j)},c.prototype.update=function(a,b,c){},c}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.VideoPlaylist=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.initVideos=null,b.prototype.getData=function(a){var b;return b=this.getValue(a)||[],b.data?b.data:b},b.prototype.init=function(a,b,c,d){},b.prototype.update=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n;for(e=this.getData(b),g=this.getValue(b||{}),k=g.urlField||"url",i=g.urlField||"title",f=[],m=0,n=e.length;m<n;m++)l=e[m],j=l[k],h=l[i],this.isVideoUrl(j)&&f.push("<a href='"+j+"'>"+h+"</a>");return a.innerHTML=f.join("\n"),f.length?(ko.utils.toggleDomNodeCssClass(a,"maslosoft-playlist",!0),new Maslosoft.Playlist(a)):ko.utils.toggleDomNodeCssClass(a,"maslosoft-playlist",!1)},b}(this.Maslosoft.Binder.Video),this.Maslosoft.Binder.VideoThumb=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.init=function(a,b,c,d){},b.prototype.update=function(a,b){var c;return c=this.getValue(b),this.setThumb(c,a)},b}(this.Maslosoft.Binder.Video),this.Maslosoft.Binder.Widget=function(a){function b(){return this.update=B(this.update,this),this.init=B(this.init,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.init=function(a,b,c,d){var e,f,g,h,i,j;if(e=this.getValue(b),"string"!=typeof(h=c.get("ref"))&&h)"object"==typeof h&&(j=h);else{if("function"!=typeof e)return;if("function"!=typeof e.constructor)return;try{j=new e}catch(a){return void a}h&&w(h,j),h&&(h=j)}if(g=c.get("params"))for(f in g)i=g[f],j[f]=i;if("function"==typeof j.init&&j.init(a),"function"==typeof j.dispose)return ko.utils.domNodeDisposal.addDisposeCallback(a,j.dispose)},b.prototype.update=function(a,b){},b}(this.Maslosoft.Binder.Base),this.Maslosoft.Binder.WidgetAction=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b,c){var d,e;return d=this.getData(a,b,c,"action"),e=this.createUrl(d.id,d.action,d.params,"?"),a.setAttribute("href",e),this.setRel(a)},b}(this.Maslosoft.Binder.WidgetUrl),this.Maslosoft.Binder.WidgetActivity=function(a){function b(){return this.update=B(this.update,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.update=function(a,b,c){var d,e;return d=this.getData(a,b,c,"activity"),e=this.createUrl(d.id,d.activity,d.params,"#"),a.setAttribute("href",e),this.setRel(a)},b}(this.Maslosoft.Binder.WidgetUrl),b=function(){function a(a,b){this.element=null!=a?a:null,this.classField=null!=b?b:"_class",this.getModelValue=B(this.getModelValue,this),this.getElementValue=B(this.getElementValue,this),this.plugins=new Array}return a.prototype.classField="_class",a.prototype.element=null,a.prototype.plugins=null,a.prototype.from=function(a){var b,c,d,e,f,g,h,i,j,k;if(f=this.element,c=this.classField,this.plugins=new Array,ko.isObservable(a)&&(a=ko.unwrap(a)),!a)return this.plugins;for(b=a.constructor===Array?a:[a],j=0,k=b.length;j<k;j++)if(e=b[j],e[c]){if("function"==typeof e[c]){d=e[c],delete e[c],h=new d;for(g in e)i=e[g],h[g]=null,h[g]=i;return this.plugins.push(h),this.plugins}m("Parameter `"+c+"` must be plugin compatible class, binding defined on element:",f)}else m("Parameter `"+c+"` must be defined for plugin on element:",f)},a.prototype.getElementValue=function(a,b){var c,d,e,f;for(f=this.plugins,d=0,e=f.length;d<e;d++)c=f[d],"function"==typeof c.getElementValue&&(b=c.getElementValue(a,b));return b},a.prototype.getModelValue=function(a,b){var c,d,e,f;for(f=this.plugins,d=0,e=f.length;d<e;d++)c=f[d],"function"==typeof c.getModelValue&&(b=c.getModelValue(a,b));return b},a}(),c=function(){function a(a,b,c,d){this.events=c,this.dragDrop=B(this.dragDrop,this),this.dragEnd=B(this.dragEnd,this),this.draggable={},this.draggable.scroll=!1,this.tree={},this.tree=a,this.finder=new g(this.tree),this.el=jQuery(b)}return a.prototype.autoExpandMS=400,a.prototype.focusOnClick=!1,a.prototype.preventVoidMoves=!0,a.prototype.preventRecursiveMoves=!0,a.prototype.tree=null,a.prototype.finder=null,a.prototype.draggable=null,a.prototype.events=null,a.el=null,function(a){},a.prototype.dragStart=function(a,b){return!0},a.prototype.dragEnter=function(a,b){return!0},a.prototype.dragEnd=function(a,b){return s("drag end..."),!0},a.prototype.dragDrop=function(a,b){var c,d,e,f,g,h,i,j,k;return g=b.hitMode,e=b.draggable.element[0],this.events.drop(a,b),b.otherNode?(i=this.finder.find(b.otherNode.parent.data.id),d=this.events.getNode(this.finder.find(b.otherNode.data.id)),this.el.is(e)||(s("From other instance..."),b=ko.dataFor(e),s(b),setTimeout(f,0))):(c=ko.contextFor(e),d=this.events.getNode(c.$data)),j=this.finder.find(a.data.id),k=this.finder.find(a.parent.data.id),i&&i.children.remove(d),this.tree.children.remove(d),k&&k.children.remove(d),"over"===g&&j.children.push(d),"before"===g&&(k?(h=k.children.indexOf(j),k.children.splice(h,0,d)):(h=this.tree.children.indexOf(j),this.tree.children.splice(h,0,d))),"after"===g&&(k?k.children.push(d):this.tree.children.push(d)),f=function(a){return function(b){return s(b),a.el.fancytree("option","source",a.tree.children),a.el.fancytree("getRootNode").visit(function(a){return a.setExpanded(!0)}),a.el.focus(),s("update tree..",a.el)}}(this),setTimeout(f,0),!0},a}(),d=function(){function a(a,b,c,d){this.dragDrop=B(this.dragDrop,this),this.dragEnd=B(this.dragEnd,this),this.draggable={},this.draggable.scroll=!1,this.tree={},this.tree=a,this.finder=new g(this.tree),this.el=jQuery(b)}return a.prototype.focusOnClick=!1,a.prototype.tree=null,a.prototype.finder=null,a.prototype.draggable=null,a.el=null,function(a){},a.prototype.dragStart=function(a,b){return!0},a.prototype.dragEnter=function(a,b){return!1},a.prototype.dragEnd=function(a,b){return s("drag end..."),!0},a.prototype.dragDrop=function(a,b){return!1},a}(),e=function(){function a(a,b,d){this.events=b,this.options=d,this.handle=B(this.handle,this),this.getNode=B(this.getNode,this),this.drop=B(this.drop,this),c=new g(a),this.handle("click"),this.handle("dblclick"),this.handle("activate"),this.handle("deactivate")}var b,c,d;return a.prototype.events=null,a.prototype.dropEvent=null,a.prototype.options=null,c=null,b=function(a){return void 0===a.targetType||("title"===a.targetType||("icon"===a.targetType||void 0))},d=function(a){return a.stopPropagation()},a.prototype.drop=function(a,b){if(s("Drop..."),s(this.events),this.events.drop)return this.dropEvent=new this.events.drop(a,b),s(this.dropEvent)},a.prototype.getNode=function(a){return s("Tree event drop..."),s(this.dropEvent),this.dropEvent&&this.dropEvent.getNode?this.dropEvent.getNode(a):a},a.prototype.handle=function(a){if(this.events[a])return this.options[a]=function(e){return function(f,g){var h;if(b(g))return h=c.find(g.node.data.id),e.events[a](h,g,f),d(f)}}(this)},a}(),f=function(){function a(){}var b;return b={},a.prototype.get=function(a){return void 0!==b[a]&&b[a]},a.prototype.set=function(a,c){return b[a]=c},a}(),g=function(){function a(a){d.push(a)}var b,c,d;return b=new f,d=[],c=function(a,d){var e,f,g,h,i,j;if(void 0===d)return!1;if(f=b.get(d))return f;if(a.id===d)return a;if(a._id===d)return a;if(a.children&&a.children.length>0)for(j=a.children,h=0,i=j.length;h<i;h++)if(e=j[h],!1!==(g=c(e,d)))return b.set(d,g),g;return!1},a.prototype.find=function(a){var b,e,f,g;for(f=0,g=d.length;f<g;f++)if(e=d[f],b=c(e,a))return b;return!1},a}(),h=function(){function a(a,c,d,e){this.icon=d,this.folderIcon=e,this.render=B(this.render,this),b=new g(a)}var b;return a.prototype.icon="",a.prototype.folderIcon="",a.prototype.renderer=null,b=null,a.prototype.setRenderer=function(a){if(this.renderer=a,"function"!=typeof this.renderer.render)return console.error("Renderer must have function `render`")},a.prototype.render=function(a,c){var d,e,f,g,h,i;h=c.node;for(f in c)if(c[f],"originalEvent"===f)return;if(i=jQuery(h.span).find("> span.fancytree-title"),this.renderer&&this.renderer.render&&(g=b.find(h.data.id),this.renderer.render(g,i)),this.icon||this.folderIcon)return d=i.html(),e=this.folderIcon&&h.children&&h.children.length?this.folderIcon:this.icon,i.html("<i class='node-title-icon' style='background-image:url("+e+")'></i> "+d)},a}(),i=function(){function a(a,b){this.validators=a,this.options=b,this.adviseOne=B(this.adviseOne,this),this.validateOne=B(this.validateOne,this),this.init=B(this.init,this),this.setElement=B(this.setElement,this),this.validate=B(this.validate,this)}var b,c,d;return a.prototype.element=null,a.prototype.parent=null,a.prototype.errors=null,a.prototype.warnings=null,d=ko.utils.toggleDomNodeCssClass,b=function(a){return ko.utils.toggleDomNodeCssClass(a,"hide",!0)},c=function(a){return ko.utils.toggleDomNodeCssClass(a,"hide",!1)},a.prototype.validate=function(a,b){var c,d,e,f,g,h,i;for(this.setElement(a),h=this.validators,d=0,f=h.length;d<f;d++)if(c=h[d],!this.validateOne(c,b))return!1;for(i=this.validators,e=0,g=i.length;e<g;e++)c=i[e],"function"==typeof c.getWarnings&&this.adviseOne(c,b);return!0},a.prototype.setElement=function(a){return this.element=a,this.parent=jQuery(this.element).parents(".form-group")[0],this.parent?(this.errors=this.parent.querySelector(this.options.errorMessages),this.warnings=this.parent.querySelector(this.options.warningMessages),b(this.errors),b(this.warnings),this):this},a.prototype.init=function(a){return this.setElement(a)},a.prototype.validateOne=function(a,e){var f,g,h,i,j,k;return f=this.element,j=this.parent,g=this.errors,k=this.warnings,i=new Array,a.reset(),h=!1,a.isValid(e)?(this.options.inputError&&d(f,this.options.inputError,!1),this.options.inputSuccess&&d(f,this.options.inputSuccess,!0),j&&(this.options.parentError&&d(j,this.options.parentError,!1),this.options.parentSuccess&&d(j,this.options.parentSuccess,!0)),g&&(b(g),g.innerHTML=""),h=!0):(i=a.getErrors(),this.options.inputError&&d(f,this.options.inputError,!0),this.options.inputSuccess&&d(f,this.options.inputSuccess,!1),j&&(this.options.parentError&&d(j,this.options.parentError,!0),this.options.parentSuccess&&d(j,this.options.parentSuccess,!1)),g&&i&&(c(g),g.innerHTML=i.join("<br />")),h=!1),this.options.inputWarning&&d(f,this.options.inputWarning,!1),j&&this.options.parentWarning&&d(j,this.options.parentWarning,!1),k&&(b(k),k.innerHTML=""),h},a.prototype.adviseOne=function(a,b){var e,f,g,h;return e=this.element,g=this.parent,this.errors,h=this.warnings,f=a.getWarnings(),f.length&&(this.options.inputWarning&&d(e,this.options.inputWarning,!0),this.options.inputSuccess&&d(e,this.options.inputSuccess,!1),g&&(this.options.parentWarning&&d(g,this.options.parentWarning,!0),this.options.parentSuccess&&d(g,this.options.parentSuccess,!1)),h&&(c(h),h.innerHTML=f.join("<br />"))),this},a}(),this.Maslosoft.Binder.Widgets.TreeGrid||(this.Maslosoft.Binder.Widgets.TreeGrid={}),Maslosoft.Binder.Widgets.TreeGrid.Dnd=function(){function a(a){var b;this.grid=a,this.dragHelper=B(this.dragHelper,this),this.clear=B(this.clear,this),this.move=B(this.move,this),this.dragOver=B(this.dragOver,this),this.over=B(this.over,this),this.drop=B(this.drop,this),this.stop=B(this.stop,this),this.drag=B(this.drag,this),this.dragStart=B(this.dragStart,this),this.grid.config.dnd&&("init"===this.grid.context&&(ko.utils.domNodeDisposal.addDisposeCallback(this.grid.element.get(0),function(){var a;try{if(this.grid.element)return this.grid.element.draggable("destroy"),this.grid.element.droppable("destroy")}catch(b){return a=b,console.log(a.message)}}),this.grid.element.on("mousemove","> tr",this.move)),f||(f=new Maslosoft.Binder.Widgets.TreeGrid.DropIndicator(this.grid)),b=function(a){return function(){var b,c;return b={handle:".tree-grid-drag-handle",cancel:".expander, input, *[contenteditable], .no-drag",revert:!1,cursor:"pointer",cursorAt:{top:5,left:5},start:a.dragStart,drag:a.drag,stop:a.stop,helper:a.dragHelper},c={tolerance:"pointer",drop:a.drop,over:a.over},a.grid.element.find("> tr").draggable(b),a.grid.element.find("> tr").droppable(c)}}(this),setTimeout(b,0))}var b,c,d,e,f,g;return a.prototype.grid=null,a.prototype.helper=null,f=null,d=null,c=null,e=null,g=null,b=!1,a.prototype.dragStart=function(a){return c=a.target},a.prototype.drag=function(a,b){},a.prototype.stop=function(a,c){if(!b)return this.drop(a,c)},a.prototype.drop=function(a,f){var g,h,i,j,k;return b=!0,c&&d&&d.get(0)?(g=ko.dataFor(c),h=ko.dataFor(d.get(0)),this.grid.canDrop(c,d,e)?(this.grid.freeze(),i=this.grid.getParent(h),k=this.grid.getRoot(),j=i.children?i.children:i,function(a){return function(){var b;return a.grid.remove(g),"over"===e&&h.children.push(g),"before"===e&&(b=j.indexOf(h),j.splice(b,0,g)),"after"===e&&(h.children.length?j.splice(0,0,g):j.push(g)),"last"===e&&(k.children?k.children.push(g):k.push(g)),a.clear()}}(this)()):this.clear()):this.clear()},a.prototype.over=function(a){if("tr"===a.target.tagName.toLowerCase()&&d!==a.target)return d=jQuery(a.target),this.dragOver(a)},a.prototype.dragOver=function(a){if(f)return f.precise.over(c,d,e,f)},a.prototype.move=function(a){var b,f,h;if(c&&a.currentTarget===c&&(d&&c===d.get(0)||(a.target=c,this.over(a))),d&&(b=d.offset(),f={},f.x=a.pageX-b.left,f.y=a.pageY-b.top,h={},h.x=f.x/d.outerWidth(!0),h.y=f.y/d.outerHeight(!0),e="over",h.y>.65&&(e="after"),h.y<=.25&&(e="before"),"after"===e&&this.grid.isLast(ko.dataFor(d.get(0)))&&(e="last"),g!==e))return g=e,a.target=d,this.dragOver(a)},a.prototype.clear=function(){if(this.grid.thaw(),d=null,c=null,e=null,g=null,b=!1,this.helper&&(this.helper.hide(),this.helper=null),f)return f.hide()},a.prototype.dragHelper=function(a){var b,c,d,e;return e=jQuery(a.currentTarget).parent(),b=e.find(".tree-grid-drag-handle").parents("td").first(),d=b.clone(),d.find(".expander .expanded").remove(),d.find(".expander .collapsed").remove(),d.find(".expander").remove(),d.find(".no-expander").remove(),c="<span class='drop-indicator'>&times;</span>",this.helper=jQuery("<div style='white-space:nowrap;'>"+c+d.html()+"</div>"),this.helper.css("pointer-events","none"),f.attach(this.helper.find(".drop-indicator")),this.helper},a}(),Maslosoft.Binder.Widgets.TreeGrid.DropIndicator=function(){function a(a){this.grid=a,this.precise=new Maslosoft.Binder.Widgets.TreeGrid.InsertIndicator(this.grid)}return a.precise=null,a.element=null,a.prototype.attach=function(a){return this.element=a,this.element.css({"font-size":"1.5em"}),this.element.css({width:"1em"}),this.element.css({height:"1em"}),this.element.css({position:"absolute"}),this.element.css({left:"-.75em"}),this.element.css({top:"-.35em"})},a.prototype.hide=function(){return this.element.hide(),this.precise.hide()},a.prototype.show=function(){return this.element.show(),this.precise.show()},a.prototype.accept=function(){return this.element.html("&check;"),this.element.css({color:"green"}),this.precise.accept()},a.prototype.deny=function(){return this.element.html("&times;"),this.element.css({color:"red"}),this.precise.deny()},a}(),Maslosoft.Binder.Widgets.TreeGrid.Events=function(){function a(a,b){this.grid=a,this.grid.config.on}return a.prototype.grid=null,a}(),Maslosoft.Binder.Widgets.TreeGrid.Expanders=function(){function a(a,b){this.grid=a,this.cancelClick=B(this.cancelClick,this),this.handler=B(this.handler,this),this.updateExpanders=B(this.updateExpanders,this),!1!==this.grid.config.expanders&&("init"===this.grid.context&&(this.grid.element.on("mousedown",".expander",this.handler),this.grid.element.on("click",".expander",this.cancelClick)),"update"===this.grid.context&&this.updateExpanders())}var b,c,d;return d=function(a){var b,c;return b=a.find(".expander"),b.find(".expanded:visible").length?(b.find(".expanded").hide(),b.find(".collapsed").show(),c=!1):(b.find(".collapsed").hide(),b.find(".expanded").show(),c=!0),c},c=function(a){var b;return b=a.find(".expander"),b.find(".collapsed").hide(),b.find(".expanded").show()},b=function(a){var b;return b=a.find(".expander"),b.find(".expanded").hide(),b.find(".collapsed").show()},a.prototype.grid=null,a.prototype.updateExpanders=function(){var a,b;return b=function(a){return function(a,b){var c;return c=b.children&&b.children.length,c?(a.find(".no-expander").hide(),a.find(".expander").show(),a.find(".expander .collapsed").is(":visible")?void 0:a.find(".expander .expanded").show()):(a.find(".expander").hide(),a.find(".no-expander").show())}}(),a=function(a){return function(){return a.grid.visit(b)}}(this),setTimeout(a,0)},a.prototype.handler=function(a){var e,f,g,h;return e=ko.contextFor(a.target).$data,a.stopPropagation(),a.preventDefault(),f=-1,h=!1,s("clicked on expander "+e.title),g=function(a){return function(a,g){var i;return i=g._treeGrid.depth,g===e?(f=i,h=d(a),void a.data("treegrid-manual-state",h)):-1!==f?i===f?void(f=-1):i>=f?h?(a.show(),c(a)):(a.hide(),b(a)):void 0:void 0}}(),this.grid.visit(g)},a.prototype.cancelClick=function(a){return a.stopPropagation(),a.preventDefault()},a}(),Maslosoft.Binder.Widgets.TreeGrid.InsertIndicator=function(){function a(a){this.grid=a,d||(this.create(),d=!0)}var b,c,d,e;return a.prototype.grid=null,d=!1,c=null,b=null,e=null,a.prototype.hide=function(){return c.hide()},a.prototype.show=function(){return c.show()},a.prototype.accept=function(){return c.css({color:"green"})},a.prototype.deny=function(){return c.css({color:"red"})},a.prototype.over=function(a,b,d,e){var f,g,h,i,j,k,l,m;return null==d&&(d="over"),this.accept(),e.accept(),"over"===d?this.precise(!1):this.precise(!0),this.grid.canDrop(a,b,d)?(this.accept(),e.accept()):(this.deny(),e.deny()),i=b.find(".tree-grid-drag-handle"),m=0,h=1.5,k=i.offset(),g=c.outerHeight(!0)/h,"over"===d&&(j=i.outerHeight(!0)/h,l=k.top+j-g),"before"===d&&(l=k.top-g),"after"===d&&(l=k.top+i.outerHeight(!0)-g),f=k.left+m,c.css({left:f}),c.css({top:l}),this.show()},a.prototype.precise=function(a){return null==a&&(a=!0),a?e.show():e.hide()},a.prototype.create=function(){return c=jQuery('<div class="tree-grid-insert-indicator" style="display:none;position:absolute;z-index: 10000;color:green;line-height: 1em;">\n\t<span class="tree-grid-insert-indicator-coarse" style="font-size: 1.5em;">\n\t\t&#9654;\n\t</span>\n\t<span class="tree-grid-insert-indicator-precise" style="font-size:1.4em;">\n\t\t&#11835;\n\t</span>\n</div>'),c.appendTo("body"),b=c.find(".tree-grid-insert-indicator-coarse"),e=c.find(".tree-grid-insert-indicator-precise")},a}(),Maslosoft.Binder.Widgets.TreeGrid.TreeGridView=function(){function a(b,c,d){var e,f,g;if(null==c&&(c=null),this.context=null!=d?d:"init",this.getFirstCells=B(this.getFirstCells,this),this.thaw=B(this.thaw,this),this.freeze=B(this.freeze,this),this.remove=B(this.remove,this),this.canDrop=B(this.canDrop,this),this.isLast=B(this.isLast,this),this.have=B(this.have,this),this.getContext=B(this.getContext,this),this.getRoot=B(this.getRoot,this),this.getParent=B(this.getParent,this),this.visitRecursive=B(this.visitRecursive,this),this.element=jQuery(b),c)for(this.config={},this.config=ko.unwrap(c()),g=a.plugins,e=0,f=g.length;e<f;e++)new(0,g[e])(this)}var b;return a.plugins=[Maslosoft.Binder.Widgets.TreeGrid.Expanders,Maslosoft.Binder.Widgets.TreeGrid.Dnd,Maslosoft.Binder.Widgets.TreeGrid.Events],a.prototype.element=null,a.prototype.config=null,a.prototype.init=function(){return jQuery(document).on("ajaxStart",this.freeze),jQuery(document).on("ajaxComplete",this.thaw)},a.prototype.dispose=function(){return jQuery(document).off("ajaxStart",this.freeze),jQuery(document).off("ajaxComplete",this.thaw)},a.prototype.visit=function(a){var b,c,d,e,f,g;for(d=this.element.find("> tr"),g=[],e=0,f=d.length;e<f;e++)c=d[e],b=ko.dataFor(c),g.push(a(jQuery(c),b));return g},a.prototype.visitRecursive=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;if(null==b&&(b=null),b){if(b.children&&b.children.length)for(m=b.children,f=0,j=m.length;f<j;f++)c=m[f],a(b,c),this.visitRecursive(a,c);if(b.length){for(o=[],g=0,k=b.length;g<k;g++)c=b[g],a(b,c),o.push(this.visitRecursive(a,c));return o}}else{if(b=this.getRoot(),a(null,b),b.children&&b.children.length)for(l=b.children,d=0,h=l.length;d<h;d++)c=l[d],a(b,c),this.visitRecursive(a,c);if(b.length){for(n=[],e=0,i=b.length;e<i;e++)c=b[e],a(b,c),n.push(this.visitRecursive(a,c));return n}}},a.prototype.getParent=function(a){var b,c;return b=null,c=function(c,d){if(d===a)return b=c},this.visitRecursive(c),b},a.prototype.getRoot=function(){var a;return a=ko.contextFor(this.element.get(0)),a.tree},a.prototype.getContext=function(){return ko.contextFor(this.element.get(0))},a.prototype.have=function(a,b){var c,d;return c=!1,d=function(a,d){if(d===b)return c=!0},this.visitRecursive(d,a),c},a.prototype.isLast=function(a){var b,c;return c=this.element.find("> tr:last()"),b=ko.dataFor(c.get(0)),a===b},a.prototype.canDrop=function(a,b,c){var d,e;return d=ko.dataFor(a),e=ko.dataFor(b.get(0)),"last"===c||("after"===c||d!==e&&!this.have(d,e))},a.prototype.remove=function(a){var b;return b=function(b,c){if(b)return b.children?b.children.remove(a):b.remove(a)},this.visitRecursive(b)},a.prototype.expandAll=function(){},a.prototype.collapseAll=function(){},b=[],a.prototype.freeze=function(){var a,c,d,e,f,g;for(console.log("Freeze"),b=[],d=this.getFirstCells(),console.log(d),g=[],e=0,f=d.length;e<f;e++)c=d[e],b.push(c.style),a=jQuery(c),g.push(a.css("width",a.width()+"px"));return g},a.prototype.thaw=function(){return function(a){return function(){var c,d,e,f,g,h;for(console.log("thaw"),d=a.getFirstCells(),h=[],e=f=0,g=d.length;f<g;e=++f)c=d[e],h.push(c.style=b[e]);return h}}(this)()},a.prototype.getFirstCells=function(){var a,b;return b=this.element,this.element.is("tbody")&&(b=this.element.parent()),a=b.find("thead tr:first() th"),a&&a.length||(a=b.find("tr:first() td")),a&&a.length||(a=b.find("tbody tr:first() td")),a&&a.length||(a=b.find("tfoot tr:first() th")),a},a}(),this.Maslosoft.Ko.getType=function(a){if(x&&"object"==typeof x){if(x.constructor===Date)return"date";if(x.constructor===Array)return"array"}return typeof x},this.Maslosoft.Ko.objByName=function(a,b){var c,d,e,f,g,h,i;for(null==b&&(b=window),Array.prototype.slice.call(arguments,2),f=a.split("."),c=b,g=[],d=h=0,i=f.length;h<i;d=++h){if(e=f[d],g.push(e),void 0===c[e])throw new Error("Name part `"+g.join(".")+"` not found while accesing "+a);c=c[e]}return c},this.Maslosoft.Ko.Track=function(){function a(){this.fromJs=B(this.fromJs,this),this.factory=B(this.factory,this)}return a.prototype.factory=function(a){var b,c,d,e,f,g,h,i;if(!a)return a;if(a._class&&"string"==typeof a._class){b=a._class.replace(/\\/g,".");try{f=Maslosoft.Ko.objByName(b)}catch(a){a,console.warn("Could not resolve class name `"+b+"`")}if(f)return new f(a);console.warn("Class `"+b+"` not found, using default object"),console.debug(a)}if("object"==typeof a)if(a=ko.track(a,{deep:!0}),Array.isArray(a))for(c=h=0,i=a.length;h<i;c=++h)d=a[c],a[c]=this.factory(d);else for(e in a)g=a[e],a[e]=this.factory(g);return a},a.prototype.fromJs=function(a,b){var c,d,e;e=[];for(c in b)d=b[c],"object"==typeof d?a[c]?e.push(this.fromJs(a[c],d)):e.push(a[c]=this.factory(d)):e.push(a[c]=d);return e},a}(),ko.tracker=new this.Maslosoft.Ko.Track,window.Proxy||(console.warn("Your browser does not support Proxy, will not work properly in some cases..."),window.Proxy=function(){function a(){}return a}()),a=function(){function a(a,b){this.parent=a,this.field=b}return a.prototype.set=function(a,b,c,d){var e,f,g;return g=!1,a[b]!==c&&(g=!0),f=Object.keys(a).length,a[b]=c,e=Object.keys(a).length,f!==e&&(g=!0),g&&ko.valueHasMutated(this.parent,this.field),!0},a.prototype.deleteProperty=function(a,b){return delete a[b],ko.valueHasMutated(this.parent,this.field),!0},a}(),p=WeakMap?new WeakMap:new Map,this.Maslosoft.Binder.Model=function(){function b(b){var c,d,e;null==b&&(b=null),c=p.get(this);for(d in this)e=this[d],q(this[d])&&(this[d]={}),Array.isArray(this[d])&&(this[d]=[]);if(!c){p.set(this,!0);for(d in this)e=this[d],this[d]=ko.tracker.factory(e),q(this[d])&&(this[d]=new Proxy(this[d],new a(this,d)))}for(d in b)e=b[d],this[d]=ko.tracker.factory(e);for(d in this)e=this[d],q(this[d])&&(this[d]=new Proxy(this[d],new a(this,d)));ko.track(this,{deep:!0})}return b}(),this.Maslosoft.Ko.Balin=this.Maslosoft.Binder,this.Maslosoft.Ko.escapeRegExp=o,this.Maslosoft.Ko.escapeHtml=n,this.Maslosoft.Ko.equals=l,this.Maslosoft.Ko.stringToColour=y,this.Maslosoft.Ko.preload=u,this.Maslosoft.Ko.numberFormat=t,this.Maslosoft.Ko.lcfirst=r,this.Maslosoft.Ko.ucfirst=z,this.Maslosoft.Binder.registerDefaults(),ko.punches.enableAll()}).call(this);