(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=function(a,b){return function(){return a.apply(b,arguments)}},p={}.hasOwnProperty,q=function(a,b){function c(){this.constructor=a}for(var d in b)p.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=function(){return console?console.assert.apply(console,arguments):void 0},m=function(){return console?console.log.apply(console,arguments):void 0},n=function(a,b){return null==b&&(b=null),console?console.warn.apply(console,arguments):void 0},j=function(a,b){return null==b&&(b=null),console?console.error.apply(console,arguments):void 0},Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),l=function(a){return!!a&&"object"==typeof a&&a.constructor===Object},Object.keys||(Object.keys=function(){var a,b,c,d;return d=Object.prototype.hasOwnProperty,c=!{toString:null}.propertyIsEnumerable("toString"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],b=a.length,function(e){var f,g,h;if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");h=[],g=void 0,f=void 0;for(g in e)g=g,d.call(e,g)&&h.push(g);if(c)for(f=0;b>f;)d.call(e,a[f])&&h.push(a[f]),f++;return h}}()),this.Maslosoft||(this.Maslosoft={}),this.Maslosoft.Ko||(this.Maslosoft.Ko={}),this.Maslosoft.Ko.Balin||(this.Maslosoft.Ko.Balin={}),this.Maslosoft.Ko.Balin.Helpers||(this.Maslosoft.Ko.Balin.Helpers={}),this.Maslosoft.Ko.Balin.Widgets||(this.Maslosoft.Ko.Balin.Widgets={}),this.Maslosoft.Ko.debounce=function(a,b,c){var d;return d=void 0,function(){var e,f,g,h;g=this,e=arguments,h=function(){d=null,c||a.apply(g,e)},f=c&&!d,clearTimeout(d),d=setTimeout(h,b||200),f&&a.apply(g,e)}},this.Maslosoft.Ko.Balin.register=function(a,b){var c;return c=!1,a.match(/[A-Z]/)&&(c=a.toLowerCase()),b.writable&&ko.expressionRewriting&&ko.expressionRewriting.twoWayBindings&&(ko.expressionRewriting.twoWayBindings[a]=!0,c&&(ko.expressionRewriting.twoWayBindings[c]=!0)),ko.bindingHandlers[a]=b,c?ko.bindingHandlers[c]=b:void 0},this.Maslosoft.Ko.Balin.registerDefaults=function(a){var b,c,d,e,f;if(null==a&&(a=null),b={acl:Maslosoft.Ko.Balin.Acl,active:Maslosoft.Ko.Balin.Active,action:Maslosoft.Ko.Balin.WidgetAction,activity:Maslosoft.Ko.Balin.WidgetActivity,asset:Maslosoft.Ko.Balin.Asset,data:Maslosoft.Ko.Balin.Data,dateFormatter:Maslosoft.Ko.Balin.DateFormatter,datePicker:Maslosoft.Ko.Balin.DatePicker,datePickerPickaDate:Maslosoft.Ko.Balin.PickaDate,dateTimeFormatter:Maslosoft.Ko.Balin.DateTimeFormatter,decimalFormatter:Maslosoft.Ko.Balin.DecimalFormatter,disabled:Maslosoft.Ko.Balin.Disabled,enumCssClassFormatter:Maslosoft.Ko.Balin.EnumCssClassFormatter,enumFormatter:Maslosoft.Ko.Balin.EnumFormatter,eval:Maslosoft.Ko.Balin.Eval,fancytree:Maslosoft.Ko.Balin.Fancytree,fileSizeFormatter:Maslosoft.Ko.Balin.FileSizeFormatter,hidden:Maslosoft.Ko.Balin.Hidden,href:Maslosoft.Ko.Balin.Href,htmlTree:Maslosoft.Ko.Balin.HtmlTree,htmlValue:Maslosoft.Ko.Balin.HtmlValue,icon:Maslosoft.Ko.Balin.Icon,log:Maslosoft.Ko.Balin.Log,model:Maslosoft.Ko.Balin.DataModel,src:Maslosoft.Ko.Balin.Src,textValue:Maslosoft.Ko.Balin.TextValue,textValueHlJs:Maslosoft.Ko.Balin.TextValueHLJS,timeAgoFormatter:Maslosoft.Ko.Balin.TimeAgoFormatter,timeFormatter:Maslosoft.Ko.Balin.TimeFormatter,timePicker:Maslosoft.Ko.Balin.TimePicker,tooltip:Maslosoft.Ko.Balin.Tooltip,treegrid:Maslosoft.Ko.Balin.TreeGrid,treegridnode:Maslosoft.Ko.Balin.TreeGridNode,selected:Maslosoft.Ko.Balin.Selected,validator:Maslosoft.Ko.Balin.Validator,videoPlaylist:Maslosoft.Ko.Balin.VideoPlaylist,videoThumb:Maslosoft.Ko.Balin.VideoThumb},null!==a){e=[];for(c in a)d=a[c],e.push(Maslosoft.Ko.Balin.register(d,new b[d]));return e}f=[];for(c in b)d=b[c],f.push(Maslosoft.Ko.Balin.register(c,new d));return f},this.Maslosoft.Ko.Balin.registerEvents=function(a){var b,c,d,e,f;if(null==a&&(a=null),b={dblclick:"dblclick",mousedown:"mousedown",mouseup:"mouseup",mouseover:"mouseover",mouseout:"mouseout"},null!==a){e=[];for(c in a)d=a[c],e.push(Maslosoft.Ko.Balin.makeEventHandlerShortcut(d));return e}f=[];for(c in b)d=b[c],f.push(Maslosoft.Ko.Balin.makeEventHandlerShortcut(d));return f},this.Maslosoft.Ko.Balin.makeEventHandlerShortcut=function(a){ko.bindingHandlers[a]={init:function(b,c,d,e,f){var g;return g=function(){var b;return b={},b[a]=c(),b},ko.bindingHandlers.event.init.call(this,b,g,d,e,f)}}},this.Maslosoft.Ko.Balin.Base=function(){function a(a){var b,c;null==a&&(a={}),this.getValue=o(this.getValue,this),this.options={};for(b in a)c=a[b],this.options[b]=c}return a.prototype.writable=!0,a.prototype.options={},a.prototype.getValue=function(a,b){var c;return null==b&&(b=""),c=ko.unwrap("function"==typeof a?a():a),this.options.valueField&&(c=this.options.ec5?c[this.options.valueField]:c[this.options.valueField]()),"undefined"==typeof c?b:c},a}(),this.Maslosoft.Ko.Balin.Options=function(){function a(a){var b,c;null==a&&(a={});for(b in a)c=a[b],this[b]=c;null===this.ec5&&(this.ec5=!!ko.track),null===this.afterUpdate&&(this.afterUpdate=function(){})}return a.prototype.valueField=null,a.prototype.ec5=null,a.prototype.afterUpdate=null,a}(),this.Maslosoft.Ko.Balin.CssOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.className="active",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.DateOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="YYYY-MM-DD",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.DateTimeOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="YYYY-MM-DD hh:mm",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.TimeAgoOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="hh:mm",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.TimeOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="hh:mm",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.ValidatorOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.classField="_class",b.prototype.parentSelector=".form-group",b.prototype.inputError="error",b.prototype.parentError="has-error",b.prototype.inputWarning="warning",b.prototype.parentWarning="has-warning",b.prototype.inputSuccess="success",b.prototype.parentSuccess="has-success",b.prototype.errorMessages=".error-messages",b.prototype.warningMessages=".warning-messages",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.BaseValidator=function(){function a(a){var b,c;this.reset();for(b in a)c=a[b],this[b]=null,this[b]=c}return a.prototype.label="",a.prototype.model=null,a.prototype.messages=[],a.prototype.rawMessages=[],a.prototype.warningMessages=[],a.prototype.rawWarningMessages=[],a.prototype.reset=function(){return this.messages=new Array,this.rawMessages=new Object,this.warningMessages=new Array,this.rawWarningMessages=new Object},a.prototype.isValid=function(){throw new Error("Validator must implement `isValid` method")},a.prototype.getErrors=function(){return this.messages},a.prototype.getWarnings=function(){return this.warningMessages},a.prototype.addError=function(a,b){var c,d,e,f;d=a,a=a.replace("{attribute}",this.label);for(c in this)e=this[c],a=a.replace("{"+c+"}",e);for(c in b)e=b[c],a=a.replace("{"+c+"}",e);f=this.model;for(c in f)e=f[c],a=a.replace("{"+c+"}",e);return this.rawMessages[d]?void 0:(this.messages.push(a),this.rawMessages[d]=!0)},a.prototype.addWarning=function(a,b){var c,d,e,f;d=a,a=a.replace("{attribute}",this.label);for(c in this)e=this[c],a=a.replace("{"+c+"}",e);for(c in b)e=b[c],a=a.replace("{"+c+"}",e);f=this.model;for(c in f)e=f[c],a=a.replace("{"+c+"}",e);return this.rawWarningMessages[d]?void 0:(this.warningMessages.push(a),this.rawWarningMessages[d]=!0)},a}(),this.Maslosoft.Ko.Balin.CssClass=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.writable=!1,b.prototype.update=function(a,b){var c;c=this.getValue(b),c?ko.utils.toggleDomNodeCssClass(a,this.options.className,!0):ko.utils.toggleDomNodeCssClass(a,this.options.className,!1)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.MomentFormatter=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.init=function(){moment.locale(this.options.lang)},b.prototype.update=function(a,b){var c;c=this.getValue(b),a.innerHTML=moment[this.options.sourceFormat](c).format(this.options.displayFormat)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Picker=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Video=function(a){function b(){return this.setThumb=o(this.setThumb,this),this.isVideoUrl=o(this.isVideoUrl,this),b.__super__.constructor.apply(this,arguments)}var c,d;return q(b,a),d=null,c=null,jQuery(document).ready(function(){return d=new Maslosoft.Playlist.Options,c=d.adapters}),b.prototype.isVideoUrl=function(a){var b,d,e;for(d=0,e=c.length;e>d;d++)if(b=c[d],b.match(a))return b;return!1},b.prototype.setThumb=function(a,b){var c,d,e;return(d=this.isVideoUrl(a))?(e=function(a){return"img"===b.tagName.toLowerCase()?b.src=a:jQuery(b).css("background-image","url('"+a+"')")},console.log(a),c=new d,c.setUrl(a),c.setThumb(e)):void 0},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.WidgetUrl=function(a){function b(){return this.setRel=o(this.setRel,this),this.createUrl=o(this.createUrl,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.getData=function(a,b,c,d){var e,f,g;return g=this.getValue(b),f={},f.id=c.get("widgetId")||g.id,c.get("widget")&&(f.id=c.get("widget").id),f[d]=c.get(d)||g[d],e=c.get("params"),f.params=void 0===typeof e?g.params:e,f.params=this.getValue(f.params),"string"==typeof g&&(f[d]=g),f},b.prototype.createUrl=function(a,b,c,d){var e,f,g,h;if(e=[],"string"==typeof c||"number"==typeof c)(""!==c||"number"==typeof c)&&e.push(""+c);else for(g in c)h=c[g],g=encodeURIComponent(""+g),h=encodeURIComponent(""+h),e.push(""+g+":"+h);return f=""+d+a+"."+b,0===e.length?f:(e=e.join(",",e),""+f+"="+e)},b.prototype.setRel=function(a){var b,c,d,e,f,g;if(b=!1,e=[],c=a.getAttribute("rel"))for(e=c.split(" "),f=0,g=e.length;g>f;f++)d=e[f],"virtual"===d&&(b=!0);return b||e.push("virtual"),a.setAttribute("rel",e.join(" "))},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Acl=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}var c;return q(b,a),c=null,b.prototype.init=function(){if(!Maslosoft.Ko.Balin.Acl.allow)throw new Error("Acl binding handler requires Maslosoft.Ko.Balin.Acl.allow to be function checking permissions");if("function"!=typeof Maslosoft.Ko.Balin.Acl.allow)throw new Error("Acl binding handler requires Maslosoft.Ko.Balin.Acl.allow to be function checking permissions")},b.prototype.update=function(a,b){var c,d;return c=this.getValue(b),d=Maslosoft.Ko.Balin.Acl.allow(c),ko.bindingHandlers.visible.update(a,function(){return d})},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Active=function(a){function b(){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.CssOptions({className:"active"}))}return q(b,a),b}(this.Maslosoft.Ko.Balin.CssClass),this.Maslosoft.Ko.Balin.Asset=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(a,b,c){var d,e,f,g,h,i,j,k,l;d=$(a),l=c.get("w"),f=c.get("h"),h=c.get("p"),g=this.getValue(b),g.updateDate&&(e=g.updateDate,i=e.sec),k=g.url,j=[],j.push(k),l&&j.push("w/"+l),f&&j.push("h/"+f),h===!1&&j.push("p/0"),i&&j.push(i),j=j.join("/"),d.attr("src")!==j&&d.attr("src",j)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Data=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.getNamespacedHandler=function(a){return{update:function(b){return function(c,d){var e,f;return e=b.getValue(d),"string"!=(f=typeof e)&&"number"!==f&&(e=JSON.stringify(e)),c.setAttribute("data-"+a,e)}}(this)}},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.DataModel=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(a,b,c){var d,e,f,g,h,i,j;if(f=this.getValue(b),e=c.get("fields")||null,null===e)return void this.bindModel(a,f);for(g={},j=[],h=0,i=e.length;i>h;h++)d=e[h],"undefined"==typeof f[d]?n("Model field `"+d+"` is undefined on element:",a):g[d]=f[d],j.push(this.bindModel(a,g));return j},b.prototype.bindModel=function(a,b){var c,d;return"string"!=(d=typeof value)&&"number"!==d&&(c=JSON.stringify(b)),a.setAttribute("data-model",c)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.DateFormatter=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.DateOptions(a))}return q(b,a),b}(this.Maslosoft.Ko.Balin.MomentFormatter),this.Maslosoft.Ko.Balin.DatePicker=function(a){function b(a){this.update=o(this.update,this),this.init=o(this.init,this),this.getModelValue=o(this.getModelValue,this),this.getDisplayValue=o(this.getDisplayValue,this),this.updateModel=o(this.updateModel,this),b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.DateOptions(a))}return q(b,a),b.prototype.getData=function(a){var b;return b=this.getValue(a)||[],b.data?b.data:b},b.prototype.getOptions=function(a){var b,c,d,e;if(d={lang:this.options.lang,sourceFormat:this.options.sourceFormat,displayFormat:this.options.displayFormat,format:this.options.displayFormat.toLowerCase(),forceParse:!1,todayHighlight:!0,showOnFocus:!1},b=a.get("dateOptions")||[])for(c in b)e=b[c],"data"!==c&&"template"!==c&&("format"===c&&(d.displayFormat=e.toUpperCase()),d[c]=e);return d},b.prototype.updateModel=function(a,b,c){var d,e,f;return f=this.getOptions(c),e=this.getData(b),d=this.getModelValue(a.value,f),e!==d?b().data?ko.expressionRewriting.writeValueToProperty(ko.unwrap(b()).data,c,"datePicker.data",d):ko.expressionRewriting.writeValueToProperty(b(),c,"datePicker",d):void 0},b.prototype.getDisplayValue=function(a,b){var c;return c="unix"===b.sourceFormat?moment.unix(a).format(b.displayFormat):moment(a,b.sourceFormat).format(b.displayFormat)},b.prototype.getModelValue=function(a,b){var c;return c="unix"===b.sourceFormat?moment(a,b.displayFormat).unix():moment(a,b.displayFormat).format(b.sourceFormat)},b.prototype.init=function(a,b,c){var d,e,f,g,h,i;g=this.getOptions(c),a.value=this.getDisplayValue(this.getData(b),g),e=jQuery(a),h=g.template?g.template:'<div class="input-group-addon">\n	<a class="picker-trigger-link" style="cursor: pointer;">\n		<i class="glyphicon glyphicon-calendar"></i>\n	</a>\n</div>',d=jQuery(h),d.insertAfter(e),i=d.find("a.picker-trigger-link"),e.datepicker(g),e.on("changeDate",function(){return function(){return!1}}(this)),e.on("change",function(d){return function(f){var h;return h=Date.parse(a.value),h&&!f.isTrigger?(a.value=d.getDisplayValue(Math.round(h.getTime()/1e3),g),d.updateModel(a,b,c),e.datepicker("update"),!0):!1}}(this)),f=!1,e.on("show",function(){return function(){return f=!0}}(this)),e.on("hide",function(){return function(){return f=!1}}(this)),i.on("mousedown",function(a){e.datepicker(f?"hide":"show"),a.stopPropagation(),a.preventDefault()})},b.prototype.update=function(a,b,c){var d,e;return b().data?ko.utils.setTextContent(a,b().data):ko.utils.setTextContent(a,b()),d=this.getOptions(c),e=this.getDisplayValue(this.getData(b),d),a.value!==e?a.value=e:void 0},b}(this.Maslosoft.Ko.Balin.Picker),this.Maslosoft.Ko.Balin.DateTimeFormatter=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.DateTimeOptions(a))}return q(b,a),b}(this.Maslosoft.Ko.Balin.MomentFormatter),this.Maslosoft.Ko.Balin.DecimalFormatter=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.precision=2,b.prototype.decimalSeparator=",",b.prototype.thousandSeparator=" ",b.prototype.suffix="",b.prototype.prefix="",b.prototype.init=function(){},b.prototype.update=function(a,b,c){var d,e,f,g,h,i,j,k,l;for(j=this.getValue(b)||0,j=parseFloat(j),e={},i=["precision","decimalSeparator","thousandSeparator","suffix","prefix"],k=0,l=i.length;l>k;k++)h=i[k],e[h]=this[h],d=c.get(h),"undefined"!=typeof d&&(e[h]=this.getValue(d));return f=function(a,b,c,d,e){var f,g;return null==b&&(b=2),null==c&&(c=3),null==d&&(d=" "),null==e&&(e=","),g="\\d(?=(\\d{"+(c||3)+"})+"+(b>0?"\\D":"$")+")",f=a.toFixed(Math.max(0,~~b)),(e?f.replace(".",e):f).replace(new RegExp(g,"g"),"$&"+(d||","))},g=f(j,e.precision,3,e.thousandSeparator,e.decimalSeparator),a.innerHTML=e.prefix+g+e.suffix},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Disabled=function(a){function b(){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.CssOptions({className:"disabled"}))}return q(b,a),b}(this.Maslosoft.Ko.Balin.CssClass),this.Maslosoft.Ko.Balin.EnumCssClassFormatter=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(a,b){var c,d,e,f,g,h;for(c=this.getValue(b),h=c.values,f=0,g=h.length;g>f;f++)d=h[f],e=new RegExp("(?:^|\\s)"+d+"(?!\\S)","g"),a.className=a.className.replace(e,"");a.className+=" "+c.values[c.data]},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.EnumFormatter=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(a,b){var c;c=this.getValue(b),a.innerHTML=c.values[c.data]},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Eval=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.init=function(a,b){var c;return c=this.getValue(b),console.log(c),{controlsDescendantBindings:!c}},b.prototype.update=function(a,b){var c;return c=this.getValue(b),console.log(c),{controlsDescendantBindings:!c}},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Fancytree=function(a){function e(){return this.update=o(this.update,this),this.handle=o(this.handle,this),this.init=o(this.init,this),e.__super__.constructor.apply(this,arguments)}return q(e,a),e.prototype.tree=null,e.prototype.element=null,e.prototype.getData=function(a){var b;return b=this.getValue(a)||[],b.data?b.data:b},e.prototype.init=function(a,e){var f,h,i,j,k,l,m,o,p,q;if(p=this.getData(e),m=e().options||{},i=this.getValue(e).on||!1,m.toggleEffect=!1,m.source=p.children,m.extensions=[],q=new d(p,i,m),f=e().dnd||!1,h=e().drag||!1,f&&h)throw new Error("Cannot use both `dnd` and `drag`");return f&&(m.autoScroll=!1,m.extensions.push("dnd"),m.dnd=new b(p,a,q)),h&&(m.autoScroll=!1,m.extensions.push("dnd"),m.dnd=new c(p,a)),k=e().nodeIcon||!1,j=e().folderIcon||!1,l=e().nodeRenderer||!1,j&&!k&&n("Option `folderIcon` require also `nodeIcon` or it will not work at all"),(k||l)&&(k&&(m.icon=!1),o=new g(p,m,k,j),l&&o.setRenderer(new l(p,m)),m.renderNode=o.render),jQuery(a).fancytree(m)},e.prototype.handle=function(a,b){var c,d;return c=this.getValue(b),a=jQuery(a),d=function(d){return function(){return a.find(".ui-fancytree").length?(a.fancytree("option","source",d.getData(b).children),c.autoExpand&&a.fancytree("getRootNode").visit(function(a){return a.setExpanded(!0)}),a.focus()):void 0}}(this),setTimeout(d,0)},e.prototype.update=function(a,b,c){return this.handle(a,b,c)},e}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.FileSizeFormatter=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.units={binary:["kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimal:["kB","MB","GB","TB","PB","EB","ZB","YB"]},b.prototype.binary=!0,b.prototype.init=function(){},b.prototype.update=function(a,b){var c,d,e,f,g;return g=this.getValue(b)||0,c=this.binary,d=!this.binary,c&&(f=1024),d&&(f=1e3),e=function(a){return function(b){var e,g;if(b=parseInt(b),f>b)return b+" B";for(e=-1,c&&(g=a.units.binary),d&&(g=a.units.decimal);;)if(b/=f,e++,!(b>f))break;return g[e]?Math.max(b,.1).toFixed(1)+" "+g[e]:Math.max(b,.1).toFixed(1)+(" ~*"+e*f+" * "+f+" B")}}(this),a.innerHTML=e(g)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.GMap=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.init=function(){},b.prototype.update=function(a,b){var c;return c=this.getValue(b)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Hidden=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(a,b){var c;return c=!this.getValue(b),ko.bindingHandlers.visible.update(a,function(){return c})},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Href=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.init=function(a,b,c){var d;return a.href||a.setAttribute("href",""),"a"!==a.tagName.toLowerCase()&&console.warn("href binding should be used only on `a` tags"),d=c.get("stopPropagation")||!1,d?ko.utils.registerEventHandler(a,"click",function(a){return a.stopPropagation()}):void 0},b.prototype.update=function(a,b,c){var d,e;return d=this.getValue(b),e=c.get("target")||"",a.href!==d&&(a.href=d),a.target!==e?a.target=e:void 0},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.HtmlTree=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.drawNode=function(a){var c,d,e,f,g,h,i;if(f=document.createElement("li"),f.innerHTML=a.title,a.children&&a.children.length>0){for(d=document.createElement("ul"),i=a.children,g=0,h=i.length;h>g;g++)e=i[g],c=b.drawNode(e),d.appendChild(c);f.appendChild(d)}return f},b.prototype.getData=function(a){var b;return b=this.getValue(a)||[],b.data?this.getValue(b.data)||[]:b},b.prototype.update=function(a,c){var d,e;return d=this.getValue(c),n("HtmlTree is experimental, do not use"),e=function(){return function(){var c;return c=b.drawNode(d),a.innerHTML="",a.appendChild(c)}}(this),setTimeout(e,0)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.HtmlValue=function(a){function b(a){null==a&&(a={}),this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.call(this,a),ko.bindingHandlers.sortable&&ko.bindingHandlers.sortable.options&&(ko.bindingHandlers.sortable.options.cancel=":input,button,[contenteditable]")}var c;return q(b,a),c=0,b.prototype.getElementValue=function(a){return a.innerHTML},b.prototype.setElementValue=function(a,b){return a.innerHTML=b},b.prototype.init=function(a,b){var d,e;a.setAttribute("contenteditable",!0),a.id||(a.id="Maslosoft-Ko-Balin-HtmlValue-"+c++),e=function(c){return function(){var d,e,f;if(a&&(a=document.getElementById(a.id)))return d=b(),f=c.getValue(b),e=c.getElementValue(a),ko.isWriteableObservable(d)&&f!==e?d(e):void 0}}(this),d=function(){return function(){return setTimeout(e,0)}}(this),ko.utils.registerEventHandler(a,"keyup, input",e),ko.utils.registerEventHandler(document,"mouseup",d)},b.prototype.update=function(a,b){var c;c=this.getValue(b),this.getElementValue(a)!==c&&this.setElementValue(a,c)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Icon=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(a,b,c){var d,e,f,g,h,i,j,k,l;return d=$(a),i=this.getValue(b),g=c.get("iconField")||"icon",i?(l=i[g],e="undefined"==typeof i.iconSize?16:i.iconSize,k=c.get("iconSize")||e,j=new RegExp("/"+e+"/","g"),h="undefined"==typeof i.isImage?!0:i.isImage,h?(l.match(new RegExp("/$"))||(l+="/"),l.match(new RegExp("/w/","g"))?l=l.replace(j,"/"+k+"/"):l+="w/"+k+"/h/"+k+"/p/0/",i.updateDate&&(l+=i.updateDate.sec)):(f=16,k>16&&(f=32),k>32&&(f=48),k>48&&(f=512),l=l.replace(j,"/"+f+"/")),d.attr("src")!==l&&d.attr("src",l),void d.css({width:""+k+"px",height:"auto",maxWidth:"100%"})):void(console&&(console.warn("Binding value for `icon` binding not defined, skipping. Element:"),console.warn(a),console.warn((new Error).stack)))},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Log=function(a){function b(){return this.init=o(this.init,this),this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(a,b){return console.log(this.getValue(b),a)},b.prototype.init=function(a,b){return console.log(this.getValue(b),a)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.PickaDate=function(a){function b(a){this.update=o(this.update,this),this.init=o(this.init,this),this.getModelValue=o(this.getModelValue,this),this.getDisplayValue=o(this.getDisplayValue,this),this.updateModel=o(this.updateModel,this),b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.DateOptions(a))}return q(b,a),b.prototype.updateModel=function(a,b,c){var d,e,f;return e=this.getValue(b),d=this.getModelValue(a.value),e!==d?(ko.expressionRewriting.writeValueToProperty(b(),c,"datePicker",d),f=d):void 0},b.prototype.getDisplayValue=function(a){var b;return b="unix"===this.options.sourceFormat?moment.unix(a).format(this.options.displayFormat):moment(a,this.options.sourceFormat).format(this.options.displayFormat)},b.prototype.getModelValue=function(a){var b;return b="unix"===this.options.sourceFormat?moment(a,this.options.displayFormat).unix():moment(a,this.options.displayFormat).format(this.options.sourceFormat)},b.prototype.init=function(a,b,c){var d,e,f,g,h,i,j,k,l;f=this.getDisplayValue(this.getValue(b)),l=jQuery(a),l.val(f),k=this.options.template?this.options.template:'<div class="input-group-addon">\n	<a class="picker-trigger-link" style="cursor: pointer;">\n		<i class="glyphicon glyphicon-calendar"></i>\n	</a>\n</div>',j=jQuery(k),j.insertAfter(l),i=j.find("a.picker-trigger-link"),g={format:this.options.displayFormat.toLowerCase(),selectMonths:!0,selectYears:!0},d=i.pickadate(g),h=d.pickadate("picker"),h.on("set",function(d){return function(){l.val(h.get("value")),d.updateModel(a,b,c)}}(this)),e={},e.change=function(d){return function(){var e;e=Date.parse(a.value),e&&(h.set("select",[e.getFullYear(),e.getMonth(),e.getDate()]),d.updateModel(a,b,c))}}(this),e.keyup=function(a){86===a.which&&a.ctrlKey&&e.change()},e.mouseup=e.change,e.focus=function(){return function(){h.open(!1)}}(this),e.blur=function(d){return function(e){e.relatedTarget||(h.close(),d.updateModel(a,b,c))}}(this),l.on(e),i.on("click",function(a){var b,c;c=jQuery(h.$root[0]),b=jQuery(c.children()[0]).height()>0,b?h.close():h.open(!1),a.stopPropagation(),a.preventDefault()})},b.prototype.update=function(a,b){var c;return ko.utils.setTextContent(a,b()),c=this.getDisplayValue(this.getValue(b)),a.value!==c?a.value=c:void 0},b}(this.Maslosoft.Ko.Balin.Picker),this.Maslosoft.Ko.Balin.Selected=function(a){function b(){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.CssOptions({className:"selected"}))}return q(b,a),b}(this.Maslosoft.Ko.Balin.CssClass),this.Maslosoft.Ko.Balin.Src=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.init=function(){},b.prototype.update=function(a,b){var c;return c=this.getValue(b),a.src!==c?a.src=c:void 0},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.TextValue=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.getElementValue=function(a){return a.textContent||a.innerText||""},b.prototype.setElementValue=function(a,b){return"undefined"!=typeof a.textContent&&(a.textContent=b),"undefined"!=typeof a.innerText?a.innerText=b:void 0},b}(this.Maslosoft.Ko.Balin.HtmlValue),this.Maslosoft.Ko.Balin.TextValueHLJS=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.getElementValue=function(a){return a.textContent||a.innerText||""},b.prototype.setElementValue=function(a,b){return"undefined"!=typeof a.textContent&&(a.textContent=b,hljs&&hljs.highlightBlock(a)),"undefined"!=typeof a.innerText&&(a.innerText=b,hljs)?hljs.highlightBlock(a):void 0},b}(this.Maslosoft.Ko.Balin.HtmlValue),this.Maslosoft.Ko.Balin.TimeAgoFormatter=function(a){function b(a){this.update=o(this.update,this),b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.TimeAgoOptions(a))}return q(b,a),b.prototype.update=function(a,b){var c;c=this.getValue(b),a.innerHTML=moment[this.options.sourceFormat](c).fromNow()},b}(this.Maslosoft.Ko.Balin.MomentFormatter),this.Maslosoft.Ko.Balin.TimeFormatter=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.TimeOptions(a))}return q(b,a),b}(this.Maslosoft.Ko.Balin.MomentFormatter),this.Maslosoft.Ko.Balin.TimePicker=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Tooltip=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(a,b){var c;c=this.getValue(b),$(a).attr("title",c),$(a).attr("data-original-title",c),$(a).attr("rel","tooltip")},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Tree=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(){},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.TreeGrid=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}var c;return q(b,a),c=function(a,b,c,d){return function(){var a,e,f,g,h,i;return g=b(),i=ko.utils.peekObservable(g),i&&"number"!=typeof i.length?(a=[],f=[],e=-1,h=function(b){var c,d,g,i,j;for(e++,j=[],g=0,i=b.length;i>g;g++)d=b[g],c={depth:e,hasChilds:!!d.children.length},d._treeGrid=ko.tracker.factory(c),a.push(d),f.push(e),d.children.length?(h(d.children),j.push(e--)):j.push(void 0);return j},h(i.data.children),c&&(c.tree=i.data,c.widget=d),ko.utils.unwrapObservable(g),{foreach:a,depths:f,as:i.as,includeDestroyed:i.includeDestroyed,afterAdd:i.afterAdd,beforeRemove:i.beforeRemove,afterRender:i.afterRender,beforeMove:i.beforeMove,afterMove:i.afterMove,templateEngine:ko.nativeTemplateEngine.instance}):{foreach:g,templateEngine:ko.nativeTemplateEngine.instance}}},b.prototype.init=function(a,b,d,e,f){var g;return g=new Maslosoft.Ko.Balin.Widgets.TreeGrid.TreeGridView(a,b),ko.bindingHandlers.template.init(a,c(a,b,f,g),d,e,f),{controlsDescendantBindings:!0}},b.prototype.update=function(a,b,d,e,f){var g;return g=new Maslosoft.Ko.Balin.Widgets.TreeGrid.TreeGridView(a,b,"update"),ko.bindingHandlers.template.update(a,c(a,b,f,g),d,e,f)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.TreeGridNode=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)
}return q(b,a),b.prototype.init=function(){},b.prototype.update=function(a,b,c,d,e){var f;return ko.utils.toggleDomNodeCssClass(a,"tree-grid-drag-handle",!0),(f=function(c){return function(){var d,f,g,h,i,j,k,l;return k=[],f=c.getValue(b),i=f._treeGrid,d=e.widget.config,l=d.nodeIcon,j=d.folderIcon,j&&i.hasChilds&&(l=j),g=i.depth,h=[],h.push("<div class='collapsed' style='display:none;transform: rotate(-90deg);'>&#128899;</div>"),h.push("<div class='expanded' style='transform: rotate(-45deg);'>&#128899;</div>"),k.push("<a class='expander' style='cursor:pointer;text-decoration:none;width:1em;margin-left:"+g+"em;display:inline-block;'>"+h.join("")+"</a>"),g=i.depth+1,k.push("<i class='no-expander' style='margin-left:"+g+"em;display:inline-block;'></i>"),k.push("<img src='"+l+"' style='width: 1em;height:1em;margin-top: -.3em;display: inline-block;'/>"),a.innerHTML=k.join("")+a.innerHTML}}(this))()},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Validator=function(a){function b(){this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.ValidatorOptions)}var c;return q(b,a),c=0,b.prototype.getElementValue=function(a){return"input"===a.tagName.toLowerCase()?a.value:"textarea"===a.tagName.toLowerCase()?a.value:a.textContent||a.innerText||""},b.prototype.init=function(a,b){var d,e,f,g,i,k,l,m,n,o,p,q,r;for(i=this.getValue(b),p=new Array,e=this.options.classField,d=i.constructor===Array?i:[i],q=0,r=d.length;r>q;q++)g=d[q],g[e]?"function"==typeof g[e]?(o=g[e].prototype,"function"==typeof o.isValid&&"function"==typeof o.getErrors&&"function"==typeof o.reset?(f=g[e],delete g[e],p.push(new f(g))):(n="function"==typeof g[e].prototype.constructor?g[e].prototype.constructor.name:g[e].toString(),j("Parameter `"+e+"` (of type "+n+") must be validator compatible class, binding defined on element:",a))):j("Parameter `"+e+"` must be validator compatible class, binding defined on element:",a):j("Parameter `"+e+"` must be defined for validator on element:",a);return m=new h(p,this.options),m.init(a),a.id||(a.id="Maslosoft-Ko-Balin-Validator-"+c++),l=this.getElementValue(a),k=function(b){return function(){var c;if(a&&(a=document.getElementById(a.id)))return c=b.getElementValue(a),l!==c?(l=c,m.validate(a,c)):void 0}}(this),ko.utils.registerEventHandler(a,"keyup, input",k),ko.utils.registerEventHandler(document,"mouseup",k)},b.prototype.update=function(){},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.VideoPlaylist=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.initVideos=null,b.prototype.getData=function(a){var b;return b=this.getValue(a)||[],b.data?b.data:b},b.prototype.init=function(){},b.prototype.update=function(a,b){var c,d,e,f,g,h,i,j,k,l;for(c=this.getData(b),e=this.getValue(b||{}),i=e.urlField||"url",g=e.urlField||"title",d=[],k=0,l=c.length;l>k;k++)j=c[k],h=j[i],f=j[g],this.isVideoUrl(h)&&d.push("<a href='"+h+"'>"+f+"</a>");return a.innerHTML=d.join("\n"),d.length?(ko.utils.toggleDomNodeCssClass(a,"maslosoft-playlist",!0),new Maslosoft.Playlist(a)):ko.utils.toggleDomNodeCssClass(a,"maslosoft-playlist",!1)},b}(this.Maslosoft.Ko.Balin.Video),this.Maslosoft.Ko.Balin.VideoThumb=function(a){function b(){return this.update=o(this.update,this),this.init=o(this.init,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.init=function(){},b.prototype.update=function(a,b){var c;return c=this.getValue(b),this.setThumb(c,a)},b}(this.Maslosoft.Ko.Balin.Video),this.Maslosoft.Ko.Balin.WidgetAction=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(a,b,c){var d,e;return d=this.getData(a,b,c,"action"),e=this.createUrl(d.id,d.action,d.params,"?"),a.setAttribute("href",e),this.setRel(a)},b}(this.Maslosoft.Ko.Balin.WidgetUrl),this.Maslosoft.Ko.Balin.WidgetActivity=function(a){function b(){return this.update=o(this.update,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.update=function(a,b,c){var d,e;return d=this.getData(a,b,c,"activity"),e=this.createUrl(d.id,d.activity,d.params,"#"),a.setAttribute("href",e),this.setRel(a)},b}(this.Maslosoft.Ko.Balin.WidgetUrl),b=function(){function a(a,b,c){this.events=c,this.dragDrop=o(this.dragDrop,this),this.dragEnd=o(this.dragEnd,this),this.draggable={},this.draggable.scroll=!1,this.tree={},this.tree=a,this.finder=new f(this.tree),this.el=jQuery(b)}var b;return a.prototype.autoExpandMS=400,a.prototype.focusOnClick=!1,a.prototype.preventVoidMoves=!0,a.prototype.preventRecursiveMoves=!0,a.prototype.tree=null,a.prototype.finder=null,a.prototype.draggable=null,a.prototype.events=null,a.el=null,b=function(a){},a.prototype.dragStart=function(){return!0},a.prototype.dragEnter=function(){return!0},a.prototype.dragEnd=function(){return m("drag end..."),!0},a.prototype.dragDrop=function(a,b){var c,d,e,f,g,h,i,j,k;return g=b.hitMode,e=b.draggable.element[0],this.events.drop(a,b),b.otherNode?(i=this.finder.find(b.otherNode.parent.data.id),d=this.events.getNode(this.finder.find(b.otherNode.data.id)),this.el.is(e)||(m("From other instance..."),b=ko.dataFor(e),m(b),setTimeout(f,0))):(c=ko.contextFor(e),d=this.events.getNode(c.$data)),j=this.finder.find(a.data.id),k=this.finder.find(a.parent.data.id),i&&i.children.remove(d),this.tree.children.remove(d),k&&k.children.remove(d),"over"===g&&j.children.push(d),"before"===g&&(k?(h=k.children.indexOf(j),k.children.splice(h,0,d)):(h=this.tree.children.indexOf(j),this.tree.children.splice(h,0,d))),"after"===g&&(k?k.children.push(d):this.tree.children.push(d)),f=function(a){return function(b){return m(b),a.el.fancytree("option","source",a.tree.children),a.el.fancytree("getRootNode").visit(function(a){return a.setExpanded(!0)}),a.el.focus(),m("update tree..",a.el)}}(this),setTimeout(f,0),!0},a}(),c=function(){function a(a,b){this.dragDrop=o(this.dragDrop,this),this.dragEnd=o(this.dragEnd,this),this.draggable={},this.draggable.scroll=!1,this.tree={},this.tree=a,this.finder=new f(this.tree),this.el=jQuery(b)}var b;return a.prototype.focusOnClick=!1,a.prototype.tree=null,a.prototype.finder=null,a.prototype.draggable=null,a.el=null,b=function(a){},a.prototype.dragStart=function(){return!0},a.prototype.dragEnter=function(){return!1},a.prototype.dragEnd=function(){return m("drag end..."),!0},a.prototype.dragDrop=function(a,b){return!1},a}(),d=function(){function a(a,b,d){this.events=b,this.options=d,this.handle=o(this.handle,this),this.getNode=o(this.getNode,this),this.drop=o(this.drop,this),c=new f(a),this.handle("click"),this.handle("dblclick"),this.handle("activate"),this.handle("deactivate")}var b,c,d;return a.prototype.events=null,a.prototype.dropEvent=null,a.prototype.options=null,c=null,b=function(a){return"undefined"==typeof a.targetType?!0:"title"===a.targetType?!0:"icon"===a.targetType?!0:void 0},d=function(a){return a.stopPropagation()},a.prototype.drop=function(a,b){return m("Drop..."),m(this.events),this.events.drop?(this.dropEvent=new this.events.drop(a,b),m(this.dropEvent)):void 0},a.prototype.getNode=function(a){return m("Tree event drop..."),m(this.dropEvent),this.dropEvent&&this.dropEvent.getNode?this.dropEvent.getNode(a):a},a.prototype.handle=function(a){return this.events[a]?this.options[a]=function(e){return function(f,g){var h;return b(g)?(h=c.find(g.node.data.id),e.events[a](h,g,f),d(f)):void 0}}(this):void 0},a}(),e=function(){function a(){}var b;return b={},a.prototype.get=function(a){return"undefined"==typeof b[a]?!1:b[a]},a.prototype.set=function(a,c){return b[a]=c},a}(),f=function(){function a(a){d.push(a)}var b,c,d;return b=new e,d=[],c=function(a,d){var e,f,g,h,i,j;if("undefined"==typeof d)return!1;if(f=b.get(d))return f;if(a.id===d)return a;if(a._id===d)return a;if(a.children&&a.children.length>0)for(j=a.children,h=0,i=j.length;i>h;h++)if(e=j[h],g=c(e,d),g!==!1)return b.set(d,g),g;return!1},a.prototype.find=function(a){var b,e,f,g;for(f=0,g=d.length;g>f;f++)if(e=d[f],b=c(e,a))return b;return!1},a}(),g=function(){function a(a,c,d,e){this.icon=d,this.folderIcon=e,this.render=o(this.render,this),b=new f(a)}var b;return a.prototype.icon="",a.prototype.folderIcon="",a.prototype.renderer=null,b=null,a.prototype.setRenderer=function(a){return this.renderer=a,"function"!=typeof this.renderer.render?console.error("Renderer must have function `render`"):void 0},a.prototype.render=function(a,c){var d,e,f,g,h,i,j;h=c.node;for(f in c)if(j=c[f],"originalEvent"===f)return;return i=jQuery(h.span).find("> span.fancytree-title"),this.renderer&&this.renderer.render&&(g=b.find(h.data.id),this.renderer.render(g,i)),this.icon||this.folderIcon?(d=i.html(),e=this.folderIcon&&h.children&&h.children.length?this.folderIcon:this.icon,i.html("<i class='node-title-icon' style='background-image:url("+e+")'></i> "+d)):void 0},a}(),h=function(){function a(a,b){this.validators=a,this.options=b,this.adviseOne=o(this.adviseOne,this),this.validateOne=o(this.validateOne,this),this.init=o(this.init,this),this.setElement=o(this.setElement,this),this.validate=o(this.validate,this)}var b,c,d;return a.prototype.element=null,a.prototype.parent=null,a.prototype.errors=null,a.prototype.warnings=null,d=ko.utils.toggleDomNodeCssClass,b=function(a){return ko.utils.toggleDomNodeCssClass(a,"hide",!0)},c=function(a){return ko.utils.toggleDomNodeCssClass(a,"hide",!1)},a.prototype.validate=function(a,b){var c,d,e,f,g,h,i;for(this.setElement(a),h=this.validators,d=0,f=h.length;f>d;d++)if(c=h[d],!this.validateOne(c,b))return!1;for(i=this.validators,e=0,g=i.length;g>e;e++)c=i[e],"function"==typeof c.getWarnings&&this.adviseOne(c,b);return!0},a.prototype.setElement=function(a){return this.element=a,this.parent=jQuery(this.element).parents(".form-group")[0],this.errors=this.parent.querySelector(this.options.errorMessages),this.warnings=this.parent.querySelector(this.options.warningMessages),b(this.errors),b(this.warnings),this},a.prototype.init=function(a){return this.setElement(a)},a.prototype.validateOne=function(a,e){var f,g,h,i,j,k;return f=this.element,j=this.parent,g=this.errors,k=this.warnings,i=new Array,a.reset(),h=!1,a.isValid(e)?(this.options.inputError&&d(f,this.options.inputError,!1),this.options.inputSuccess&&d(f,this.options.inputSuccess,!0),j&&(this.options.parentError&&d(j,this.options.parentError,!1),this.options.parentSuccess&&d(j,this.options.parentSuccess,!0)),g&&(b(g),g.innerHTML=""),h=!0):(i=a.getErrors(),this.options.inputError&&d(f,this.options.inputError,!0),this.options.inputSuccess&&d(f,this.options.inputSuccess,!1),j&&(this.options.parentError&&d(j,this.options.parentError,!0),this.options.parentSuccess&&d(j,this.options.parentSuccess,!1)),g&&i&&(c(g),g.innerHTML=i.join("<br />")),h=!1),this.options.inputWarning&&d(f,this.options.inputWarning,!1),j&&this.options.parentWarning&&d(j,this.options.parentWarning,!1),k&&(b(k),k.innerHTML=""),h},a.prototype.adviseOne=function(a){var b,e,f,g,h;return b=this.element,g=this.parent,e=this.errors,h=this.warnings,f=a.getWarnings(),f.length&&(this.options.inputWarning&&d(b,this.options.inputWarning,!0),this.options.inputSuccess&&d(b,this.options.inputSuccess,!1),g&&(this.options.parentWarning&&d(g,this.options.parentWarning,!0),this.options.parentSuccess&&d(g,this.options.parentSuccess,!1)),h&&(c(h),h.innerHTML=f.join("<br />"))),this},a}(),this.Maslosoft.Ko.Balin.Widgets.TreeGrid||(this.Maslosoft.Ko.Balin.Widgets.TreeGrid={}),Maslosoft.Ko.Balin.Widgets.TreeGrid.Dnd=function(){function a(a){var b;this.grid=a,this.dragHelper=o(this.dragHelper,this),this.clear=o(this.clear,this),this.move=o(this.move,this),this.dragOver=o(this.dragOver,this),this.over=o(this.over,this),this.drop=o(this.drop,this),this.stop=o(this.stop,this),this.drag=o(this.drag,this),this.dragStart=o(this.dragStart,this),this.grid.config.dnd&&("init"===this.grid.context&&(ko.utils.domNodeDisposal.addDisposeCallback(this.grid.element.get(0),function(){return this.grid.element.draggable("destroy"),this.grid.element.droppable("destroy")}),this.grid.element.on("mousemove","> tr",this.move)),f||(f=new Maslosoft.Ko.Balin.Widgets.TreeGrid.DropIndicator(this.grid)),b=function(a){return function(){var b,c;return b={handle:".tree-grid-drag-handle",cancel:".expander",revert:!1,cursor:"pointer",cursorAt:{top:5,left:5},start:a.dragStart,drag:a.drag,stop:a.stop,helper:a.dragHelper},c={drop:a.drop,over:a.over},a.grid.element.find("> tr").draggable(b),a.grid.element.find("> tr").droppable(c)}}(this),setTimeout(b,0))}var b,c,d,e,f,g;return a.prototype.grid=null,a.prototype.helper=null,f=null,d=null,c=null,e=null,g=null,b=!1,a.prototype.dragStart=function(a){return c=a.target},a.prototype.drag=function(){},a.prototype.stop=function(a){return b?void 0:this.drop(a)},a.prototype.drop=function(){var a,f,g,h;return b=!0,c&&d&&d.get(0)?(a=ko.dataFor(c),g=ko.dataFor(d.get(0)),h=this.grid.getParent(g),this.grid.remove(a),"over"===e&&g.children.push(a),"before"===e&&(f=h.children.indexOf(g),h.children.splice(f,0,a)),"after"===e&&(g.children.length?h.children.splice(0,0,a):h.children.push(a)),this.clear()):this.clear()},a.prototype.over=function(a){return"tr"===a.target.tagName.toLowerCase()&&d!==a.target?(d=jQuery(a.target),this.dragOver(a)):void 0},a.prototype.dragOver=function(){var a;return f?(a=ko.dataFor(d.get(0)),-1===a.title.toLowerCase().indexOf("t")?f.accept():f.deny(),f.precise.over(d,e)):void 0},a.prototype.move=function(a){var b,f,h;return c&&a.currentTarget===c&&(d&&c===d.get(0)||(a.target=c,this.over(a))),d&&(b=d.offset(),f={},f.x=a.pageX-b.left,f.y=a.pageY-b.top,h={},h.x=f.x/d.outerWidth(!0),h.y=f.y/d.outerHeight(!0),e="over",h.y>.65&&(e="after"),h.y<=.25&&(e="before"),g!==e)?(g=e,a.target=d,this.dragOver(a)):void 0},a.prototype.clear=function(){return d=null,c=null,e=null,g=null,b=!1,this.helper&&(this.helper.hide(),this.helper=null),f?f.hide():void 0},a.prototype.dragHelper=function(a){var b,c,d,e;return e=jQuery(a.currentTarget).parent(),b=e.find(".tree-grid-drag-handle").parents("td").first(),d=b.clone(),d.find(".expander .expanded").remove(),d.find(".expander .collapsed").remove(),d.find(".expander").remove(),d.find(".no-expander").remove(),c="<span class='drop-indicator'>&times;</span>",this.helper=jQuery("<div style='white-space:nowrap;'>"+c+d.html()+"</div>"),this.helper.css("pointer-events","none"),f.attach(this.helper.find(".drop-indicator")),this.helper},a}(),Maslosoft.Ko.Balin.Widgets.TreeGrid.DropIndicator=function(){function a(a){this.grid=a,this.precise=new Maslosoft.Ko.Balin.Widgets.TreeGrid.InsertIndicator(this.grid)}return a.precise=null,a.element=null,a.prototype.attach=function(a){return this.element=a,this.element.css({"font-size":"1.5em"}),this.element.css({width:"1em"}),this.element.css({height:"1em"}),this.element.css({position:"absolute"}),this.element.css({left:"-.75em"}),this.element.css({top:"-.35em"})},a.prototype.hide=function(){return this.element.hide(),this.precise.hide()},a.prototype.show=function(){return this.element.show(),this.precise.show()},a.prototype.accept=function(){return this.element.html("&check;"),this.element.css({color:"green"}),this.precise.accept()},a.prototype.deny=function(){return this.element.html("&times;"),this.element.css({color:"red"}),this.precise.deny()},a}(),Maslosoft.Ko.Balin.Widgets.TreeGrid.Events=function(){function a(a){this.grid=a,!this.grid.config.on}return a.prototype.grid=null,a}(),Maslosoft.Ko.Balin.Widgets.TreeGrid.Expanders=function(){function a(a){this.grid=a,this.handler=o(this.handler,this),this.updateExpanders=o(this.updateExpanders,this),this.grid.config.expanders!==!1&&("init"===this.grid.context&&this.grid.element.on("mousedown",".expander",this.handler),"update"===this.grid.context&&this.updateExpanders())}return a.prototype.grid=null,a.prototype.updateExpanders=function(){var a,b;return b=function(){return function(a,b){var c;return c=!!b.children.length,c?(a.find(".no-expander").hide(),a.find(".expander").show()):(a.find(".expander").hide(),a.find(".no-expander").show()),a.find(".debug").html(b.children.length)}}(this),a=function(a){return function(){return a.grid.visit(b)}}(this),setTimeout(a,0)},a.prototype.handler=function(a){var b,c,d,e;return b=ko.contextFor(a.target).$data,c=-1,e=!1,m("clicked on expander "+b.title),d=function(){return function(a,d){var f,g;return g=d._treeGrid.depth,d===b?(c=g,f=a.find(".expander"),void(f.find(".expanded:visible").length?(f.find(".expanded").hide(),f.find(".collapsed").show(),e=!1):(f.find(".collapsed").hide(),f.find(".expanded").show(),e=!0))):-1!==c?g===c?void(c=-1):g-1===c?e?a.show():a.hide():void 0:void 0}}(this),this.grid.visit(d)},a}(),Maslosoft.Ko.Balin.Widgets.TreeGrid.InsertIndicator=function(){function a(a){this.grid=a,d||(this.create(),d=!0)}var b,c,d,e;return a.prototype.grid=null,d=!1,c=null,b=null,e=null,a.prototype.hide=function(){return c.hide()},a.prototype.show=function(){return c.show()},a.prototype.accept=function(){return c.css({color:"green"})},a.prototype.deny=function(){return c.css({color:"red"})},a.prototype.over=function(a,b){var d,e,f,g,h,i,j,k,l;return null==b&&(b="over"),this.precise("over"===b?!1:!0),h=a.find(".tree-grid-drag-handle"),d=a.find(".expander"),g=a.find(".no-expander"),l=0,j=h.offset(),f=c.outerHeight(!0)/2,"over"===b&&(i=h.outerHeight(!0)/2,k=j.top+i-f),"before"===b&&(k=j.top-f),"after"===b&&(k=j.top+h.outerHeight(!0)-f),e=j.left+l,c.css({left:e}),c.css({top:k}),this.show()},a.prototype.precise=function(a){return null==a&&(a=!0),a?e.show():e.hide()},a.prototype.create=function(){return c=jQuery('<div class="tree-grid-insert-indicator" style="display:none;position:absolute;color:green;line-height: 1em;">\n	<span class="tree-grid-insert-indicator-coarse" style="font-size: 1.5em;">\n		&#9654;\n	</span>\n	<span class="tree-grid-insert-indicator-precise" style="font-size:1.4em;">\n		&#11835;\n	</span>\n</div>'),c.appendTo("body"),b=c.find(".tree-grid-insert-indicator-coarse"),e=c.find(".tree-grid-insert-indicator-precise"),c.show()},a}(),Maslosoft.Ko.Balin.Widgets.TreeGrid.TreeGridView=function(){function a(b,c,d){var e,f,g,h;if(null==c&&(c=null),this.context=null!=d?d:"init",this.remove=o(this.remove,this),this.getParent=o(this.getParent,this),this.visitRecursive=o(this.visitRecursive,this),this.element=jQuery(b),c)for(this.config={},this.config=ko.unwrap(c()),h=a.plugins,f=0,g=h.length;g>f;f++)new(e=h[f])(this)}return a.plugins=[Maslosoft.Ko.Balin.Widgets.TreeGrid.Expanders,Maslosoft.Ko.Balin.Widgets.TreeGrid.Dnd,Maslosoft.Ko.Balin.Widgets.TreeGrid.Events],a.prototype.element=null,a.prototype.config=null,a.prototype.visit=function(a){var b,c,d,e,f,g;for(d=this.element.find("> tr"),g=[],e=0,f=d.length;f>e;e++)c=d[e],b=ko.dataFor(c),g.push(a(jQuery(c),b));return g},a.prototype.visitRecursive=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(null==b&&(b=null),b){for(j=b.children,l=[],f=0,h=j.length;h>f;f++)c=j[f],a(b,c),l.push(this.visitRecursive(a,c));return l}for(d=ko.contextFor(this.element.get(0)),b=d.tree,a(null,b),i=b.children,k=[],e=0,g=i.length;g>e;e++)c=i[e],a(b,c),k.push(this.visitRecursive(a,c));return k},a.prototype.getParent=function(a){var b,c;return b=null,c=function(c,d){return d===a?b=c:void 0},this.visitRecursive(c),b},a.prototype.remove=function(a){var b;return b=function(b){return b&&b.children?b.children.remove(a):void 0},this.visitRecursive(b)},a.prototype.expandAll=function(){},a.prototype.collapseAll=function(){},a}(),this.Maslosoft.Ko.getType=function(){if(x&&"object"==typeof x){if(x.constructor===Date)return"date";if(x.constructor===Array)return"array"}return typeof x},this.Maslosoft.Ko.objByName=function(a,b){var c,d,e,f,g,h,i,j;for(null==b&&(b=window),c=Array.prototype.slice.call(arguments,2),g=a.split("."),d=b,h=[],e=i=0,j=g.length;j>i;e=++i){if(f=g[e],h.push(f),"undefined"==typeof d[f])throw new Error("Name part `"+h.join(".")+"` not found while accesing "+a);d=d[f]}return d},this.Maslosoft.Ko.Track=function(){function a(){this.fromJs=o(this.fromJs,this),this.factory=o(this.factory,this)}return a.prototype.factory=function(a){var b,c,d,e,f,g,h,i,j;if(!a)return a;if(a._class){c=a._class.replace(/\\/g,".");try{g=Maslosoft.Ko.objByName(c)}catch(k){b=k,console.warn("Could not resolve class name `"+c+"`")}if(g)return new g(a);console.warn("Class `"+c+"` not found, using default object"),console.debug(a)}if("object"==typeof a)if(a=ko.track(a,{deep:!0}),Array.isArray(a))for(d=i=0,j=a.length;j>i;d=++i)e=a[d],a[d]=this.factory(e);else for(f in a)h=a[f],a[f]=this.factory(h);return a},a.prototype.fromJs=function(a,b){var c,d,e;e=[];for(c in b)d=b[c],e.push("object"==typeof d?a[c]?this.fromJs(a[c],d):a[c]=this.factory(d):a[c]=d);return e},a}(),ko.tracker=new this.Maslosoft.Ko.Track,window.Proxy||(console.warn("Your browser does not support Proxy, will not work properly in some cases..."),window.Proxy=function(){function a(){}return a}()),a=function(){function a(a,b){this.parent=a,this.field=b}return a.prototype.set=function(a,b,c){var d,e,f;return f=!1,a[b]!==c&&(f=!0),e=Object.keys(a).length,a[b]=c,d=Object.keys(a).length,e!==d&&(f=!0),f&&ko.valueHasMutated(this.parent,this.field),!0},a.prototype.deleteProperty=function(a,b){return delete a[b],ko.valueHasMutated(this.parent,this.field),!0},a}(),k=WeakMap?new WeakMap:new Map,this.Maslosoft.Ko.Balin.Model=function(){function b(b){var c,d,e;null==b&&(b=null),c=k.get(this);for(d in this)e=this[d],l(this[d])&&(this[d]={}),Array.isArray(this[d])&&(this[d]=[]);if(!c){k.set(this,!0);for(d in this)e=this[d],this[d]=ko.tracker.factory(e),l(this[d])&&(this[d]=new Proxy(this[d],new a(this,d)))}for(d in b)e=b[d],this[d]=ko.tracker.factory(e);for(d in this)e=this[d],l(this[d])&&(this[d]=new Proxy(this[d],new a(this,d)));ko.track(this,{deep:!0})}return b}(),this.Maslosoft.Ko.Balin.registerDefaults(),ko.punches.enableAll()}).call(this);