(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};this.Maslosoft||(this.Maslosoft={}),this.Maslosoft.Ko||(this.Maslosoft.Ko={}),this.Maslosoft.Ko.Balin||(this.Maslosoft.Ko.Balin={}),this.Maslosoft.Ko.Balin.register=function(a,b){return ko.bindingHandlers[a]=b,b.writable?ko.expressionRewriting.twoWayBindings[a]=!0:void 0},this.Maslosoft.Ko.Balin.registerDefaults=function(a){var b,c,d,e,f;if(null==a&&(a=null),b={fancytree:Maslosoft.Ko.Balin.Fancytree,fileSizeFormatter:Maslosoft.Ko.Balin.FileSizeFormatter,href:Maslosoft.Ko.Balin.Href,htmlValue:Maslosoft.Ko.Balin.HtmlValue,src:Maslosoft.Ko.Balin.Src,textValue:Maslosoft.Ko.Balin.TextValue,selected:Maslosoft.Ko.Balin.Selected},null!==a){e=[];for(c in a)d=a[c],e.push(Maslosoft.Ko.Balin.register(d,new b[d]));return e}f=[];for(c in b)d=b[c],f.push(Maslosoft.Ko.Balin.register(c,new d));return f},this.Maslosoft.Ko.Balin.registerEvents=function(a){var b,c,d,e,f;if(null==a&&(a=null),b={mousedown:"mousedown",mouseup:"mouseup",mouseover:"mouseover",mouseout:"mouseout"},null!==a){e=[];for(c in a)d=a[c],e.push(Maslosoft.Ko.Balin.makeEventHandlerShortcut(d));return e}f=[];for(c in b)d=b[c],f.push(Maslosoft.Ko.Balin.makeEventHandlerShortcut(d));return f},this.Maslosoft.Ko.Balin.makeEventHandlerShortcut=function(a){ko.bindingHandlers[a]={init:function(b,c,d,e,f){var g;return g=function(){var b;return b={},b[a]=c(),b},ko.bindingHandlers.event.init.call(this,b,g,d,e,f)}}},this.Maslosoft.Ko.Balin.Base=function(){function b(b){this.options=null!=b?b:{},this.getValue=a(this.getValue,this)}return b.prototype.writable=!0,b.prototype.options=null,b.prototype.getValue=function(a,b){var c;return null==b&&(b=""),c=ko.unwrap(a()),this.options.valueField&&(c=this.options.ec5?c[this.options.valueField]:c[this.options.valueField]()),c||b},b.prototype.setValue=function(){},b}(),this.Maslosoft.Ko.Balin.Options=function(){function a(a){var b,c;null==a&&(a={});for(b in a)c=a[b],this[b]=c;null===this.ec5&&(this.ec5=!!ko.track),null===this.afterUpdate&&(this.afterUpdate=function(){})}return a.prototype.valueField=null,a.prototype.ec5=null,a.prototype.afterUpdate=null,a}(),this.Maslosoft.Ko.Balin.DateOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.sourceFormat="unix",b.prototype.displayFormat="YYYY-MM-DD",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.DateTimeOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.sourceFormat="unix",b.prototype.displayFormat="YYYY-MM-DD hh:mm",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.TimeOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.sourceFormat="unix",b.prototype.displayFormat="hh:mm",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.DateTime=function(a){function b(a){this.options=new this.Maslosoft.Ko.Balin.DateTimeOptions(a)}return c(b,a),b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.MomentFormatter=function(b){function d(){return this.update=a(this.update,this),this.init=a(this.init,this),d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.init=function(){moment.lang(this.options.lang)},d.prototype.update=function(a,b){var c;c=this.getValue(b),a.innerHTML=moment[this.sourceformat](c).format(this.displayformat)},d}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Fancytree=function(b){function d(){return this.update=a(this.update,this),this.init=a(this.init,this),d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.tree=null,d.prototype.element=null,d.prototype.getData=function(a){var b;return b=this.getValue(a)||[],b.data?b.data:b},d.prototype.init=function(a,b){var c;return c=b().options||{},c.source=this.getData(b),jQuery(a).fancytree(c)},d.prototype.update=function(a,b){var c,d;return c=this.getValue(b),a=jQuery(a),d=function(d){return function(){return a.find(".ui-fancytree").length?(a.fancytree("option","source",d.getData(b)),c.autoExpand&&a.fancytree("getRootNode").visit(function(a){return a.setExpanded(!0)}),a.focus()):void 0}}(this),setTimeout(d,0)},d}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.FileSizeFormatter=function(b){function d(){return this.update=a(this.update,this),this.init=a(this.init,this),d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.units={binary:["kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimal:["kB","MB","GB","TB","PB","EB","ZB","YB"]},d.prototype.binary=!0,d.prototype.init=function(){},d.prototype.update=function(a,b){var c,d,e,f,g;return g=this.getValue(b)||0,c=this.binary,d=!this.binary,c&&(f=1024),d&&(f=1e3),e=function(a){return function(b){var e,g;if(b=parseInt(b),f>b)return b+" B";for(e=-1,c&&(g=a.units.binary),d&&(g=a.units.decimal);;)if(b/=f,e++,!(b>f))break;return g[e]?Math.max(b,.1).toFixed(1)+" "+g[e]:Math.max(b,.1).toFixed(1)+(" ~*"+e*f+" * "+f+" B")}}(this),a.innerHTML=e(g)},d}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Href=function(b){function d(){return this.update=a(this.update,this),this.init=a(this.init,this),d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.init=function(a,b,c){var d;return a.href||a.setAttribute("href",""),"a"!==a.tagName.toLowerCase()&&console.warn("href binding should be used only on `a` tags"),d=c.get("stopPropagation")||!1,d?ko.utils.registerEventHandler(a,"click",function(a){return a.stopPropagation()}):void 0},d.prototype.update=function(a,b,c){var d,e;return d=this.getValue(b),e=c.get("target")||"",a.href!==d&&(a.href=d),a.target!==e?a.target=e:void 0},d}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.HtmlValue=function(b){function d(b){null==b&&(b={}),this.update=a(this.update,this),this.init=a(this.init,this),d.__super__.constructor.call(this,b),ko.bindingHandlers.sortable&&ko.bindingHandlers.sortable.options&&(ko.bindingHandlers.sortable.options.cancel=":input,button,[contenteditable]")}var e;return c(d,b),e=0,d.prototype.getElementValue=function(a){return a.innerHTML},d.prototype.setElementValue=function(a,b){return a.innerHTML=b},d.prototype.init=function(a,b){var c;a.setAttribute("contenteditable",!0),a.id||(a.id="Maslosoft-Ko-Balin-HtmlValue-"+e++),c=function(c){return function(){var d,e,f;if(a&&(a=document.getElementById(a.id)))return d=b(),f=c.getValue(b),e=c.getElementValue(a),ko.isWriteableObservable(d)&&f!==e?d(e):void 0}}(this),ko.utils.registerEventHandler(a,"keyup, input",c),ko.utils.registerEventHandler(document,"mouseup",c)},d.prototype.update=function(a,b){var c;c=this.getValue(b),this.getElementValue(a)!==c&&this.setElementValue(a,c)},d}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Selected=function(b){function d(){return this.update=a(this.update,this),d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.writable=!1,d.prototype.className="selected",d.prototype.update=function(a,b){var c;c=this.getValue(b),c?ko.utils.toggleDomNodeCssClass(a,this.className,!0):ko.utils.toggleDomNodeCssClass(a,this.className,!1)},d}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Src=function(b){function d(){return this.update=a(this.update,this),this.init=a(this.init,this),d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.init=function(){},d.prototype.update=function(a,b){var c;return c=this.getValue(b),a.src!==c?a.src=c:void 0},d}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.TextValue=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.getElementValue=function(a){return a.textContent||a.innerText||""},b.prototype.setElementValue=function(a,b){return"undefined"!=typeof a.textContent&&(a.textContent=b),"undefined"!=typeof a.innerText?a.innerText=b:void 0},b}(this.Maslosoft.Ko.Balin.HtmlValue),this.Maslosoft.Ko.getType=function(){if(x&&"object"==typeof x){if(x.constructor===Date)return"date";if(x.constructor===Array)return"array"}return typeof x},this.Maslosoft.Ko.objByName=function(a,b){var c,d,e,f,g,h,i,j;for(null==b&&(b=window),c=Array.prototype.slice.call(arguments,2),g=a.split("."),d=b,h=[],e=i=0,j=g.length;j>i;e=++i){if(f=g[e],h.push(f),"undefined"==typeof d[f])throw new Error("Name part `"+h.join(".")+"` not found while accesing "+a);d=d[f]}return d},this.Maslosoft.Ko.Track=function(){function b(){this.factory=a(this.factory,this)}return b.prototype.factory=function(a){var b,c,d,e;if(!a)return a;if(a._class){if(b=a._class.replace(/\\/g,"."),d=Maslosoft.Ko.objByName(b))return new d(a);console.warn("Class `"+b+"` not found, using default object"),console.debug(a)}if("object"==typeof a){for(c in a)e=a[c],a[c]=this.factory(e);a=ko.track(a)}return a},b}(),ko.tracker=new this.Maslosoft.Ko.Track,this.Maslosoft.Ko.Balin.Model=function(){function a(a){var b,c;null==a&&(a=null);for(b in this)c=this[b],this[b]=ko.tracker.factory(a&&"undefined"!=typeof a[b]?a[b]:c);ko.track(this)}return a}()}).call(this);