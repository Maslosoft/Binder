(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k=function(a,b){return function(){return a.apply(b,arguments)}},l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=function(){return console?console.assert.apply(console,arguments):void 0},i=function(){return console?console.log.apply(console,arguments):void 0},j=function(a,b){return null==b&&(b=null),console?console.warn.apply(console,arguments):void 0},h=function(a,b){return null==b&&(b=null),console?console.error.apply(console,arguments):void 0},Object.keys||(Object.keys=function(){var a,b,c,d;return d=Object.prototype.hasOwnProperty,c=!{toString:null}.propertyIsEnumerable("toString"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],b=a.length,function(e){var f,g,h;if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");h=[],g=void 0,f=void 0;for(g in e)g=g,d.call(e,g)&&h.push(g);if(c)for(f=0;b>f;)d.call(e,a[f])&&h.push(a[f]),f++;return h}}()),this.Maslosoft||(this.Maslosoft={}),this.Maslosoft.Ko||(this.Maslosoft.Ko={}),this.Maslosoft.Ko.Balin||(this.Maslosoft.Ko.Balin={}),this.Maslosoft.Ko.Balin.Helpers||(this.Maslosoft.Ko.Balin.Helpers={}),this.Maslosoft.Ko.Balin.register=function(a,b){var c;return ko.bindingHandlers[a]=b,c=!1,a.match(/[A-Z]/)&&(c=a.toLowerCase(),ko.bindingHandlers[c]=b),b.writable&&ko.expressionRewriting&&ko.expressionRewriting.twoWayBindings&&(ko.expressionRewriting.twoWayBindings[a]=!0,c)?ko.expressionRewriting.twoWayBindings[c]=!0:void 0},this.Maslosoft.Ko.Balin.registerDefaults=function(a){var b,c,d,e,f;if(null==a&&(a=null),b={active:Maslosoft.Ko.Balin.Active,action:Maslosoft.Ko.Balin.WidgetAction,activity:Maslosoft.Ko.Balin.WidgetActivity,asset:Maslosoft.Ko.Balin.Asset,data:Maslosoft.Ko.Balin.Data,dateFormatter:Maslosoft.Ko.Balin.DateFormatter,dateTimeFormatter:Maslosoft.Ko.Balin.DateTimeFormatter,disabled:Maslosoft.Ko.Balin.Disabled,enumCssClassFormatter:Maslosoft.Ko.Balin.EnumCssClassFormatter,enumFormatter:Maslosoft.Ko.Balin.EnumFormatter,fancytree:Maslosoft.Ko.Balin.Fancytree,fileSizeFormatter:Maslosoft.Ko.Balin.FileSizeFormatter,hidden:Maslosoft.Ko.Balin.Hidden,href:Maslosoft.Ko.Balin.Href,htmlTree:Maslosoft.Ko.Balin.HtmlTree,htmlValue:Maslosoft.Ko.Balin.HtmlValue,icon:Maslosoft.Ko.Balin.Icon,model:Maslosoft.Ko.Balin.DataModel,src:Maslosoft.Ko.Balin.Src,textValue:Maslosoft.Ko.Balin.TextValue,textValueHlJs:Maslosoft.Ko.Balin.TextValueHLJS,tooltip:Maslosoft.Ko.Balin.Tooltip,timeAgoFormatter:Maslosoft.Ko.Balin.TimeAgoFormatter,timeFormatter:Maslosoft.Ko.Balin.TimeFormatter,selected:Maslosoft.Ko.Balin.Selected,validator:Maslosoft.Ko.Balin.Validator},null!==a){e=[];for(c in a)d=a[c],e.push(Maslosoft.Ko.Balin.register(d,new b[d]));return e}f=[];for(c in b)d=b[c],f.push(Maslosoft.Ko.Balin.register(c,new d));return f},this.Maslosoft.Ko.Balin.registerEvents=function(a){var b,c,d,e,f;if(null==a&&(a=null),b={mousedown:"mousedown",mouseup:"mouseup",mouseover:"mouseover",mouseout:"mouseout"},null!==a){e=[];for(c in a)d=a[c],e.push(Maslosoft.Ko.Balin.makeEventHandlerShortcut(d));return e}f=[];for(c in b)d=b[c],f.push(Maslosoft.Ko.Balin.makeEventHandlerShortcut(d));return f},this.Maslosoft.Ko.Balin.makeEventHandlerShortcut=function(a){ko.bindingHandlers[a]={init:function(b,c,d,e,f){var g;return g=function(){var b;return b={},b[a]=c(),b},ko.bindingHandlers.event.init.call(this,b,g,d,e,f)}}},this.Maslosoft.Ko.Balin.Base=function(){function a(a){var b,c;null==a&&(a={}),this.getValue=k(this.getValue,this),this.options={};for(b in a)c=a[b],this.options[b]=c}return a.prototype.writable=!0,a.prototype.options={},a.prototype.getValue=function(a,b){var c;return null==b&&(b=""),c=ko.unwrap("function"==typeof a?a():a),this.options.valueField&&(c=this.options.ec5?c[this.options.valueField]:c[this.options.valueField]()),c||b},a}(),this.Maslosoft.Ko.Balin.Options=function(){function a(a){var b,c;null==a&&(a={});for(b in a)c=a[b],this[b]=c;null===this.ec5&&(this.ec5=!!ko.track),null===this.afterUpdate&&(this.afterUpdate=function(){})}return a.prototype.valueField=null,a.prototype.ec5=null,a.prototype.afterUpdate=null,a}(),this.Maslosoft.Ko.Balin.CssOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.className="active",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.DateOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="YYYY-MM-DD",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.DateTimeOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="YYYY-MM-DD hh:mm",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.TimeAgoOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="hh:mm",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.TimeOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.lang="en",b.prototype.sourceFormat="unix",b.prototype.displayFormat="hh:mm",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.ValidatorOptions=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.classField="_class",b.prototype.parentSelector=".form-group",b.prototype.inputError="error",b.prototype.parentError="has-error",b.prototype.inputWarning="warning",b.prototype.parentWarning="has-warning",b.prototype.inputSuccess="success",b.prototype.parentSuccess="has-success",b.prototype.errorMessages=".error-messages",b.prototype.warningMessages=".warning-messages",b}(this.Maslosoft.Ko.Balin.Options),this.Maslosoft.Ko.Balin.BaseValidator=function(){function a(a){var b,c;this.reset();for(b in a)c=a[b],this[b]=null,this[b]=c}return a.prototype.label="",a.prototype.model=null,a.prototype.messages=[],a.prototype.rawMessages=[],a.prototype.warningMessages=[],a.prototype.rawWarningMessages=[],a.prototype.reset=function(){return this.messages=new Array,this.rawMessages=new Object,this.warningMessages=new Array,this.rawWarningMessages=new Object},a.prototype.isValid=function(){throw new Error("Validator must implement `isValid` method")},a.prototype.getErrors=function(){return this.messages},a.prototype.getWarnings=function(){return this.warningMessages},a.prototype.addError=function(a,b){var c,d,e,f;d=a,a=a.replace("{attribute}",this.label);for(c in this)e=this[c],a=a.replace("{"+c+"}",e);for(c in b)e=b[c],a=a.replace("{"+c+"}",e);f=this.model;for(c in f)e=f[c],a=a.replace("{"+c+"}",e);return this.rawMessages[d]?void 0:(this.messages.push(a),this.rawMessages[d]=!0)},a.prototype.addWarning=function(a,b){var c,d,e,f;d=a,a=a.replace("{attribute}",this.label);for(c in this)e=this[c],a=a.replace("{"+c+"}",e);for(c in b)e=b[c],a=a.replace("{"+c+"}",e);f=this.model;for(c in f)e=f[c],a=a.replace("{"+c+"}",e);return this.rawWarningMessages[d]?void 0:(this.warningMessages.push(a),this.rawWarningMessages[d]=!0)},a}(),this.Maslosoft.Ko.Balin.CssClass=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.writable=!1,b.prototype.update=function(a,b){var c;c=this.getValue(b),c?ko.utils.toggleDomNodeCssClass(a,this.options.className,!0):ko.utils.toggleDomNodeCssClass(a,this.options.className,!1)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.MomentFormatter=function(a){function b(){return this.update=k(this.update,this),this.init=k(this.init,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.init=function(){moment.locale(this.options.lang)},b.prototype.update=function(a,b){var c;c=this.getValue(b),a.innerHTML=moment[this.options.sourceFormat](c).format(this.options.displayFormat)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.WidgetUrl=function(a){function b(){return this.createUrl=k(this.createUrl,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.getData=function(a,b,c,d){var e,f;return f=this.getValue(b),e={},e.id=c.get("widgetId")||f.id,c.get("widget")&&(e.id=c.get("widget").id),e[d]=c.get(d)||f[d],e.params=c.get("params")||f.params,e.params=this.getValue(e.params),"string"==typeof f&&(e[d]=f),e},b.prototype.createUrl=function(a,b,c,d){var e,f,g,h;if(e=[],"string"==typeof c||"number"==typeof c)e.push(""+c);else for(g in c)h=c[g],g=encodeURIComponent(""+g),h=encodeURIComponent(""+h),e.push(""+g+":"+h);return f=""+d+a+"."+b,0===e.length?f:(e=e.join(",",e),""+f+"="+e)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Active=function(a){function b(){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.CssOptions({className:"active"}))}return m(b,a),b}(this.Maslosoft.Ko.Balin.CssClass),this.Maslosoft.Ko.Balin.Asset=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.update=function(a,b,c){var d,e,f,g,h,i,j,k,l;d=$(a),l=c.get("w"),f=c.get("h"),h=c.get("p"),g=this.getValue(b),g.updateDate&&(e=g.updateDate,i=e.sec),k=g.url,j=[],j.push(k),l&&j.push("w/"+l),f&&j.push("h/"+f),h===!1&&j.push("p/0"),i&&j.push(i),j=j.join("/"),d.attr("src")!==j&&d.attr("src",j)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Data=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.getNamespacedHandler=function(a){return{update:function(b){return function(c,d){var e,f;return e=b.getValue(d),"string"!=(f=typeof e)&&"number"!==f&&(e=JSON.stringify(e)),c.setAttribute("data-"+a,e)}}(this)}},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.DataModel=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.update=function(a,b,c){var d,e,f,g,h,i,k;if(f=this.getValue(b),e=c.get("fields")||null,null===e)return void this.bindModel(a,f);for(g={},k=[],h=0,i=e.length;i>h;h++)d=e[h],"undefined"==typeof f[d]?j("Model field `"+d+"` is undefined on element:",a):g[d]=f[d],k.push(this.bindModel(a,g));return k},b.prototype.bindModel=function(a,b){var c,d;return"string"!=(d=typeof value)&&"number"!==d&&(c=JSON.stringify(b)),a.setAttribute("data-model",c)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.DateFormatter=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.DateOptions(a))}return m(b,a),b}(this.Maslosoft.Ko.Balin.MomentFormatter),this.Maslosoft.Ko.Balin.DateTimeFormatter=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.DateTimeOptions(a))}return m(b,a),b}(this.Maslosoft.Ko.Balin.MomentFormatter),this.Maslosoft.Ko.Balin.Disabled=function(a){function b(){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.CssOptions({className:"disabled"}))}return m(b,a),b}(this.Maslosoft.Ko.Balin.CssClass),this.Maslosoft.Ko.Balin.EnumCssClassFormatter=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.update=function(a,b){var c,d,e,f,g,h;for(c=this.getValue(b),h=c.values,f=0,g=h.length;g>f;f++)d=h[f],e=new RegExp("(?:^|\\s)"+d+"(?!\\S)","g"),a.className=a.className.replace(e,"");a.className+=" "+c.values[c.data]},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.EnumFormatter=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.update=function(a,b){var c;c=this.getValue(b),a.innerHTML=c.values[c.data]},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Fancytree=function(a){function c(){return this.update=k(this.update,this),this.handle=k(this.handle,this),this.init=k(this.init,this),c.__super__.constructor.apply(this,arguments)}return m(c,a),c.prototype.tree=null,c.prototype.element=null,c.prototype.getData=function(a){var b;return b=this.getValue(a)||[],b.data?b.data:b},c.prototype.init=function(a,c){var e,g,h,i,k,l,m,n;return n=this.getData(c),l=c().options||{},g=this.getValue(c).on||!1,l.toggleEffect=!1,l.source=n.children,l.extensions=[],g&&new d(n,g,l),e=c().dnd||!1,e&&(l.autoScroll=!1,l.extensions.push("dnd"),l.dnd=new b(n,a)),i=c().nodeIcon||!1,h=c().folderIcon||!1,k=c().nodeRenderer||!1,h&&!i&&j("Option `folderIcon` require also `nodeIcon` or it will not work at all"),(i||k)&&(i&&(l.icon=!1),m=new f(n,l,i,h),k&&m.setRenderer(new k(n,l)),l.renderNode=m.render),jQuery(a).fancytree(l)},c.prototype.handle=function(a,b){var c,d;return c=this.getValue(b),a=jQuery(a),d=function(d){return function(){return a.find(".ui-fancytree").length?(a.fancytree("option","source",d.getData(b).children),c.autoExpand&&a.fancytree("getRootNode").visit(function(a){return a.setExpanded(!0)}),a.focus()):void 0}}(this),setTimeout(d,0)},c.prototype.update=function(a,b,c){return this.handle(a,b,c)},c}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.FileSizeFormatter=function(a){function b(){return this.update=k(this.update,this),this.init=k(this.init,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.units={binary:["kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimal:["kB","MB","GB","TB","PB","EB","ZB","YB"]},b.prototype.binary=!0,b.prototype.init=function(){},b.prototype.update=function(a,b){var c,d,e,f,g;return g=this.getValue(b)||0,c=this.binary,d=!this.binary,c&&(f=1024),d&&(f=1e3),e=function(a){return function(b){var e,g;if(b=parseInt(b),f>b)return b+" B";for(e=-1,c&&(g=a.units.binary),d&&(g=a.units.decimal);;)if(b/=f,e++,!(b>f))break;return g[e]?Math.max(b,.1).toFixed(1)+" "+g[e]:Math.max(b,.1).toFixed(1)+(" ~*"+e*f+" * "+f+" B")}}(this),a.innerHTML=e(g)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.GMap=function(a){function b(){return this.update=k(this.update,this),this.init=k(this.init,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.init=function(){},b.prototype.update=function(a,b){var c;return c=this.getValue(b)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Hidden=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.update=function(a,b){var c;return c=!this.getValue(b),ko.bindingHandlers.visible.update(a,function(){return c})},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Href=function(a){function b(){return this.update=k(this.update,this),this.init=k(this.init,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.init=function(a,b,c){var d;return a.href||a.setAttribute("href",""),"a"!==a.tagName.toLowerCase()&&console.warn("href binding should be used only on `a` tags"),d=c.get("stopPropagation")||!1,d?ko.utils.registerEventHandler(a,"click",function(a){return a.stopPropagation()}):void 0},b.prototype.update=function(a,b,c){var d,e;return d=this.getValue(b),e=c.get("target")||"",a.href!==d&&(a.href=d),a.target!==e?a.target=e:void 0},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.HtmlTree=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.drawNode=function(a){var c,d,e,f,g,h,i;if(f=document.createElement("li"),f.innerHTML=a.title,a.children&&a.children.length>0){for(d=document.createElement("ul"),i=a.children,g=0,h=i.length;h>g;g++)e=i[g],c=b.drawNode(e),d.appendChild(c);f.appendChild(d)}return f},b.prototype.getData=function(a){var b;return b=this.getValue(a)||[],b.data?this.getValue(b.data)||[]:b},b.prototype.update=function(a,c){var d,e;return d=this.getValue(c),j("HtmlTree is experimental, do not use"),e=function(){return function(){var c;return c=b.drawNode(d),a.innerHTML="",a.appendChild(c)}}(this),setTimeout(e,0)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.HtmlValue=function(a){function b(a){null==a&&(a={}),this.update=k(this.update,this),this.init=k(this.init,this),b.__super__.constructor.call(this,a),ko.bindingHandlers.sortable&&ko.bindingHandlers.sortable.options&&(ko.bindingHandlers.sortable.options.cancel=":input,button,[contenteditable]")}var c;return m(b,a),c=0,b.prototype.getElementValue=function(a){return a.innerHTML},b.prototype.setElementValue=function(a,b){return a.innerHTML=b},b.prototype.init=function(a,b){var d,e;a.setAttribute("contenteditable",!0),a.id||(a.id="Maslosoft-Ko-Balin-HtmlValue-"+c++),e=function(c){return function(){var d,e,f;if(a&&(a=document.getElementById(a.id)))return d=b(),f=c.getValue(b),e=c.getElementValue(a),ko.isWriteableObservable(d)&&f!==e?d(e):void 0}}(this),d=function(){return function(){return setTimeout(e,0)}}(this),ko.utils.registerEventHandler(a,"keyup, input",e),ko.utils.registerEventHandler(document,"mouseup",d)},b.prototype.update=function(a,b){var c;c=this.getValue(b),this.getElementValue(a)!==c&&this.setElementValue(a,c)},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Icon=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.update=function(a,b,c){var d,e,f,g,h,i,j,k,l;return d=$(a),i=this.getValue(b),g=c.get("iconField")||"icon",i?(l=i[g],e="undefined"==typeof i.iconSize?16:i.iconSize,k=c.get("iconSize")||e,j=new RegExp("/"+e+"/","g"),h="undefined"==typeof i.isImage?!0:i.isImage,h?(l.match(new RegExp("/$"))||(l+="/"),l.match(new RegExp("/w/","g"))?l=l.replace(j,"/"+k+"/"):l+="w/"+k+"/h/"+k+"/p/0/",i.updateDate&&(l+=i.updateDate.sec)):(f=16,k>16&&(f=32),k>32&&(f=48),k>48&&(f=512),l=l.replace(j,"/"+f+"/")),d.attr("src")!==l&&d.attr("src",l),void d.css({maxWidth:k,maxHeight:k})):void(console&&(console.warn("Binding value for `icon` binding not defined, skipping. Element:"),console.warn(a),console.warn((new Error).stack)))},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Selected=function(a){function b(){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.CssOptions({className:"selected"}))}return m(b,a),b}(this.Maslosoft.Ko.Balin.CssClass),this.Maslosoft.Ko.Balin.Src=function(a){function b(){return this.update=k(this.update,this),this.init=k(this.init,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.init=function(){},b.prototype.update=function(a,b){var c;return c=this.getValue(b),a.src!==c?a.src=c:void 0},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.TextValue=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.getElementValue=function(a){return a.textContent||a.innerText||""},b.prototype.setElementValue=function(a,b){return"undefined"!=typeof a.textContent&&(a.textContent=b),"undefined"!=typeof a.innerText?a.innerText=b:void 0},b}(this.Maslosoft.Ko.Balin.HtmlValue),this.Maslosoft.Ko.Balin.TextValueHLJS=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.getElementValue=function(a){return a.textContent||a.innerText||""},b.prototype.setElementValue=function(a,b){return"undefined"!=typeof a.textContent&&(a.textContent=b,hljs&&hljs.highlightBlock(a)),"undefined"!=typeof a.innerText&&(a.innerText=b,hljs)?hljs.highlightBlock(a):void 0},b}(this.Maslosoft.Ko.Balin.HtmlValue),this.Maslosoft.Ko.Balin.TimeAgoFormatter=function(a){function b(a){this.update=k(this.update,this),b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.TimeAgoOptions(a))}return m(b,a),b.prototype.update=function(a,b){var c;c=this.getValue(b),a.innerHTML=moment[this.options.sourceFormat](c).fromNow()},b}(this.Maslosoft.Ko.Balin.MomentFormatter),this.Maslosoft.Ko.Balin.TimeFormatter=function(a){function b(a){b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.TimeOptions(a))}return m(b,a),b}(this.Maslosoft.Ko.Balin.MomentFormatter),this.Maslosoft.Ko.Balin.Tooltip=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.update=function(a,b){var c;c=this.getValue(b),$(a).attr("title",c),$(a).attr("data-original-title",c),$(a).attr("rel","tooltip")},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.Validator=function(a){function b(){this.update=k(this.update,this),this.init=k(this.init,this),this.advise=k(this.advise,this),this.validate=k(this.validate,this),b.__super__.constructor.call(this,new Maslosoft.Ko.Balin.ValidatorOptions)}var c;return m(b,a),c=0,b.prototype.getElementValue=function(a){return"input"===a.tagName.toLowerCase()?a.value:"textarea"===a.tagName.toLowerCase()?a.value:a.textContent||a.innerText||""},b.prototype.validate=function(a,b,c){var d,e,f,g,h;return g=jQuery(b).parents(".form-group")[0],d=g.querySelector(this.options.errorMessages),h=g.querySelector(this.options.warningMessages),f=new Array,a.reset(),e=!1,a.isValid(c)?(this.options.inputError&&ko.utils.toggleDomNodeCssClass(b,this.options.inputError,!1),this.options.inputSuccess&&ko.utils.toggleDomNodeCssClass(b,this.options.inputSuccess,!0),g&&(this.options.parentError&&ko.utils.toggleDomNodeCssClass(g,this.options.parentError,!1),this.options.parentSuccess&&ko.utils.toggleDomNodeCssClass(g,this.options.parentSuccess,!0)),d&&(d.innerHTML=""),e=!0):(f=a.getErrors(),this.options.inputError&&ko.utils.toggleDomNodeCssClass(b,this.options.inputError,!0),this.options.inputSuccess&&ko.utils.toggleDomNodeCssClass(b,this.options.inputSuccess,!1),g&&(this.options.parentError&&ko.utils.toggleDomNodeCssClass(g,this.options.parentError,!0),this.options.parentSuccess&&ko.utils.toggleDomNodeCssClass(g,this.options.parentSuccess,!1)),d&&f&&(d.innerHTML=f.join("<br />")),e=!1),this.options.inputWarning&&ko.utils.toggleDomNodeCssClass(b,this.options.inputWarning,!1),g&&this.options.parentWarning&&ko.utils.toggleDomNodeCssClass(g,this.options.parentWarning,!1),h&&(h.innerHTML=""),e},b.prototype.advise=function(a,b){var c,d,e,f;return e=jQuery(b).parents(".form-group")[0],c=e.querySelector(this.options.errorMessages),f=e.querySelector(this.options.warningMessages),d=a.getWarnings(),d.length&&(i(d),this.options.inputWarning&&ko.utils.toggleDomNodeCssClass(b,this.options.inputWarning,!0),this.options.inputSuccess&&ko.utils.toggleDomNodeCssClass(b,this.options.inputSuccess,!1),e&&(this.options.parentWarning&&ko.utils.toggleDomNodeCssClass(e,this.options.parentWarning,!0),this.options.parentSuccess&&ko.utils.toggleDomNodeCssClass(e,this.options.parentSuccess,!1)),f)?f.innerHTML=d.join("<br />"):void 0},b.prototype.init=function(a,b){var d,e,f,g,i,j,k,l,m,n,o,p;for(i=this.getValue(b),n=new Array,e=this.options.classField,d=i.constructor===Array?i:[i],o=0,p=d.length;p>o;o++)g=d[o],g[e]?"function"==typeof g[e]?(m=g[e].prototype,"function"==typeof m.isValid&&"function"==typeof m.getErrors&&"function"==typeof m.reset?(f=g[e],delete g[e],n.push(new f(g))):(l="function"==typeof g[e].prototype.constructor?g[e].prototype.constructor.name:g[e].toString(),h("Parameter `"+e+"` (of type "+l+") must be validator compatible class, binding defined on element:",a))):h("Parameter `"+e+"` must be validator compatible class, binding defined on element:",a):h("Parameter `"+e+"` must be defined for validator on element:",a);return a.id||(a.id="Maslosoft-Ko-Balin-Validator-"+c++),k=this.getElementValue(a),j=function(b){return function(){var c,d,e,f,g,h,i;if(a&&(a=document.getElementById(a.id),a&&(c=b.getElementValue(a),k!==c))){for(k=c,e=0,g=n.length;g>e;e++)if(d=n[e],!b.validate(d,a,c))return;for(i=[],f=0,h=n.length;h>f;f++)d=n[f],i.push("function"==typeof d.getWarnings?b.advise(d,a,c):void 0);return i}}}(this),ko.utils.registerEventHandler(a,"keyup, input",j),ko.utils.registerEventHandler(document,"mouseup",j)},b.prototype.update=function(){},b}(this.Maslosoft.Ko.Balin.Base),this.Maslosoft.Ko.Balin.WidgetAction=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.update=function(a,b,c){var d,e;return d=this.getData(a,b,c,"action"),e=this.createUrl(d.id,d.action,d.params,"?"),a.setAttribute("href",e),a.setAttribute("rel","virtual")},b}(this.Maslosoft.Ko.Balin.WidgetUrl),this.Maslosoft.Ko.Balin.WidgetActivity=function(a){function b(){return this.update=k(this.update,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.update=function(a,b,c){var d,e;return d=this.getData(a,b,c,"activity"),e=this.createUrl(d.id,d.activity,d.params,"#"),a.setAttribute("href",e),a.setAttribute("rel","virtual")},b}(this.Maslosoft.Ko.Balin.WidgetUrl),c=function(){function a(){}var b;return b={},a.prototype.get=function(a){return"undefined"==typeof b[a]?!1:b[a]},a.prototype.set=function(a,c){return b[a]=c},a}(),e=function(){function a(a){b=new c,e=a}var b,d,e;return b=null,e=null,d=function(a,c){var e,f,g,h,i,j;if("undefined"==typeof c)return!1;if(f=b.get(c))return f;if(a.id===c)return a;if(a._id===c)return a;if(a.children&&a.children.length>0)for(j=a.children,h=0,i=j.length;i>h;h++)if(e=j[h],g=d(e,c),g!==!1)return b.set(c,g),g;return!1},a.prototype.find=function(a){return d(e,a)},a}(),b=function(){function a(a,d){this.dragDrop=k(this.dragDrop,this),f=a,c=new e(f),b=jQuery(d)}var b,c,d,f;return a.prototype.autoExpandMS=400,a.prototype.focusOnClick=!1,a.prototype.preventVoidMoves=!0,a.prototype.preventRecursiveMoves=!0,f=null,c=null,b=null,d=function(a){},a.prototype.dragStart=function(){return!0},a.prototype.dragEnter=function(){return!0},a.prototype.dragDrop=function(a,d){var e,g,h,j,k,l,m;return h=d.hitMode,k=c.find(d.otherNode.parent.data.id),e=c.find(d.otherNode.data.id),l=c.find(a.data.id),m=c.find(a.parent.data.id),k&&k.children.remove(e),f.children.remove(e),m&&m.children.remove(e),"over"===h&&l.children.push(e),"before"===h&&(m?(j=m.children.indexOf(l),m.children.splice(j,0,e)):(j=f.children.indexOf(l),f.children.splice(j,0,e))),"after"===h&&(m?m.children.push(e):f.children.push(e)),g=function(){return function(){return b.fancytree("option","source",f.children),b.fancytree("getRootNode").visit(function(a){return a.setExpanded(!0)}),b.focus(),i("update tree..")}}(this),setTimeout(g,0),!0},a}(),d=function(){function a(a,b,d){this.events=b,this.options=d,this.handle=k(this.handle,this),f=a,c=new e(f),this.handle("click"),this.handle("dblclick"),this.handle("activate"),this.handle("deactivate")}var b,c,d,f;return a.prototype.events=null,a.prototype.options=null,f=null,c=null,b=function(a){return"undefined"==typeof a.targetType?!0:"title"===a.targetType?!0:"icon"===a.targetType?!0:void 0},d=function(a){return a.stopPropagation()},a.prototype.handle=function(a){return this.events[a]?this.options[a]=function(e){return function(f,g){var h;return b(g)?(h=c.find(g.node.data.id),e.events[a](h,g,f),d(f)):void 0}}(this):void 0},a}(),f=function(){function a(a,c,d,f){this.icon=d,this.folderIcon=f,this.render=k(this.render,this),b=new e(a)}var b;return a.prototype.icon="",a.prototype.folderIcon="",a.prototype.renderer=null,b=null,a.prototype.setRenderer=function(a){return this.renderer=a,"function"!=typeof this.renderer.render?console.error("Renderer must have function `render`"):void 0},a.prototype.render=function(a,c){var d,e,f,g,h,i,j;h=c.node;for(f in c)if(j=c[f],"originalEvent"===f)return;return i=jQuery(h.span).find("> span.fancytree-title"),this.renderer&&this.renderer.render&&(g=b.find(h.data.id),this.renderer.render(g,i)),this.icon||this.folderIcon?(d=i.html(),e=this.folderIcon&&h.children&&h.children.length?this.folderIcon:this.icon,i.html("<i class='node-title-icon' style='background-image:url("+e+")'></i> "+d)):void 0},a}(),this.Maslosoft.Ko.getType=function(){if(x&&"object"==typeof x){if(x.constructor===Date)return"date";if(x.constructor===Array)return"array"}return typeof x},this.Maslosoft.Ko.objByName=function(a,b){var c,d,e,f,g,h,i,j;for(null==b&&(b=window),c=Array.prototype.slice.call(arguments,2),g=a.split("."),d=b,h=[],e=i=0,j=g.length;j>i;e=++i){if(f=g[e],h.push(f),"undefined"==typeof d[f])throw new Error("Name part `"+h.join(".")+"` not found while accesing "+a);d=d[f]}return d},this.Maslosoft.Ko.Track=function(){function a(){this.factory=k(this.factory,this)}return a.prototype.factory=function(a){var b,c,d,e,f,g,h,i,j;if(!a)return a;if(a._class){c=a._class.replace(/\\/g,".");try{g=Maslosoft.Ko.objByName(c)}catch(k){b=k,console.warn("Could not resolve class name `"+c+"`")}if(g)return new g(a);console.warn("Class `"+c+"` not found, using default object"),console.debug(a)}if("object"==typeof a)if(a=ko.track(a),a.constructor===Array)for(d=i=0,j=a.length;j>i;d=++i)e=a[d],a[d]=this.factory(e);else for(f in a)h=a[f],a[f]=this.factory(h);return a},a}(),ko.tracker=new this.Maslosoft.Ko.Track,window.Proxy||(console.warn("Your browser does not support Proxy, will not work properly in some cases..."),window.Proxy=function(){function a(){}return a}()),a=function(){function a(a,b){this.parent=a,this.field=b}return a.prototype.get=function(a,b){return a[b]},a.prototype.set=function(a,b,c){var d,e;return e=Object.keys(a).length,a[b]=c,d=Object.keys(a).length,e!==d&&ko.valueHasMutated(this.parent,this.field),!0},a.prototype.deleteProperty=function(a,b){return delete a[b],ko.valueHasMutated(this.parent,this.field),!0},a}(),this.Maslosoft.Ko.Balin.Model=function(){function b(b){var c,d;null==b&&(b=null);for(c in this)d=this[c],this[c]=ko.tracker.factory(b&&"undefined"!=typeof b[c]?b[c]:d),this[c]&&"object"==typeof this[c]&&this[c].constructor===Object&&(this[c]=new Proxy(this[c],new a(this,c)));ko.track(this)}return b}(),this.Maslosoft.Ko.Balin.registerDefaults(),ko.punches.enableAll()}).call(this);